/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// src/main.ts
var main_exports = {};
__export(main_exports, {
  default: () => JournalingPlugin
});
module.exports = __toCommonJS(main_exports);
var import_obsidian4 = require("obsidian");

// src/settings.ts
var import_obsidian = require("obsidian");
var DEFAULT_SETTINGS = {
  journalFolder: "journals",
  dateFormat: "YYYY-MM-DD",
  sortDirection: "newest-first",
  defaultExpandEntries: true,
  folderFormat: ""
};
var JournalingSettingTab = class extends import_obsidian.PluginSettingTab {
  constructor(app, plugin) {
    super(app, plugin);
    this.plugin = plugin;
  }
  display() {
    const { containerEl } = this;
    containerEl.empty();
    containerEl.createEl("h2", { text: "Continuous Journaling Settings" });
    new import_obsidian.Setting(containerEl).setName("Journal Folder").setDesc("Specify the folder where journal entries will be stored").addText((text) => text.setPlaceholder("journals").setValue(this.plugin.settings.journalFolder).onChange(async (value) => {
      this.plugin.settings.journalFolder = value.replace(/^\/+|\/+$/g, "");
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(containerEl).setName("Date Format").setDesc("Format for journal filenames (YYYY-MM-DD recommended)").addText((text) => text.setPlaceholder("YYYY-MM-DD").setValue(this.plugin.settings.dateFormat).onChange(async (value) => {
      this.plugin.settings.dateFormat = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(containerEl).setName("Sort Direction").setDesc("How to sort journal entries in the continuous view").addDropdown((dropdown) => dropdown.addOption("newest-first", "Newest entries first").addOption("oldest-first", "Oldest entries first").setValue(this.plugin.settings.sortDirection).onChange(async (value) => {
      this.plugin.settings.sortDirection = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(containerEl).setName("Default Expand Entries").setDesc("Automatically expand entries when opening the journals view").addToggle((toggle) => toggle.setValue(this.plugin.settings.defaultExpandEntries).onChange(async (value) => {
      this.plugin.settings.defaultExpandEntries = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(containerEl).setName("Folder Structure Format").setDesc('Format pattern for organizing journal entries in subfolders. Examples: empty for flat structure, "YYYY" for yearly folders, "YYYY/MM" for monthly folders.').addText((text) => text.setPlaceholder("YYYY/MM").setValue(this.plugin.settings.folderFormat).onChange(async (value) => {
      this.plugin.settings.folderFormat = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(containerEl).setName("Migrate Journal Entries").setDesc("Move existing journal entries to the folder structure defined by the folder format pattern.").addButton((button) => button.setButtonText("Migrate Entries").setCta().onClick(async () => {
      await this.plugin.migrateJournalEntries();
    }));
  }
};

// src/journal-view.ts
var import_obsidian3 = require("obsidian");

// src/utils/date-utils.ts
function getTodayDate() {
  const today = new Date();
  return formatDateString(today);
}
function formatDateString(date) {
  const year = date.getFullYear();
  const month = String(date.getMonth() + 1).padStart(2, "0");
  const day = String(date.getDate()).padStart(2, "0");
  return `${year}-${month}-${day}`;
}
function formatDateForDisplay(dateString) {
  const date = new Date(dateString);
  const dateFormatOptions = {
    month: "short",
    year: "numeric",
    day: "numeric"
  };
  const formattedDate = new Intl.DateTimeFormat("en-US", dateFormatOptions).format(date);
  const day = date.getDate();
  const daySuffix = getDaySuffix(day);
  const parts = formattedDate.split(" ");
  return `${parts[0]} ${day}${daySuffix}, ${parts[2]}`;
}
function getDaySuffix(day) {
  if (day > 3 && day < 21)
    return "th";
  switch (day % 10) {
    case 1:
      return "st";
    case 2:
      return "nd";
    case 3:
      return "rd";
    default:
      return "th";
  }
}
function isDateFormat(text) {
  return /^\d{4}-\d{2}-\d{2}$/.test(text);
}

// src/utils/file-utils.ts
var import_obsidian2 = require("obsidian");
function getFilePath(folder, filename) {
  if (folder) {
    return `${folder}/${filename}`;
  }
  return filename;
}
async function ensureFolder(app, folderPath) {
  if (!folderPath) {
    return true;
  }
  const folderExists = app.vault.getAbstractFileByPath(folderPath);
  if (folderExists && !(folderExists instanceof import_obsidian2.TFolder)) {
    new import_obsidian2.Notice(`Cannot create folder: "${folderPath}" exists but is not a folder`);
    return false;
  }
  if (!folderExists) {
    try {
      await app.vault.createFolder(folderPath);
      new import_obsidian2.Notice(`Created folder: ${folderPath}`);
      return true;
    } catch (error) {
      new import_obsidian2.Notice(`Failed to create folder: ${error}`);
      console.error("Failed to create folder:", error);
      return false;
    }
  }
  return true;
}
function getJournalFilePath(journalFolder, filename, folderFormat = "") {
  if (!folderFormat) {
    return getFilePath(journalFolder, filename);
  }
  const datePart = filename.split(".")[0];
  if (!isDateFormat(datePart)) {
    return getFilePath(journalFolder, filename);
  }
  const [year, month, day] = datePart.split("-").map((part) => parseInt(part));
  let formattedPath = folderFormat;
  formattedPath = formattedPath.replace("YYYY", year.toString());
  formattedPath = formattedPath.replace("MM", month.toString().padStart(2, "0"));
  formattedPath = formattedPath.replace("DD", day.toString().padStart(2, "0"));
  if (journalFolder) {
    return `${journalFolder}/${formattedPath}/${filename}`;
  }
  return `${formattedPath}/${filename}`;
}
async function ensureAllFolders(app, filePath) {
  const pathParts = filePath.split("/");
  const fileNameIndex = pathParts.length - 1;
  let currentFolder = "";
  for (let i = 0; i < fileNameIndex; i++) {
    if (currentFolder) {
      currentFolder += "/";
    }
    currentFolder += pathParts[i];
    if (!currentFolder)
      continue;
    if (!await ensureFolder(app, currentFolder)) {
      return false;
    }
  }
  return true;
}
async function getOrCreateJournalFile(app, journalFolder, filename, folderFormat = "", initialContent = "") {
  const filePath = getJournalFilePath(journalFolder, filename, folderFormat);
  if (!await ensureAllFolders(app, filePath)) {
    return null;
  }
  let file = app.vault.getAbstractFileByPath(filePath);
  if (file instanceof import_obsidian2.TFile) {
    return file;
  }
  try {
    file = await app.vault.create(filePath, initialContent);
    new import_obsidian2.Notice(`Created journal entry: ${filename}`);
    return file;
  } catch (error) {
    new import_obsidian2.Notice(`Failed to create journal entry: ${error}`);
    console.error("Failed to create journal entry:", error);
    return null;
  }
}
function isJournalFile(file, journalFolder, folderFormat) {
  const isDateBasename = isDateFormat(file.basename);
  if (!isDateBasename) {
    return false;
  }
  if (!journalFolder) {
    return true;
  }
  if (folderFormat) {
    const dateStr = file.basename.split(".")[0];
    const [year, month, day] = dateStr.split("-");
    let expectedPath = folderFormat;
    expectedPath = expectedPath.replace("YYYY", year);
    expectedPath = expectedPath.replace("MM", month);
    expectedPath = expectedPath.replace("DD", day);
    const expectedFullPath = `${journalFolder}/${expectedPath}`;
    return file.path.startsWith(expectedFullPath);
  }
  return file.path.startsWith(journalFolder + "/");
}
function getJournalFiles(app, journalFolder, folderFormat) {
  const files = app.vault.getMarkdownFiles();
  return files.filter((file) => isJournalFile(file, journalFolder, folderFormat));
}
function sortJournalFiles(files, sortDirection) {
  return files.sort((a, b) => {
    if (sortDirection === "newest-first") {
      return b.basename.localeCompare(a.basename);
    } else {
      return a.basename.localeCompare(b.basename);
    }
  });
}

// src/journal-view.ts
var JournalView = class {
  constructor(plugin) {
    this.activeEditor = null;
    // Simple lazy loading properties
    this.allFiles = [];
    this.batchSize = 10;
    this.currentBatch = 0;
    this.loadMoreButton = null;
    this.plugin = plugin;
    this.registerCleanup();
  }
  // Opens the continuous journal view in a new leaf
  async open() {
    const leaf = this.plugin.app.workspace.getLeaf(true);
    await leaf.setViewState({
      type: "markdown",
      active: true
    });
    const contentEl = leaf.view.containerEl;
    contentEl.empty();
    const panel = contentEl.createDiv({ cls: "custom-journal-panel" });
    const journalFiles = getJournalFiles(
      this.plugin.app,
      this.plugin.settings.journalFolder,
      this.plugin.settings.folderFormat
    );
    if (journalFiles.length === 0) {
      new import_obsidian3.Notice("No journal entries found.");
      panel.createEl("div", {
        cls: "journal-empty-state",
        text: "No journal entries found. Create one by clicking the journals icon in the ribbon."
      });
      return;
    }
    this.allFiles = sortJournalFiles(journalFiles, this.plugin.settings.sortDirection);
    this.currentBatch = 0;
    await this.loadBatch(panel);
    if (this.currentBatch * this.batchSize < this.allFiles.length) {
      this.addLoadMoreButton(panel);
    }
  }
  // Load a batch of entries
  async loadBatch(panel) {
    const start = this.currentBatch * this.batchSize;
    const end = Math.min(start + this.batchSize, this.allFiles.length);
    const filesToLoad = this.allFiles.slice(start, end);
    for (const file of filesToLoad) {
      try {
        const fileContent = await this.plugin.app.vault.read(file);
        this.addJournalEntry(panel, file, fileContent);
      } catch (error) {
        console.error(`Error reading file ${file.path}:`, error);
        this.addErrorMessage(panel, file.basename, error);
      }
    }
    this.currentBatch++;
  }
  // Add a "Load More" button
  addLoadMoreButton(panel) {
    if (this.loadMoreButton) {
      this.loadMoreButton.remove();
    }
    this.loadMoreButton = panel.createEl("button", {
      cls: "journal-load-more-button",
      text: "Load More Entries"
    });
    const button = this.loadMoreButton;
    button.addEventListener("click", async () => {
      button.textContent = "Loading...";
      button.setAttr("disabled", "true");
      await this.loadBatch(panel);
      if (this.currentBatch * this.batchSize < this.allFiles.length) {
        button.textContent = "Load More Entries";
        button.removeAttribute("disabled");
      } else {
        button.remove();
        this.loadMoreButton = null;
      }
    });
  }
  // Adds an error message to the panel when file reading fails
  addErrorMessage(panel, filename, error) {
    const errorDiv = panel.createDiv({ cls: "journal-entry journal-error" });
    const errorHeader = errorDiv.createDiv({ cls: "journal-entry-header" });
    errorHeader.createEl("h3", {
      cls: "journal-entry-title",
      text: `${filename} - Error`
    });
    const errorContent = errorDiv.createDiv({ cls: "journal-error-content" });
    errorContent.textContent = `Failed to load journal: ${error.message || error}`;
  }
  // Adds a journal entry to the panel
  addJournalEntry(panel, file, content) {
    const journalDate = file.basename;
    const journalEntry = panel.createDiv({ cls: "journal-entry" });
    const header = journalEntry.createDiv({ cls: "journal-entry-header" });
    const toggleButton = header.createEl("button", { cls: "collapsible-toggle" });
    if (this.plugin.settings.defaultExpandEntries) {
      toggleButton.addClass("toggle-expanded");
    }
    const title = header.createEl("h3", { cls: "journal-entry-title" });
    const titleLink = title.createEl("a", {
      cls: "journal-entry-link",
      text: formatDateForDisplay(journalDate)
    });
    titleLink.addEventListener("click", (event) => {
      event.preventDefault();
      this.plugin.app.workspace.openLinkText(file.basename, file.path);
    });
    const contentArea = journalEntry.createDiv({
      cls: "collapsible-content" + (this.plugin.settings.defaultExpandEntries ? " content-expanded" : "")
    });
    let currentContent = content;
    let isEditing = false;
    const renderedContent = contentArea.createDiv({
      cls: "rendered-content active-view"
    });
    const editableContent = contentArea.createEl("textarea", {
      cls: "editable-content",
      value: currentContent
    });
    const closeButton = contentArea.createEl("button", {
      cls: "journal-close-button",
      text: "Close"
    });
    closeButton.style.display = "none";
    const saveIndicator = contentArea.createDiv({
      cls: "journal-save-indicator",
      text: "Saved"
    });
    saveIndicator.style.display = "none";
    window.requestAnimationFrame(() => {
      editableContent.style.height = editableContent.scrollHeight + "px";
    });
    const renderContent = () => {
      renderedContent.empty();
      import_obsidian3.MarkdownRenderer.render(this.plugin.app, currentContent, renderedContent, file.path, this.plugin);
    };
    renderContent();
    const enterEditMode = () => {
      isEditing = true;
      this.activeEditor = editableContent;
      editableContent.value = currentContent;
      renderedContent.classList.remove("active-view");
      editableContent.classList.add("active-view");
      closeButton.style.display = "block";
      editableContent.style.height = "auto";
      editableContent.style.height = editableContent.scrollHeight + "px";
      editableContent.focus();
    };
    const exitEditMode = async () => {
      if (isEditing) {
        currentContent = editableContent.value;
        await this.saveContentToFile(file, currentContent);
        renderContent();
        editableContent.classList.remove("active-view");
        closeButton.style.display = "none";
        renderedContent.classList.add("active-view");
        isEditing = false;
        if (this.activeEditor === editableContent) {
          this.activeEditor = null;
        }
      }
    };
    renderedContent.addEventListener("click", (event) => {
      const target = event.target;
      if (target.tagName === "A" || target.closest("a") || target.classList.contains("cm-hashtag") || target.closest(".cm-hashtag")) {
        return;
      }
      enterEditMode();
    });
    closeButton.addEventListener("click", () => {
      exitEditMode();
    });
    editableContent.addEventListener("keydown", (event) => {
      if (event.key === "Escape") {
        exitEditMode();
      }
    });
    editableContent.addEventListener("input", () => {
      editableContent.style.height = "auto";
      editableContent.style.height = editableContent.scrollHeight + "px";
      currentContent = editableContent.value;
    });
    let saveTimeout = null;
    editableContent.addEventListener("input", () => {
      saveIndicator.style.display = "block";
      saveIndicator.classList.remove("saved");
      saveIndicator.classList.add("saving");
      saveIndicator.textContent = "Saving...";
      if (saveTimeout) {
        clearTimeout(saveTimeout);
      }
      saveTimeout = setTimeout(async () => {
        await this.saveContentToFile(file, currentContent);
        saveIndicator.classList.remove("saving");
        saveIndicator.classList.add("saved");
        saveIndicator.textContent = "Saved";
        setTimeout(() => {
          if (saveIndicator.classList.contains("saved")) {
            saveIndicator.style.display = "none";
          }
        }, 2e3);
      }, 500);
    });
    toggleButton.addEventListener("click", () => {
      toggleButton.classList.toggle("toggle-expanded");
      contentArea.classList.toggle("content-expanded");
    });
  }
  /**
   * Saves the content to the file
   */
  async saveContentToFile(file, content) {
    try {
      await this.plugin.app.vault.modify(file, content);
    } catch (error) {
      new import_obsidian3.Notice(`Failed to save changes: ${error}`);
      console.error("Failed to save changes:", error);
    }
  }
  /**
   * Inserts a reference to a file into the active journal entry
   */
  insertFileReference(filePath) {
    if (!this.activeEditor) {
      new import_obsidian3.Notice("No active journal entry to insert file into");
      return;
    }
    const file = this.plugin.app.vault.getAbstractFileByPath(filePath);
    if (!(file instanceof import_obsidian3.TFile)) {
      new import_obsidian3.Notice("Invalid file");
      return;
    }
    let fileReference;
    if (this.isImageFile(file)) {
      fileReference = `![[${file.name}]]`;
    } else if (this.isMarkdownFile(file)) {
      fileReference = `![[${file.name}]]`;
    } else {
      fileReference = `![[${file.name}]]`;
    }
    this.activeEditor.focus();
    const cursorPos = this.activeEditor.selectionStart;
    const textBefore = this.activeEditor.value.substring(0, cursorPos);
    const textAfter = this.activeEditor.value.substring(this.activeEditor.selectionEnd);
    const newText = textBefore + "\n\n" + fileReference + "\n\n" + textAfter;
    this.activeEditor.value = newText;
    const newCursorPos = cursorPos + fileReference.length + 4;
    this.activeEditor.setSelectionRange(newCursorPos, newCursorPos);
    const inputEvent = new Event("input", { bubbles: true, cancelable: true });
    this.activeEditor.dispatchEvent(inputEvent);
    new import_obsidian3.Notice(`Inserted reference to ${file.name}`);
  }
  /**
   * Check if a file is an image
   */
  isImageFile(file) {
    const imageExtensions = ["png", "jpg", "jpeg", "gif", "svg", "webp"];
    const ext = file.extension.toLowerCase();
    return imageExtensions.includes(ext);
  }
  /**
   * Check if a file is a markdown file
   */
  isMarkdownFile(file) {
    const ext = file.extension.toLowerCase();
    return ext === "md" || ext === "markdown";
  }
  registerCleanup() {
    this.plugin.registerEvent(
      this.plugin.app.workspace.on("layout-change", () => {
        if (this.activeEditor) {
          const journalEntry = this.activeEditor.closest(".journal-entry");
          if (journalEntry) {
            const event = new KeyboardEvent("keydown", { key: "Escape" });
            this.activeEditor.dispatchEvent(event);
          }
          this.activeEditor = null;
        }
      })
    );
  }
};

// src/main.ts
var JournalingPlugin = class extends import_obsidian4.Plugin {
  async onload() {
    await this.loadSettings();
    this.journalView = new JournalView(this);
    const ribbonIconEl = this.addRibbonIcon(
      "notebook-text",
      "Open Journals",
      async (evt) => {
        await this.openJournalView();
      }
    );
    ribbonIconEl.addClass("journaling-ribbon-icon");
    this.addCommand({
      id: "open-journal-view",
      name: "Open Journal View",
      callback: () => {
        this.openJournalView();
      }
    });
    this.addCommand({
      id: "create-todays-journal",
      name: "Create/Open Today's Journal",
      callback: () => {
        this.createTodaysJournal();
      }
    });
    this.addSettingTab(new JournalingSettingTab(this.app, this));
    this.registerEvent(
      this.app.workspace.on("file-menu", (menu, file) => {
        if (file instanceof import_obsidian4.TFile) {
          menu.addItem((item) => {
            item.setTitle("Insert into Journal").setIcon("text-cursor-input").onClick(() => {
              const journalView = this.journalView;
              if (journalView) {
                journalView.insertFileReference(file.path);
              } else {
                new import_obsidian4.Notice("Open the journal view first to insert file reference");
              }
            });
          });
        }
      })
    );
  }
  // Opens the continuous journal view
  async openJournalView() {
    await this.createTodaysJournal();
    await this.journalView.open();
  }
  // Creates or opens today's journal entry
  async createTodaysJournal() {
    const date = getTodayDate();
    const fileName = `${date}.md`;
    const file = await getOrCreateJournalFile(
      this.app,
      this.settings.journalFolder,
      fileName,
      this.settings.folderFormat
      // Pass the folder format setting
    );
    if (!file) {
      new import_obsidian4.Notice("Failed to create or open today's journal");
      return;
    }
  }
  async loadSettings() {
    this.settings = Object.assign({}, DEFAULT_SETTINGS, await this.loadData());
  }
  async saveSettings() {
    await this.saveData(this.settings);
  }
  /**
   * Migrates existing journal entries to the new folder structure
   */
  async migrateJournalEntries() {
    const journalFiles = getJournalFiles(
      this.app,
      this.settings.journalFolder,
      ""
      // Use empty folder format to get all files regardless of structure
    );
    if (journalFiles.length === 0) {
      new import_obsidian4.Notice("No journal entries found to migrate.");
      return;
    }
    if (!this.settings.folderFormat) {
      new import_obsidian4.Notice("Please set a folder format in settings before migrating.");
      return;
    }
    const confirmMessage = `Migrate ${journalFiles.length} journal entries to new folder structure? This will:
    1. Move files to folders based on the pattern: ${this.settings.folderFormat}
    2. Create any necessary folders
    3. Keep the original filename
    
    This operation cannot be undone automatically.`;
    if (!confirm(confirmMessage)) {
      return;
    }
    const modal = new MigrationModal(this.app, journalFiles.length);
    modal.open();
    let migratedCount = 0;
    let errorCount = 0;
    for (const file of journalFiles) {
      try {
        modal.updateStatus(`Migrating ${file.name}...`);
        const newPath = getJournalFilePath(
          this.settings.journalFolder,
          file.name,
          this.settings.folderFormat
        );
        if (file.path === newPath) {
          migratedCount++;
          modal.updateProgress(migratedCount);
          continue;
        }
        const content = await this.app.vault.read(file);
        await ensureAllFolders(this.app, newPath);
        await this.app.vault.create(newPath, content);
        await this.app.vault.delete(file);
        migratedCount++;
        modal.updateProgress(migratedCount);
      } catch (error) {
        console.error(`Error migrating file ${file.path}:`, error);
        modal.updateStatus(`Error migrating ${file.name}: ${error}`);
        errorCount++;
      }
    }
    modal.updateStatus(`Migration complete! Migrated ${migratedCount} files with ${errorCount} errors.`);
    setTimeout(() => {
      modal.close();
      new import_obsidian4.Notice(`Migration complete! Migrated ${migratedCount} files with ${errorCount} errors.`);
    }, 3e3);
  }
};
var MigrationModal = class extends import_obsidian4.Modal {
  constructor(app, totalFiles) {
    super(app);
    this.totalFiles = totalFiles;
  }
  onOpen() {
    const { contentEl } = this;
    contentEl.createEl("h2", { text: "Migrating Journal Entries" });
    this.progressEl = contentEl.createEl("div", {
      cls: "migration-progress",
      text: "0/" + this.totalFiles
    });
    this.statusEl = contentEl.createEl("div", {
      cls: "migration-status",
      text: "Starting migration..."
    });
  }
  updateProgress(completed) {
    this.progressEl.textContent = `${completed}/${this.totalFiles}`;
  }
  updateStatus(message) {
    this.statusEl.textContent = message;
  }
  onClose() {
    const { contentEl } = this;
    contentEl.empty();
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsic3JjL21haW4udHMiLCAic3JjL3NldHRpbmdzLnRzIiwgInNyYy9qb3VybmFsLXZpZXcudHMiLCAic3JjL3V0aWxzL2RhdGUtdXRpbHMudHMiLCAic3JjL3V0aWxzL2ZpbGUtdXRpbHMudHMiXSwKICAic291cmNlc0NvbnRlbnQiOiBbImltcG9ydCB7IEFwcCwgUGx1Z2luLCBOb3RpY2UsIFRGaWxlLCBNb2RhbCB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCB7IERFRkFVTFRfU0VUVElOR1MsIEpvdXJuYWxpbmdTZXR0aW5ncywgSm91cm5hbGluZ1NldHRpbmdUYWIgfSBmcm9tICcuL3NldHRpbmdzJztcbmltcG9ydCB7IEpvdXJuYWxWaWV3IH0gZnJvbSAnLi9qb3VybmFsLXZpZXcnO1xuaW1wb3J0IHsgZ2V0VG9kYXlEYXRlIH0gZnJvbSAnLi91dGlscy9kYXRlLXV0aWxzJztcbmltcG9ydCB7IGdldE9yQ3JlYXRlSm91cm5hbEZpbGUsIGdldEpvdXJuYWxGaWxlcywgZ2V0Sm91cm5hbEZpbGVQYXRoLCBlbnN1cmVBbGxGb2xkZXJzIH0gZnJvbSAnLi91dGlscy9maWxlLXV0aWxzJztcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgSm91cm5hbGluZ1BsdWdpbiBleHRlbmRzIFBsdWdpbiB7XG4gICAgc2V0dGluZ3M6IEpvdXJuYWxpbmdTZXR0aW5ncztcbiAgICBqb3VybmFsVmlldzogSm91cm5hbFZpZXc7XG5cbiAgICBhc3luYyBvbmxvYWQoKSB7XG4gICAgICAgIC8vIExvYWQgc2V0dGluZ3NcbiAgICAgICAgYXdhaXQgdGhpcy5sb2FkU2V0dGluZ3MoKTtcbiAgICAgICAgXG4gICAgICAgIC8vIEluaXRpYWxpemUgam91cm5hbCB2aWV3XG4gICAgICAgIHRoaXMuam91cm5hbFZpZXcgPSBuZXcgSm91cm5hbFZpZXcodGhpcyk7XG4gICAgICAgIFxuICAgICAgICAvLyBBZGQgcmliYm9uIGljb25cbiAgICAgICAgY29uc3QgcmliYm9uSWNvbkVsID0gdGhpcy5hZGRSaWJib25JY29uKFxuICAgICAgICAgICAgJ25vdGVib29rLXRleHQnLCBcbiAgICAgICAgICAgICdPcGVuIEpvdXJuYWxzJywgXG4gICAgICAgICAgICBhc3luYyAoZXZ0OiBNb3VzZUV2ZW50KSA9PiB7XG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5vcGVuSm91cm5hbFZpZXcoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgKTtcbiAgICAgICAgcmliYm9uSWNvbkVsLmFkZENsYXNzKCdqb3VybmFsaW5nLXJpYmJvbi1pY29uJyk7XG4gICAgICAgIFxuICAgICAgICAvLyBBZGQgY29tbWFuZCB0byBvcGVuIGpvdXJuYWwgdmlld1xuICAgICAgICB0aGlzLmFkZENvbW1hbmQoe1xuICAgICAgICAgICAgaWQ6ICdvcGVuLWpvdXJuYWwtdmlldycsXG4gICAgICAgICAgICBuYW1lOiAnT3BlbiBKb3VybmFsIFZpZXcnLFxuICAgICAgICAgICAgY2FsbGJhY2s6ICgpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLm9wZW5Kb3VybmFsVmlldygpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgfSk7XG4gICAgICAgIFxuICAgICAgICAvLyBBZGQgY29tbWFuZCBmb3IgY3JlYXRpbmcgdG9kYXkncyBqb3VybmFsXG4gICAgICAgIHRoaXMuYWRkQ29tbWFuZCh7XG4gICAgICAgICAgICBpZDogJ2NyZWF0ZS10b2RheXMtam91cm5hbCcsXG4gICAgICAgICAgICBuYW1lOiAnQ3JlYXRlL09wZW4gVG9kYXlcXCdzIEpvdXJuYWwnLFxuICAgICAgICAgICAgY2FsbGJhY2s6ICgpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLmNyZWF0ZVRvZGF5c0pvdXJuYWwoKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH0pO1xuICAgICAgICBcbiAgICAgICAgLy8gUmVnaXN0ZXIgc2V0dGluZ3MgdGFiXG4gICAgICAgIHRoaXMuYWRkU2V0dGluZ1RhYihuZXcgSm91cm5hbGluZ1NldHRpbmdUYWIodGhpcy5hcHAsIHRoaXMpKTtcblxuICAgICAgICAvLyBBZGQgY29udGV4dCBtZW51IG9wdGlvbiBmb3IgZmlsZXMgdG8gaW5zZXJ0IGludG8gam91cm5hbHNcbiAgICAgICAgdGhpcy5yZWdpc3RlckV2ZW50KFxuICAgICAgICAgICAgdGhpcy5hcHAud29ya3NwYWNlLm9uKCdmaWxlLW1lbnUnLCAobWVudSwgZmlsZSkgPT4ge1xuICAgICAgICAgICAgICAgIC8vIENoZWNrIGlmIHRoZSBmaWxlIGlzIGEgVEZpbGUgKGFjdHVhbCBmaWxlKVxuICAgICAgICAgICAgICAgIGlmIChmaWxlIGluc3RhbmNlb2YgVEZpbGUpIHtcbiAgICAgICAgICAgICAgICAgICAgbWVudS5hZGRJdGVtKChpdGVtKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpdGVtXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnNldFRpdGxlKCdJbnNlcnQgaW50byBKb3VybmFsJylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuc2V0SWNvbigndGV4dC1jdXJzb3ItaW5wdXQnKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5vbkNsaWNrKCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gRmluZCB0aGUgYWN0aXZlIGpvdXJuYWwgdmlldyBpZiBpdCBleGlzdHNcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgam91cm5hbFZpZXcgPSB0aGlzLmpvdXJuYWxWaWV3O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoam91cm5hbFZpZXcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIEluc2VydCB0aGUgZmlsZSByZWZlcmVuY2UgaW50byB0aGUgYWN0aXZlIGVkaXRvclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgam91cm5hbFZpZXcuaW5zZXJ0RmlsZVJlZmVyZW5jZShmaWxlLnBhdGgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3IE5vdGljZSgnT3BlbiB0aGUgam91cm5hbCB2aWV3IGZpcnN0IHRvIGluc2VydCBmaWxlIHJlZmVyZW5jZScpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pXG4gICAgICAgICk7XG4gICAgfVxuXG4gICAgLy8gT3BlbnMgdGhlIGNvbnRpbnVvdXMgam91cm5hbCB2aWV3XG4gICAgYXN5bmMgb3BlbkpvdXJuYWxWaWV3KCk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICAvLyBGaXJzdCwgZW5zdXJlIHRvZGF5J3Mgam91cm5hbCBleGlzdHNcbiAgICAgICAgYXdhaXQgdGhpcy5jcmVhdGVUb2RheXNKb3VybmFsKCk7XG4gICAgICAgIFxuICAgICAgICAvLyBUaGVuIG9wZW4gdGhlIGNvbnRpbnVvdXMgdmlld1xuICAgICAgICBhd2FpdCB0aGlzLmpvdXJuYWxWaWV3Lm9wZW4oKTtcbiAgICB9XG4gICAgXG4gICAgLy8gQ3JlYXRlcyBvciBvcGVucyB0b2RheSdzIGpvdXJuYWwgZW50cnlcbiAgICBhc3luYyBjcmVhdGVUb2RheXNKb3VybmFsKCk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBjb25zdCBkYXRlID0gZ2V0VG9kYXlEYXRlKCk7XG4gICAgICAgIGNvbnN0IGZpbGVOYW1lID0gYCR7ZGF0ZX0ubWRgO1xuICAgICAgICBcbiAgICAgICAgY29uc3QgZmlsZSA9IGF3YWl0IGdldE9yQ3JlYXRlSm91cm5hbEZpbGUoXG4gICAgICAgICAgICB0aGlzLmFwcCwgXG4gICAgICAgICAgICB0aGlzLnNldHRpbmdzLmpvdXJuYWxGb2xkZXIsIFxuICAgICAgICAgICAgZmlsZU5hbWUsXG4gICAgICAgICAgICB0aGlzLnNldHRpbmdzLmZvbGRlckZvcm1hdCAvLyBQYXNzIHRoZSBmb2xkZXIgZm9ybWF0IHNldHRpbmdcbiAgICAgICAgKTtcbiAgICAgICAgXG4gICAgICAgIGlmICghZmlsZSkge1xuICAgICAgICAgICAgbmV3IE5vdGljZSgnRmFpbGVkIHRvIGNyZWF0ZSBvciBvcGVuIHRvZGF5XFwncyBqb3VybmFsJyk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICB9XG4gICAgXG4gICAgYXN5bmMgbG9hZFNldHRpbmdzKCkge1xuICAgICAgICB0aGlzLnNldHRpbmdzID0gT2JqZWN0LmFzc2lnbih7fSwgREVGQVVMVF9TRVRUSU5HUywgYXdhaXQgdGhpcy5sb2FkRGF0YSgpKTtcbiAgICB9XG5cbiAgICBhc3luYyBzYXZlU2V0dGluZ3MoKSB7XG4gICAgICAgIGF3YWl0IHRoaXMuc2F2ZURhdGEodGhpcy5zZXR0aW5ncyk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogTWlncmF0ZXMgZXhpc3Rpbmcgam91cm5hbCBlbnRyaWVzIHRvIHRoZSBuZXcgZm9sZGVyIHN0cnVjdHVyZVxuICAgICAqL1xuICAgIGFzeW5jIG1pZ3JhdGVKb3VybmFsRW50cmllcygpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgY29uc3Qgam91cm5hbEZpbGVzID0gZ2V0Sm91cm5hbEZpbGVzKFxuICAgICAgICAgICAgdGhpcy5hcHAsIFxuICAgICAgICAgICAgdGhpcy5zZXR0aW5ncy5qb3VybmFsRm9sZGVyLFxuICAgICAgICAgICAgJycgLy8gVXNlIGVtcHR5IGZvbGRlciBmb3JtYXQgdG8gZ2V0IGFsbCBmaWxlcyByZWdhcmRsZXNzIG9mIHN0cnVjdHVyZVxuICAgICAgICApO1xuICAgICAgICBcbiAgICAgICAgaWYgKGpvdXJuYWxGaWxlcy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgIG5ldyBOb3RpY2UoJ05vIGpvdXJuYWwgZW50cmllcyBmb3VuZCB0byBtaWdyYXRlLicpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyBJZiBubyBmb2xkZXIgZm9ybWF0IGlzIHNldCwgbm90aGluZyB0byBtaWdyYXRlXG4gICAgICAgIGlmICghdGhpcy5zZXR0aW5ncy5mb2xkZXJGb3JtYXQpIHtcbiAgICAgICAgICAgIG5ldyBOb3RpY2UoJ1BsZWFzZSBzZXQgYSBmb2xkZXIgZm9ybWF0IGluIHNldHRpbmdzIGJlZm9yZSBtaWdyYXRpbmcuJyk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIENvbmZpcm1hdGlvbiBkaWFsb2dcbiAgICAgICAgY29uc3QgY29uZmlybU1lc3NhZ2UgPSBgTWlncmF0ZSAke2pvdXJuYWxGaWxlcy5sZW5ndGh9IGpvdXJuYWwgZW50cmllcyB0byBuZXcgZm9sZGVyIHN0cnVjdHVyZT8gVGhpcyB3aWxsOlxuICAgIDEuIE1vdmUgZmlsZXMgdG8gZm9sZGVycyBiYXNlZCBvbiB0aGUgcGF0dGVybjogJHt0aGlzLnNldHRpbmdzLmZvbGRlckZvcm1hdH1cbiAgICAyLiBDcmVhdGUgYW55IG5lY2Vzc2FyeSBmb2xkZXJzXG4gICAgMy4gS2VlcCB0aGUgb3JpZ2luYWwgZmlsZW5hbWVcbiAgICBcbiAgICBUaGlzIG9wZXJhdGlvbiBjYW5ub3QgYmUgdW5kb25lIGF1dG9tYXRpY2FsbHkuYDtcbiAgICAgICAgXG4gICAgICAgIGlmICghY29uZmlybShjb25maXJtTWVzc2FnZSkpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgLy8gQ3JlYXRlIGFuZCBvcGVuIG1vZGFsXG4gICAgICAgIGNvbnN0IG1vZGFsID0gbmV3IE1pZ3JhdGlvbk1vZGFsKHRoaXMuYXBwLCBqb3VybmFsRmlsZXMubGVuZ3RoKTtcbiAgICAgICAgbW9kYWwub3BlbigpO1xuICAgICAgICBcbiAgICAgICAgLy8gVHJhY2sgcHJvZ3Jlc3NcbiAgICAgICAgbGV0IG1pZ3JhdGVkQ291bnQgPSAwO1xuICAgICAgICBsZXQgZXJyb3JDb3VudCA9IDA7XG4gICAgICAgIFxuICAgICAgICBmb3IgKGNvbnN0IGZpbGUgb2Ygam91cm5hbEZpbGVzKSB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIC8vIFVwZGF0ZSBzdGF0dXNcbiAgICAgICAgICAgICAgICBtb2RhbC51cGRhdGVTdGF0dXMoYE1pZ3JhdGluZyAke2ZpbGUubmFtZX0uLi5gKTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAvLyBHZW5lcmF0ZSB0aGUgbmV3IHBhdGggYmFzZWQgb24gdGhlIGN1cnJlbnQgZm9sZGVyIGZvcm1hdFxuICAgICAgICAgICAgICAgIGNvbnN0IG5ld1BhdGggPSBnZXRKb3VybmFsRmlsZVBhdGgoXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0dGluZ3Muam91cm5hbEZvbGRlcixcbiAgICAgICAgICAgICAgICAgICAgZmlsZS5uYW1lLFxuICAgICAgICAgICAgICAgICAgICB0aGlzLnNldHRpbmdzLmZvbGRlckZvcm1hdFxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgLy8gU2tpcCBpZiBmaWxlIGlzIGFscmVhZHkgaW4gdGhlIGNvcnJlY3QgbG9jYXRpb25cbiAgICAgICAgICAgICAgICBpZiAoZmlsZS5wYXRoID09PSBuZXdQYXRoKSB7XG4gICAgICAgICAgICAgICAgICAgIG1pZ3JhdGVkQ291bnQrKztcbiAgICAgICAgICAgICAgICAgICAgbW9kYWwudXBkYXRlUHJvZ3Jlc3MobWlncmF0ZWRDb3VudCk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAvLyBSZWFkIGZpbGUgY29udGVudFxuICAgICAgICAgICAgICAgIGNvbnN0IGNvbnRlbnQgPSBhd2FpdCB0aGlzLmFwcC52YXVsdC5yZWFkKGZpbGUpO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIC8vIEVuc3VyZSBhbGwgZm9sZGVycyBpbiB0aGUgcGF0aCBleGlzdFxuICAgICAgICAgICAgICAgIGF3YWl0IGVuc3VyZUFsbEZvbGRlcnModGhpcy5hcHAsIG5ld1BhdGgpO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIC8vIENyZWF0ZSB0aGUgZmlsZSBhdCB0aGUgbmV3IGxvY2F0aW9uXG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5hcHAudmF1bHQuY3JlYXRlKG5ld1BhdGgsIGNvbnRlbnQpO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIC8vIERlbGV0ZSB0aGUgb3JpZ2luYWwgZmlsZVxuICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMuYXBwLnZhdWx0LmRlbGV0ZShmaWxlKTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBtaWdyYXRlZENvdW50Kys7XG4gICAgICAgICAgICAgICAgbW9kYWwudXBkYXRlUHJvZ3Jlc3MobWlncmF0ZWRDb3VudCk7XG4gICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoYEVycm9yIG1pZ3JhdGluZyBmaWxlICR7ZmlsZS5wYXRofTpgLCBlcnJvcik7XG4gICAgICAgICAgICAgICAgbW9kYWwudXBkYXRlU3RhdHVzKGBFcnJvciBtaWdyYXRpbmcgJHtmaWxlLm5hbWV9OiAke2Vycm9yfWApO1xuICAgICAgICAgICAgICAgIGVycm9yQ291bnQrKztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgLy8gVXBkYXRlIGZpbmFsIHN0YXR1c1xuICAgICAgICBtb2RhbC51cGRhdGVTdGF0dXMoYE1pZ3JhdGlvbiBjb21wbGV0ZSEgTWlncmF0ZWQgJHttaWdyYXRlZENvdW50fSBmaWxlcyB3aXRoICR7ZXJyb3JDb3VudH0gZXJyb3JzLmApO1xuICAgICAgICBcbiAgICAgICAgLy8gQ2xvc2UgbW9kYWwgYWZ0ZXIgYSBkZWxheVxuICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgIG1vZGFsLmNsb3NlKCk7XG4gICAgICAgICAgICBuZXcgTm90aWNlKGBNaWdyYXRpb24gY29tcGxldGUhIE1pZ3JhdGVkICR7bWlncmF0ZWRDb3VudH0gZmlsZXMgd2l0aCAke2Vycm9yQ291bnR9IGVycm9ycy5gKTtcbiAgICAgICAgfSwgMzAwMCk7XG4gICAgfVxufVxuXG5jbGFzcyBNaWdyYXRpb25Nb2RhbCBleHRlbmRzIE1vZGFsIHtcbiAgICB0b3RhbEZpbGVzOiBudW1iZXI7XG4gICAgcHJvZ3Jlc3NFbDogSFRNTEVsZW1lbnQ7XG4gICAgc3RhdHVzRWw6IEhUTUxFbGVtZW50O1xuICAgIFxuICAgIGNvbnN0cnVjdG9yKGFwcDogQXBwLCB0b3RhbEZpbGVzOiBudW1iZXIpIHtcbiAgICAgICAgc3VwZXIoYXBwKTtcbiAgICAgICAgdGhpcy50b3RhbEZpbGVzID0gdG90YWxGaWxlcztcbiAgICB9XG4gICAgXG4gICAgb25PcGVuKCkge1xuICAgICAgICBjb25zdCB7IGNvbnRlbnRFbCB9ID0gdGhpcztcbiAgICAgICAgY29udGVudEVsLmNyZWF0ZUVsKCdoMicsIHsgdGV4dDogJ01pZ3JhdGluZyBKb3VybmFsIEVudHJpZXMnIH0pO1xuICAgICAgICBcbiAgICAgICAgLy8gQ3JlYXRlIHByb2dyZXNzIGRpc3BsYXlcbiAgICAgICAgdGhpcy5wcm9ncmVzc0VsID0gY29udGVudEVsLmNyZWF0ZUVsKCdkaXYnLCB7IFxuICAgICAgICAgICAgY2xzOiAnbWlncmF0aW9uLXByb2dyZXNzJyxcbiAgICAgICAgICAgIHRleHQ6ICcwLycgKyB0aGlzLnRvdGFsRmlsZXNcbiAgICAgICAgfSk7XG4gICAgICAgIFxuICAgICAgICAvLyBDcmVhdGUgc3RhdHVzIG1lc3NhZ2VcbiAgICAgICAgdGhpcy5zdGF0dXNFbCA9IGNvbnRlbnRFbC5jcmVhdGVFbCgnZGl2Jywge1xuICAgICAgICAgICAgY2xzOiAnbWlncmF0aW9uLXN0YXR1cycsXG4gICAgICAgICAgICB0ZXh0OiAnU3RhcnRpbmcgbWlncmF0aW9uLi4uJ1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgXG4gICAgdXBkYXRlUHJvZ3Jlc3MoY29tcGxldGVkOiBudW1iZXIpIHtcbiAgICAgICAgdGhpcy5wcm9ncmVzc0VsLnRleHRDb250ZW50ID0gYCR7Y29tcGxldGVkfS8ke3RoaXMudG90YWxGaWxlc31gO1xuICAgIH1cbiAgICBcbiAgICB1cGRhdGVTdGF0dXMobWVzc2FnZTogc3RyaW5nKSB7XG4gICAgICAgIHRoaXMuc3RhdHVzRWwudGV4dENvbnRlbnQgPSBtZXNzYWdlO1xuICAgIH1cbiAgICBcbiAgICBvbkNsb3NlKCkge1xuICAgICAgICBjb25zdCB7IGNvbnRlbnRFbCB9ID0gdGhpcztcbiAgICAgICAgY29udGVudEVsLmVtcHR5KCk7XG4gICAgfVxufSIsICJpbXBvcnQgeyBBcHAsIFBsdWdpblNldHRpbmdUYWIsIFNldHRpbmcsIE1vZGFsIH0gZnJvbSAnb2JzaWRpYW4nO1xuaW1wb3J0IEpvdXJuYWxpbmdQbHVnaW4gZnJvbSAnLi9tYWluJztcblxuZXhwb3J0IGludGVyZmFjZSBKb3VybmFsaW5nU2V0dGluZ3Mge1xuICAgIGpvdXJuYWxGb2xkZXI6IHN0cmluZztcbiAgICBkYXRlRm9ybWF0OiBzdHJpbmc7XG4gICAgc29ydERpcmVjdGlvbjogJ25ld2VzdC1maXJzdCcgfCAnb2xkZXN0LWZpcnN0JztcbiAgICBkZWZhdWx0RXhwYW5kRW50cmllczogYm9vbGVhbjtcbiAgICBmb2xkZXJGb3JtYXQ6IHN0cmluZztcbn1cblxuZXhwb3J0IGNvbnN0IERFRkFVTFRfU0VUVElOR1M6IEpvdXJuYWxpbmdTZXR0aW5ncyA9IHtcbiAgICBqb3VybmFsRm9sZGVyOiAnam91cm5hbHMnLFxuICAgIGRhdGVGb3JtYXQ6ICdZWVlZLU1NLUREJyxcbiAgICBzb3J0RGlyZWN0aW9uOiAnbmV3ZXN0LWZpcnN0JyxcbiAgICBkZWZhdWx0RXhwYW5kRW50cmllczogdHJ1ZSxcbiAgICBmb2xkZXJGb3JtYXQ6ICcnLFxufTtcblxuZXhwb3J0IGNsYXNzIEpvdXJuYWxpbmdTZXR0aW5nVGFiIGV4dGVuZHMgUGx1Z2luU2V0dGluZ1RhYiB7XG4gICAgcGx1Z2luOiBKb3VybmFsaW5nUGx1Z2luO1xuXG4gICAgY29uc3RydWN0b3IoYXBwOiBBcHAsIHBsdWdpbjogSm91cm5hbGluZ1BsdWdpbikge1xuICAgICAgICBzdXBlcihhcHAsIHBsdWdpbik7XG4gICAgICAgIHRoaXMucGx1Z2luID0gcGx1Z2luO1xuICAgIH1cblxuICAgIGRpc3BsYXkoKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IHsgY29udGFpbmVyRWwgfSA9IHRoaXM7XG4gICAgICAgIGNvbnRhaW5lckVsLmVtcHR5KCk7XG5cbiAgICAgICAgY29udGFpbmVyRWwuY3JlYXRlRWwoJ2gyJywgeyB0ZXh0OiAnQ29udGludW91cyBKb3VybmFsaW5nIFNldHRpbmdzJyB9KTtcblxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcbiAgICAgICAgICAgIC5zZXROYW1lKCdKb3VybmFsIEZvbGRlcicpXG4gICAgICAgICAgICAuc2V0RGVzYygnU3BlY2lmeSB0aGUgZm9sZGVyIHdoZXJlIGpvdXJuYWwgZW50cmllcyB3aWxsIGJlIHN0b3JlZCcpXG4gICAgICAgICAgICAuYWRkVGV4dCh0ZXh0ID0+IHRleHRcbiAgICAgICAgICAgICAgICAuc2V0UGxhY2Vob2xkZXIoJ2pvdXJuYWxzJylcbiAgICAgICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3Muam91cm5hbEZvbGRlcilcbiAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIC8vIFJlbW92ZSBsZWFkaW5nIGFuZCB0cmFpbGluZyBzbGFzaGVzIGZvciBjb25zaXN0ZW5jeVxuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5qb3VybmFsRm9sZGVyID0gdmFsdWUucmVwbGFjZSgvXlxcLyt8XFwvKyQvZywgJycpO1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICB9KSk7XG5cbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAgICAgICAuc2V0TmFtZSgnRGF0ZSBGb3JtYXQnKVxuICAgICAgICAgICAgLnNldERlc2MoJ0Zvcm1hdCBmb3Igam91cm5hbCBmaWxlbmFtZXMgKFlZWVktTU0tREQgcmVjb21tZW5kZWQpJylcbiAgICAgICAgICAgIC5hZGRUZXh0KHRleHQgPT4gdGV4dFxuICAgICAgICAgICAgICAgIC5zZXRQbGFjZWhvbGRlcignWVlZWS1NTS1ERCcpXG4gICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmRhdGVGb3JtYXQpXG4gICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5kYXRlRm9ybWF0ID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgIH0pKTtcblxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcbiAgICAgICAgICAgIC5zZXROYW1lKCdTb3J0IERpcmVjdGlvbicpXG4gICAgICAgICAgICAuc2V0RGVzYygnSG93IHRvIHNvcnQgam91cm5hbCBlbnRyaWVzIGluIHRoZSBjb250aW51b3VzIHZpZXcnKVxuICAgICAgICAgICAgLmFkZERyb3Bkb3duKGRyb3Bkb3duID0+IGRyb3Bkb3duXG4gICAgICAgICAgICAgICAgLmFkZE9wdGlvbignbmV3ZXN0LWZpcnN0JywgJ05ld2VzdCBlbnRyaWVzIGZpcnN0JylcbiAgICAgICAgICAgICAgICAuYWRkT3B0aW9uKCdvbGRlc3QtZmlyc3QnLCAnT2xkZXN0IGVudHJpZXMgZmlyc3QnKVxuICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5zb3J0RGlyZWN0aW9uKVxuICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWU6ICduZXdlc3QtZmlyc3QnIHwgJ29sZGVzdC1maXJzdCcpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3Muc29ydERpcmVjdGlvbiA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICB9KSk7XG5cbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAgICAgICAuc2V0TmFtZSgnRGVmYXVsdCBFeHBhbmQgRW50cmllcycpXG4gICAgICAgICAgICAuc2V0RGVzYygnQXV0b21hdGljYWxseSBleHBhbmQgZW50cmllcyB3aGVuIG9wZW5pbmcgdGhlIGpvdXJuYWxzIHZpZXcnKVxuICAgICAgICAgICAgLmFkZFRvZ2dsZSh0b2dnbGUgPT4gdG9nZ2xlXG4gICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmRlZmF1bHRFeHBhbmRFbnRyaWVzKVxuICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuZGVmYXVsdEV4cGFuZEVudHJpZXMgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgfSkpO1xuXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgICAgICAgLnNldE5hbWUoJ0ZvbGRlciBTdHJ1Y3R1cmUgRm9ybWF0JylcbiAgICAgICAgICAgIC5zZXREZXNjKCdGb3JtYXQgcGF0dGVybiBmb3Igb3JnYW5pemluZyBqb3VybmFsIGVudHJpZXMgaW4gc3ViZm9sZGVycy4gRXhhbXBsZXM6IGVtcHR5IGZvciBmbGF0IHN0cnVjdHVyZSwgXCJZWVlZXCIgZm9yIHllYXJseSBmb2xkZXJzLCBcIllZWVkvTU1cIiBmb3IgbW9udGhseSBmb2xkZXJzLicpXG4gICAgICAgICAgICAuYWRkVGV4dCh0ZXh0ID0+IHRleHRcbiAgICAgICAgICAgICAgICAuc2V0UGxhY2Vob2xkZXIoJ1lZWVkvTU0nKVxuICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5mb2xkZXJGb3JtYXQpXG4gICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5mb2xkZXJGb3JtYXQgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgIH0pKTtcblxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcbiAgICAgICAgICAgIC5zZXROYW1lKCdNaWdyYXRlIEpvdXJuYWwgRW50cmllcycpXG4gICAgICAgICAgICAuc2V0RGVzYygnTW92ZSBleGlzdGluZyBqb3VybmFsIGVudHJpZXMgdG8gdGhlIGZvbGRlciBzdHJ1Y3R1cmUgZGVmaW5lZCBieSB0aGUgZm9sZGVyIGZvcm1hdCBwYXR0ZXJuLicpXG4gICAgICAgICAgICAuYWRkQnV0dG9uKGJ1dHRvbiA9PiBidXR0b25cbiAgICAgICAgICAgICAgICAuc2V0QnV0dG9uVGV4dCgnTWlncmF0ZSBFbnRyaWVzJylcbiAgICAgICAgICAgICAgICAuc2V0Q3RhKCkgLy8gTWFrZSBpdCBhIGNhbGwtdG8tYWN0aW9uIGJ1dHRvblxuICAgICAgICAgICAgICAgIC5vbkNsaWNrKGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4ubWlncmF0ZUpvdXJuYWxFbnRyaWVzKCk7XG4gICAgICAgIH0pKTtcbiAgICB9XG59IiwgImltcG9ydCB7IE1hcmtkb3duUmVuZGVyZXIsIE5vdGljZSwgVEZpbGUsIFdvcmtzcGFjZUxlYWYgfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgSm91cm5hbGluZ1BsdWdpbiBmcm9tICcuL21haW4nO1xuaW1wb3J0IHsgZm9ybWF0RGF0ZUZvckRpc3BsYXkgfSBmcm9tICcuL3V0aWxzL2RhdGUtdXRpbHMnO1xuaW1wb3J0IHsgZ2V0Sm91cm5hbEZpbGVzLCBzb3J0Sm91cm5hbEZpbGVzIH0gZnJvbSAnLi91dGlscy9maWxlLXV0aWxzJztcblxuZXhwb3J0IGNsYXNzIEpvdXJuYWxWaWV3IHtcbiAgICBwbHVnaW46IEpvdXJuYWxpbmdQbHVnaW47XG4gICAgYWN0aXZlRWRpdG9yOiBIVE1MVGV4dEFyZWFFbGVtZW50IHwgbnVsbCA9IG51bGw7XG4gICAgXG4gICAgLy8gU2ltcGxlIGxhenkgbG9hZGluZyBwcm9wZXJ0aWVzXG4gICAgcHJpdmF0ZSBhbGxGaWxlczogVEZpbGVbXSA9IFtdO1xuICAgIHByaXZhdGUgYmF0Y2hTaXplOiBudW1iZXIgPSAxMDtcbiAgICBwcml2YXRlIGN1cnJlbnRCYXRjaDogbnVtYmVyID0gMDtcbiAgICBwcml2YXRlIGxvYWRNb3JlQnV0dG9uOiBIVE1MRWxlbWVudCB8IG51bGwgPSBudWxsO1xuICAgIFxuICAgIGNvbnN0cnVjdG9yKHBsdWdpbjogSm91cm5hbGluZ1BsdWdpbikge1xuICAgICAgICB0aGlzLnBsdWdpbiA9IHBsdWdpbjtcbiAgICAgICAgdGhpcy5yZWdpc3RlckNsZWFudXAoKTtcbiAgICB9XG4gICAgXG4gICAgLy8gT3BlbnMgdGhlIGNvbnRpbnVvdXMgam91cm5hbCB2aWV3IGluIGEgbmV3IGxlYWZcbiAgICBhc3luYyBvcGVuKCk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICAvLyBDcmVhdGUgYSBuZXcgbGVhZiAob3BlbnMgYSBuZXcgdGFiKVxuICAgICAgICBjb25zdCBsZWFmID0gdGhpcy5wbHVnaW4uYXBwLndvcmtzcGFjZS5nZXRMZWFmKHRydWUpO1xuICAgICAgICBcbiAgICAgICAgLy8gU2V0IHRoZSB2aWV3IHN0YXRlIHRvIE1hcmtkb3duIHRvIGFjY2VzcyBjb250YWluZXJFbFxuICAgICAgICBhd2FpdCBsZWFmLnNldFZpZXdTdGF0ZSh7XG4gICAgICAgICAgICB0eXBlOiBcIm1hcmtkb3duXCIsXG4gICAgICAgICAgICBhY3RpdmU6IHRydWUsXG4gICAgICAgIH0pO1xuICAgICAgICBcbiAgICAgICAgLy8gQ3JlYXRlIHRoZSBtYWluIGNvbnRhaW5lclxuICAgICAgICBjb25zdCBjb250ZW50RWwgPSBsZWFmLnZpZXcuY29udGFpbmVyRWw7XG4gICAgICAgIGNvbnRlbnRFbC5lbXB0eSgpO1xuICAgICAgICBcbiAgICAgICAgLy8gQ3JlYXRlIGEgc2Nyb2xsYWJsZSBwYW5lbCBmb3Igam91cm5hbCBlbnRyaWVzXG4gICAgICAgIGNvbnN0IHBhbmVsID0gY29udGVudEVsLmNyZWF0ZURpdih7IGNsczogJ2N1c3RvbS1qb3VybmFsLXBhbmVsJyB9KTtcbiAgICAgICAgXG4gICAgICAgIC8vIEdldCBhbGwgam91cm5hbCBmaWxlcywgcGFzc2luZyB0aGUgZm9sZGVyIGZvcm1hdFxuICAgICAgICBjb25zdCBqb3VybmFsRmlsZXMgPSBnZXRKb3VybmFsRmlsZXMoXG4gICAgICAgICAgICB0aGlzLnBsdWdpbi5hcHAsIFxuICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3Muam91cm5hbEZvbGRlcixcbiAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmZvbGRlckZvcm1hdFxuICAgICAgICApO1xuICAgICAgICBcbiAgICAgICAgaWYgKGpvdXJuYWxGaWxlcy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgIG5ldyBOb3RpY2UoJ05vIGpvdXJuYWwgZW50cmllcyBmb3VuZC4nKTtcbiAgICAgICAgICAgIHBhbmVsLmNyZWF0ZUVsKCdkaXYnLCB7IFxuICAgICAgICAgICAgICAgIGNsczogJ2pvdXJuYWwtZW1wdHktc3RhdGUnLFxuICAgICAgICAgICAgICAgIHRleHQ6ICdObyBqb3VybmFsIGVudHJpZXMgZm91bmQuIENyZWF0ZSBvbmUgYnkgY2xpY2tpbmcgdGhlIGpvdXJuYWxzIGljb24gaW4gdGhlIHJpYmJvbi4nIFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIFNvcnQgdGhlIGZpbGVzIGFjY29yZGluZyB0byB1c2VyIHByZWZlcmVuY2VcbiAgICAgICAgdGhpcy5hbGxGaWxlcyA9IHNvcnRKb3VybmFsRmlsZXMoam91cm5hbEZpbGVzLCB0aGlzLnBsdWdpbi5zZXR0aW5ncy5zb3J0RGlyZWN0aW9uKTtcbiAgICAgICAgXG4gICAgICAgIC8vIFJlc2V0IGJhdGNoIGNvdW50ZXJcbiAgICAgICAgdGhpcy5jdXJyZW50QmF0Y2ggPSAwO1xuICAgICAgICBcbiAgICAgICAgLy8gTG9hZCB0aGUgZmlyc3QgYmF0Y2ggb2YgZW50cmllc1xuICAgICAgICBhd2FpdCB0aGlzLmxvYWRCYXRjaChwYW5lbCk7XG4gICAgICAgIFxuICAgICAgICAvLyBBZGQgXCJMb2FkIE1vcmVcIiBidXR0b24gaWYgdGhlcmUgYXJlIG1vcmUgZW50cmllc1xuICAgICAgICBpZiAodGhpcy5jdXJyZW50QmF0Y2ggKiB0aGlzLmJhdGNoU2l6ZSA8IHRoaXMuYWxsRmlsZXMubGVuZ3RoKSB7XG4gICAgICAgICAgICB0aGlzLmFkZExvYWRNb3JlQnV0dG9uKHBhbmVsKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBcbiAgICAvLyBMb2FkIGEgYmF0Y2ggb2YgZW50cmllc1xuICAgIHByaXZhdGUgYXN5bmMgbG9hZEJhdGNoKHBhbmVsOiBIVE1MRWxlbWVudCk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBjb25zdCBzdGFydCA9IHRoaXMuY3VycmVudEJhdGNoICogdGhpcy5iYXRjaFNpemU7XG4gICAgICAgIGNvbnN0IGVuZCA9IE1hdGgubWluKHN0YXJ0ICsgdGhpcy5iYXRjaFNpemUsIHRoaXMuYWxsRmlsZXMubGVuZ3RoKTtcbiAgICAgICAgXG4gICAgICAgIC8vIEdldCB0aGUgZmlsZXMgZm9yIHRoaXMgYmF0Y2hcbiAgICAgICAgY29uc3QgZmlsZXNUb0xvYWQgPSB0aGlzLmFsbEZpbGVzLnNsaWNlKHN0YXJ0LCBlbmQpO1xuICAgICAgICBcbiAgICAgICAgLy8gTG9hZCBlYWNoIGZpbGUgYW5kIGFkZCBpdCB0byB0aGUgcGFuZWxcbiAgICAgICAgZm9yIChjb25zdCBmaWxlIG9mIGZpbGVzVG9Mb2FkKSB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGZpbGVDb250ZW50ID0gYXdhaXQgdGhpcy5wbHVnaW4uYXBwLnZhdWx0LnJlYWQoZmlsZSk7XG4gICAgICAgICAgICAgICAgdGhpcy5hZGRKb3VybmFsRW50cnkocGFuZWwsIGZpbGUsIGZpbGVDb250ZW50KTtcbiAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihgRXJyb3IgcmVhZGluZyBmaWxlICR7ZmlsZS5wYXRofTpgLCBlcnJvcik7XG4gICAgICAgICAgICAgICAgdGhpcy5hZGRFcnJvck1lc3NhZ2UocGFuZWwsIGZpbGUuYmFzZW5hbWUsIGVycm9yKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgLy8gSW5jcmVtZW50IHRoZSBiYXRjaCBjb3VudGVyXG4gICAgICAgIHRoaXMuY3VycmVudEJhdGNoKys7XG4gICAgfVxuICAgIFxuICAgIC8vIEFkZCBhIFwiTG9hZCBNb3JlXCIgYnV0dG9uXG4gICAgcHJpdmF0ZSBhZGRMb2FkTW9yZUJ1dHRvbihwYW5lbDogSFRNTEVsZW1lbnQpOiB2b2lkIHtcbiAgICAgICAgLy8gUmVtb3ZlIGV4aXN0aW5nIGJ1dHRvbiBpZiBwcmVzZW50XG4gICAgICAgIGlmICh0aGlzLmxvYWRNb3JlQnV0dG9uKSB7XG4gICAgICAgICAgICB0aGlzLmxvYWRNb3JlQnV0dG9uLnJlbW92ZSgpO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyBDcmVhdGUgbmV3IGJ1dHRvblxuICAgICAgICB0aGlzLmxvYWRNb3JlQnV0dG9uID0gcGFuZWwuY3JlYXRlRWwoJ2J1dHRvbicsIHtcbiAgICAgICAgICAgIGNsczogJ2pvdXJuYWwtbG9hZC1tb3JlLWJ1dHRvbicsXG4gICAgICAgICAgICB0ZXh0OiAnTG9hZCBNb3JlIEVudHJpZXMnXG4gICAgICAgIH0pO1xuICAgICAgICBcbiAgICAgICAgLy8gU2luY2Ugd2UganVzdCBjcmVhdGVkIHRoZSBidXR0b24sIHdlIGtub3cgaXQncyBub3QgbnVsbCBub3dcbiAgICAgICAgY29uc3QgYnV0dG9uID0gdGhpcy5sb2FkTW9yZUJ1dHRvbjsgLy8gQ3JlYXRlIGEgbm9uLW51bGwgcmVmZXJlbmNlXG4gICAgICAgIFxuICAgICAgICBidXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICAvLyBTaG93IGxvYWRpbmcgc3RhdGVcbiAgICAgICAgICAgIGJ1dHRvbi50ZXh0Q29udGVudCA9ICdMb2FkaW5nLi4uJztcbiAgICAgICAgICAgIGJ1dHRvbi5zZXRBdHRyKCdkaXNhYmxlZCcsICd0cnVlJyk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIExvYWQgdGhlIG5leHQgYmF0Y2hcbiAgICAgICAgICAgIGF3YWl0IHRoaXMubG9hZEJhdGNoKHBhbmVsKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gVXBkYXRlIG9yIHJlbW92ZSB0aGUgYnV0dG9uXG4gICAgICAgICAgICBpZiAodGhpcy5jdXJyZW50QmF0Y2ggKiB0aGlzLmJhdGNoU2l6ZSA8IHRoaXMuYWxsRmlsZXMubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgYnV0dG9uLnRleHRDb250ZW50ID0gJ0xvYWQgTW9yZSBFbnRyaWVzJztcbiAgICAgICAgICAgICAgICBidXR0b24ucmVtb3ZlQXR0cmlidXRlKCdkaXNhYmxlZCcpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBidXR0b24ucmVtb3ZlKCk7XG4gICAgICAgICAgICAgICAgdGhpcy5sb2FkTW9yZUJ1dHRvbiA9IG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBcbiAgICAvLyBBZGRzIGFuIGVycm9yIG1lc3NhZ2UgdG8gdGhlIHBhbmVsIHdoZW4gZmlsZSByZWFkaW5nIGZhaWxzXG4gICAgcHJpdmF0ZSBhZGRFcnJvck1lc3NhZ2UocGFuZWw6IEhUTUxFbGVtZW50LCBmaWxlbmFtZTogc3RyaW5nLCBlcnJvcjogYW55KTogdm9pZCB7XG4gICAgICAgIGNvbnN0IGVycm9yRGl2ID0gcGFuZWwuY3JlYXRlRGl2KHsgY2xzOiAnam91cm5hbC1lbnRyeSBqb3VybmFsLWVycm9yJyB9KTtcbiAgICAgICAgXG4gICAgICAgIGNvbnN0IGVycm9ySGVhZGVyID0gZXJyb3JEaXYuY3JlYXRlRGl2KHsgY2xzOiAnam91cm5hbC1lbnRyeS1oZWFkZXInIH0pO1xuICAgICAgICBlcnJvckhlYWRlci5jcmVhdGVFbCgnaDMnLCB7IFxuICAgICAgICAgICAgY2xzOiAnam91cm5hbC1lbnRyeS10aXRsZScsXG4gICAgICAgICAgICB0ZXh0OiBgJHtmaWxlbmFtZX0gLSBFcnJvcmAgXG4gICAgICAgIH0pO1xuICAgICAgICBcbiAgICAgICAgY29uc3QgZXJyb3JDb250ZW50ID0gZXJyb3JEaXYuY3JlYXRlRGl2KHsgY2xzOiAnam91cm5hbC1lcnJvci1jb250ZW50JyB9KTtcbiAgICAgICAgZXJyb3JDb250ZW50LnRleHRDb250ZW50ID0gYEZhaWxlZCB0byBsb2FkIGpvdXJuYWw6ICR7ZXJyb3IubWVzc2FnZSB8fCBlcnJvcn1gO1xuICAgIH1cbiAgICBcbiAgICAvLyBBZGRzIGEgam91cm5hbCBlbnRyeSB0byB0aGUgcGFuZWxcbiAgICBwcml2YXRlIGFkZEpvdXJuYWxFbnRyeShwYW5lbDogSFRNTEVsZW1lbnQsIGZpbGU6IFRGaWxlLCBjb250ZW50OiBzdHJpbmcpOiB2b2lkIHtcbiAgICAgICAgY29uc3Qgam91cm5hbERhdGUgPSBmaWxlLmJhc2VuYW1lO1xuICAgICAgICBcbiAgICAgICAgLy8gQ3JlYXRlIHRoZSBtYWluIGNvbnRhaW5lciBmb3IgdGhpcyBlbnRyeVxuICAgICAgICBjb25zdCBqb3VybmFsRW50cnkgPSBwYW5lbC5jcmVhdGVEaXYoeyBjbHM6ICdqb3VybmFsLWVudHJ5JyB9KTtcbiAgICAgICAgXG4gICAgICAgIC8vIENyZWF0ZSB0aGUgaGVhZGVyIHNlY3Rpb25cbiAgICAgICAgY29uc3QgaGVhZGVyID0gam91cm5hbEVudHJ5LmNyZWF0ZURpdih7IGNsczogJ2pvdXJuYWwtZW50cnktaGVhZGVyJyB9KTtcbiAgICAgICAgXG4gICAgICAgIC8vIEFkZCB0b2dnbGUgYnV0dG9uIGZvciBjb2xsYXBzaW5nL2V4cGFuZGluZ1xuICAgICAgICBjb25zdCB0b2dnbGVCdXR0b24gPSBoZWFkZXIuY3JlYXRlRWwoJ2J1dHRvbicsIHsgY2xzOiAnY29sbGFwc2libGUtdG9nZ2xlJyB9KTtcbiAgICAgICAgaWYgKHRoaXMucGx1Z2luLnNldHRpbmdzLmRlZmF1bHRFeHBhbmRFbnRyaWVzKSB7XG4gICAgICAgICAgICB0b2dnbGVCdXR0b24uYWRkQ2xhc3MoJ3RvZ2dsZS1leHBhbmRlZCcpO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyBBZGQgdGl0bGUgd2l0aCBsaW5rIHRvIHRoZSBvcmlnaW5hbCBmaWxlXG4gICAgICAgIGNvbnN0IHRpdGxlID0gaGVhZGVyLmNyZWF0ZUVsKCdoMycsIHsgY2xzOiAnam91cm5hbC1lbnRyeS10aXRsZScgfSk7XG4gICAgICAgIGNvbnN0IHRpdGxlTGluayA9IHRpdGxlLmNyZWF0ZUVsKCdhJywgeyBcbiAgICAgICAgICAgIGNsczogJ2pvdXJuYWwtZW50cnktbGluaycsXG4gICAgICAgICAgICB0ZXh0OiBmb3JtYXREYXRlRm9yRGlzcGxheShqb3VybmFsRGF0ZSlcbiAgICAgICAgfSk7XG4gICAgICAgIFxuICAgICAgICAvLyBIYW5kbGUgY2xpY2sgb24gdGhlIHRpdGxlIHRvIG9wZW4gdGhlIGZpbGVcbiAgICAgICAgdGl0bGVMaW5rLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGV2ZW50KSA9PiB7XG4gICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgdGhpcy5wbHVnaW4uYXBwLndvcmtzcGFjZS5vcGVuTGlua1RleHQoZmlsZS5iYXNlbmFtZSwgZmlsZS5wYXRoKTtcbiAgICAgICAgfSk7XG4gICAgICAgIFxuICAgICAgICAvLyBDcmVhdGUgdGhlIGNvbnRlbnQgYXJlYVxuICAgICAgICBjb25zdCBjb250ZW50QXJlYSA9IGpvdXJuYWxFbnRyeS5jcmVhdGVEaXYoeyBcbiAgICAgICAgICAgIGNsczogJ2NvbGxhcHNpYmxlLWNvbnRlbnQnICsgKHRoaXMucGx1Z2luLnNldHRpbmdzLmRlZmF1bHRFeHBhbmRFbnRyaWVzID8gJyBjb250ZW50LWV4cGFuZGVkJyA6ICcnKVxuICAgICAgICB9KTtcbiAgICAgICAgXG4gICAgICAgIC8vIFRyYWNrIHRoZSBjdXJyZW50IGNvbnRlbnRcbiAgICAgICAgbGV0IGN1cnJlbnRDb250ZW50ID0gY29udGVudDtcbiAgICAgICAgXG4gICAgICAgIC8vIEZsYWcgdG8gdHJhY2sgaWYgdGhlIGVudHJ5IGlzIGluIGVkaXQgbW9kZVxuICAgICAgICBsZXQgaXNFZGl0aW5nID0gZmFsc2U7XG4gICAgICAgIFxuICAgICAgICAvLyBDcmVhdGUgdGhlIHJlbmRlcmVkIGNvbnRlbnQgdmlld1xuICAgICAgICBjb25zdCByZW5kZXJlZENvbnRlbnQgPSBjb250ZW50QXJlYS5jcmVhdGVEaXYoeyBcbiAgICAgICAgICAgIGNsczogJ3JlbmRlcmVkLWNvbnRlbnQgYWN0aXZlLXZpZXcnIFxuICAgICAgICB9KTtcbiAgICAgICAgXG4gICAgICAgIC8vIENyZWF0ZSB0aGUgZWRpdGFibGUgdGV4dGFyZWFcbiAgICAgICAgY29uc3QgZWRpdGFibGVDb250ZW50ID0gY29udGVudEFyZWEuY3JlYXRlRWwoJ3RleHRhcmVhJywgeyBcbiAgICAgICAgICAgIGNsczogJ2VkaXRhYmxlLWNvbnRlbnQnLFxuICAgICAgICAgICAgdmFsdWU6IGN1cnJlbnRDb250ZW50XG4gICAgICAgIH0pO1xuICAgICAgICBcbiAgICAgICAgLy8gQ3JlYXRlIGNsb3NlIGJ1dHRvbiAobmV3IHJlcXVpcmVtZW50KVxuICAgICAgICBjb25zdCBjbG9zZUJ1dHRvbiA9IGNvbnRlbnRBcmVhLmNyZWF0ZUVsKCdidXR0b24nLCB7XG4gICAgICAgICAgICBjbHM6ICdqb3VybmFsLWNsb3NlLWJ1dHRvbicsXG4gICAgICAgICAgICB0ZXh0OiAnQ2xvc2UnXG4gICAgICAgIH0pO1xuICAgICAgICBjbG9zZUJ1dHRvbi5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOyAvLyBIaWRlIGluaXRpYWxseVxuICAgICAgICBcbiAgICAgICAgLy8gQ3JlYXRlIHNhdmUgaW5kaWNhdG9yXG4gICAgICAgIGNvbnN0IHNhdmVJbmRpY2F0b3IgPSBjb250ZW50QXJlYS5jcmVhdGVEaXYoeyBcbiAgICAgICAgICAgIGNsczogJ2pvdXJuYWwtc2F2ZS1pbmRpY2F0b3InLFxuICAgICAgICAgICAgdGV4dDogJ1NhdmVkJ1xuICAgICAgICB9KTtcbiAgICAgICAgc2F2ZUluZGljYXRvci5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOyAvLyBIaWRlIGluaXRpYWxseVxuICAgICAgICBcbiAgICAgICAgLy8gQWRqdXN0IHRleHRhcmVhIGhlaWdodCB0byBjb250ZW50XG4gICAgICAgIHdpbmRvdy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUoKCkgPT4ge1xuICAgICAgICAgICAgZWRpdGFibGVDb250ZW50LnN0eWxlLmhlaWdodCA9IGVkaXRhYmxlQ29udGVudC5zY3JvbGxIZWlnaHQgKyAncHgnO1xuICAgICAgICB9KTtcbiAgICAgICAgXG4gICAgICAgIC8vIEZ1bmN0aW9uIHRvIHJlbmRlciB0aGUgbWFya2Rvd24gY29udGVudFxuICAgICAgICBjb25zdCByZW5kZXJDb250ZW50ID0gKCkgPT4ge1xuICAgICAgICAgICAgcmVuZGVyZWRDb250ZW50LmVtcHR5KCk7XG4gICAgICAgICAgICBNYXJrZG93blJlbmRlcmVyLnJlbmRlcih0aGlzLnBsdWdpbi5hcHAsIGN1cnJlbnRDb250ZW50LCByZW5kZXJlZENvbnRlbnQsIGZpbGUucGF0aCwgdGhpcy5wbHVnaW4pO1xuICAgICAgICB9O1xuICAgICAgICBcbiAgICAgICAgLy8gSW5pdGlhbCByZW5kZXJcbiAgICAgICAgcmVuZGVyQ29udGVudCgpO1xuICAgICAgICBcbiAgICAgICAgLy8gRnVuY3Rpb24gdG8gZW50ZXIgZWRpdCBtb2RlXG4gICAgICAgIGNvbnN0IGVudGVyRWRpdE1vZGUgPSAoKSA9PiB7XG4gICAgICAgICAgICAvLyBTZXQgZWRpdGluZyBmbGFnXG4gICAgICAgICAgICBpc0VkaXRpbmcgPSB0cnVlO1xuICAgICAgICAgICAgdGhpcy5hY3RpdmVFZGl0b3IgPSBlZGl0YWJsZUNvbnRlbnQ7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIE1ha2Ugc3VyZSB0ZXh0YXJlYSBoYXMgY3VycmVudCBjb250ZW50XG4gICAgICAgICAgICBlZGl0YWJsZUNvbnRlbnQudmFsdWUgPSBjdXJyZW50Q29udGVudDtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gSGlkZSByZW5kZXJlZCB2aWV3LCBzaG93IGVkaXRhYmxlIHZpZXcgYW5kIGNsb3NlIGJ1dHRvblxuICAgICAgICAgICAgcmVuZGVyZWRDb250ZW50LmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZS12aWV3Jyk7XG4gICAgICAgICAgICBlZGl0YWJsZUNvbnRlbnQuY2xhc3NMaXN0LmFkZCgnYWN0aXZlLXZpZXcnKTtcbiAgICAgICAgICAgIGNsb3NlQnV0dG9uLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBBZGp1c3QgdGV4dGFyZWEgaGVpZ2h0XG4gICAgICAgICAgICBlZGl0YWJsZUNvbnRlbnQuc3R5bGUuaGVpZ2h0ID0gJ2F1dG8nO1xuICAgICAgICAgICAgZWRpdGFibGVDb250ZW50LnN0eWxlLmhlaWdodCA9IGVkaXRhYmxlQ29udGVudC5zY3JvbGxIZWlnaHQgKyAncHgnO1xuICAgICAgICAgICAgZWRpdGFibGVDb250ZW50LmZvY3VzKCk7XG4gICAgICAgIH07XG4gICAgICAgIFxuICAgICAgICAvLyBGdW5jdGlvbiB0byBleGl0IGVkaXQgbW9kZVxuICAgICAgICBjb25zdCBleGl0RWRpdE1vZGUgPSBhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICAvLyBFbnN1cmUgY29udGVudCBpcyBzYXZlZCBiZWZvcmUgZXhpdGluZ1xuICAgICAgICAgICAgaWYgKGlzRWRpdGluZykge1xuICAgICAgICAgICAgICAgIC8vIEdldCBjdXJyZW50IGNvbnRlbnQgZnJvbSB0ZXh0YXJlYVxuICAgICAgICAgICAgICAgIGN1cnJlbnRDb250ZW50ID0gZWRpdGFibGVDb250ZW50LnZhbHVlO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIC8vIFNhdmUgY2hhbmdlc1xuICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMuc2F2ZUNvbnRlbnRUb0ZpbGUoZmlsZSwgY3VycmVudENvbnRlbnQpO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIC8vIFJlLXJlbmRlciBjb250ZW50XG4gICAgICAgICAgICAgICAgcmVuZGVyQ29udGVudCgpO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIC8vIEhpZGUgZWRpdGFibGUgdmlldyBhbmQgY2xvc2UgYnV0dG9uLCBzaG93IHJlbmRlcmVkIHZpZXdcbiAgICAgICAgICAgICAgICBlZGl0YWJsZUNvbnRlbnQuY2xhc3NMaXN0LnJlbW92ZSgnYWN0aXZlLXZpZXcnKTtcbiAgICAgICAgICAgICAgICBjbG9zZUJ1dHRvbi5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICAgICAgICAgICAgICAgIHJlbmRlcmVkQ29udGVudC5jbGFzc0xpc3QuYWRkKCdhY3RpdmUtdmlldycpO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIC8vIENsZWFyIGVkaXRpbmcgZmxhZyBhbmQgYWN0aXZlIGVkaXRvciByZWZlcmVuY2VcbiAgICAgICAgICAgICAgICBpc0VkaXRpbmcgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5hY3RpdmVFZGl0b3IgPT09IGVkaXRhYmxlQ29udGVudCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmFjdGl2ZUVkaXRvciA9IG51bGw7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuXG4gICAgICAgIC8vIENsaWNrIG9uIHJlbmRlcmVkIGNvbnRlbnQgdG8gZWRpdFxuICAgICAgICByZW5kZXJlZENvbnRlbnQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZXZlbnQpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHRhcmdldCA9IGV2ZW50LnRhcmdldCBhcyBIVE1MRWxlbWVudDtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gRG9uJ3QgZW50ZXIgZWRpdCBtb2RlIGlmIGNsaWNraW5nIG9uIGxpbmtzIG9yIGhhc2h0YWdzXG4gICAgICAgICAgICBpZiAodGFyZ2V0LnRhZ05hbWUgPT09ICdBJyB8fCB0YXJnZXQuY2xvc2VzdCgnYScpIHx8IFxuICAgICAgICAgICAgICAgIHRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ2NtLWhhc2h0YWcnKSB8fCB0YXJnZXQuY2xvc2VzdCgnLmNtLWhhc2h0YWcnKSkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgZW50ZXJFZGl0TW9kZSgpO1xuICAgICAgICB9KTtcbiAgICAgICAgXG4gICAgICAgIC8vIENsb3NlIGJ1dHRvbiB0byBleGl0IGVkaXQgbW9kZVxuICAgICAgICBjbG9zZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICAgICAgICAgIGV4aXRFZGl0TW9kZSgpO1xuICAgICAgICB9KTtcbiAgICAgICAgXG4gICAgICAgIC8vIE1hbnVhbCBzYXZlL2V4aXQgd2hlbiBwcmVzc2luZyBFc2NhcGVcbiAgICAgICAgZWRpdGFibGVDb250ZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCAoZXZlbnQpID0+IHtcbiAgICAgICAgICAgIGlmIChldmVudC5rZXkgPT09ICdFc2NhcGUnKSB7XG4gICAgICAgICAgICAgICAgZXhpdEVkaXRNb2RlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICBcbiAgICAgICAgLy8gQXV0by1hZGp1c3QgdGV4dGFyZWEgaGVpZ2h0IHdoaWxlIHR5cGluZ1xuICAgICAgICBlZGl0YWJsZUNvbnRlbnQuYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCAoKSA9PiB7XG4gICAgICAgICAgICBlZGl0YWJsZUNvbnRlbnQuc3R5bGUuaGVpZ2h0ID0gJ2F1dG8nO1xuICAgICAgICAgICAgZWRpdGFibGVDb250ZW50LnN0eWxlLmhlaWdodCA9IGVkaXRhYmxlQ29udGVudC5zY3JvbGxIZWlnaHQgKyAncHgnO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBVcGRhdGUgY3VycmVudCBjb250ZW50IHdoaWxlIHR5cGluZ1xuICAgICAgICAgICAgY3VycmVudENvbnRlbnQgPSBlZGl0YWJsZUNvbnRlbnQudmFsdWU7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIEF1dG8tc2F2ZSBjb250ZW50IHdoaWxlIHR5cGluZ1xuICAgICAgICBsZXQgc2F2ZVRpbWVvdXQ6IE5vZGVKUy5UaW1lb3V0IHwgbnVsbCA9IG51bGw7XG4gICAgICAgIGVkaXRhYmxlQ29udGVudC5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsICgpID0+IHtcbiAgICAgICAgICAgIC8vIFNob3cgJ1NhdmluZy4uLicgaW5kaWNhdG9yXG4gICAgICAgICAgICBzYXZlSW5kaWNhdG9yLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snO1xuICAgICAgICAgICAgc2F2ZUluZGljYXRvci5jbGFzc0xpc3QucmVtb3ZlKCdzYXZlZCcpO1xuICAgICAgICAgICAgc2F2ZUluZGljYXRvci5jbGFzc0xpc3QuYWRkKCdzYXZpbmcnKTtcbiAgICAgICAgICAgIHNhdmVJbmRpY2F0b3IudGV4dENvbnRlbnQgPSAnU2F2aW5nLi4uJztcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gQ2xlYXIgcHJldmlvdXMgdGltZW91dFxuICAgICAgICAgICAgaWYgKHNhdmVUaW1lb3V0KSB7XG4gICAgICAgICAgICAgICAgY2xlYXJUaW1lb3V0KHNhdmVUaW1lb3V0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gU2V0IGEgbmV3IHRpbWVvdXQgdG8gc2F2ZSBhZnRlciA1MDBtcyBvZiBpbmFjdGl2aXR5XG4gICAgICAgICAgICBzYXZlVGltZW91dCA9IHNldFRpbWVvdXQoYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMuc2F2ZUNvbnRlbnRUb0ZpbGUoZmlsZSwgY3VycmVudENvbnRlbnQpO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIC8vIFVwZGF0ZSBpbmRpY2F0b3IgdG8gJ1NhdmVkJ1xuICAgICAgICAgICAgICAgIHNhdmVJbmRpY2F0b3IuY2xhc3NMaXN0LnJlbW92ZSgnc2F2aW5nJyk7XG4gICAgICAgICAgICAgICAgc2F2ZUluZGljYXRvci5jbGFzc0xpc3QuYWRkKCdzYXZlZCcpO1xuICAgICAgICAgICAgICAgIHNhdmVJbmRpY2F0b3IudGV4dENvbnRlbnQgPSAnU2F2ZWQnO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIC8vIEhpZGUgdGhlIGluZGljYXRvciBhZnRlciBhIGRlbGF5XG4gICAgICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzYXZlSW5kaWNhdG9yLmNsYXNzTGlzdC5jb250YWlucygnc2F2ZWQnKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2F2ZUluZGljYXRvci5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSwgMjAwMCk7XG4gICAgICAgICAgICB9LCA1MDApO1xuICAgICAgICB9KTtcbiAgICAgICAgXG4gICAgICAgIC8vIFRvZ2dsZSBleHBhbmQvY29sbGFwc2Ugb24gYnV0dG9uIGNsaWNrXG4gICAgICAgIHRvZ2dsZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICAgICAgICAgIHRvZ2dsZUJ1dHRvbi5jbGFzc0xpc3QudG9nZ2xlKCd0b2dnbGUtZXhwYW5kZWQnKTtcbiAgICAgICAgICAgIGNvbnRlbnRBcmVhLmNsYXNzTGlzdC50b2dnbGUoJ2NvbnRlbnQtZXhwYW5kZWQnKTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIFxuICAgIC8qKlxuICAgICAqIFNhdmVzIHRoZSBjb250ZW50IHRvIHRoZSBmaWxlXG4gICAgICovXG4gICAgcHJpdmF0ZSBhc3luYyBzYXZlQ29udGVudFRvRmlsZShmaWxlOiBURmlsZSwgY29udGVudDogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5hcHAudmF1bHQubW9kaWZ5KGZpbGUsIGNvbnRlbnQpO1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgbmV3IE5vdGljZShgRmFpbGVkIHRvIHNhdmUgY2hhbmdlczogJHtlcnJvcn1gKTtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0ZhaWxlZCB0byBzYXZlIGNoYW5nZXM6JywgZXJyb3IpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogSW5zZXJ0cyBhIHJlZmVyZW5jZSB0byBhIGZpbGUgaW50byB0aGUgYWN0aXZlIGpvdXJuYWwgZW50cnlcbiAgICAgKi9cbiAgICBpbnNlcnRGaWxlUmVmZXJlbmNlKGZpbGVQYXRoOiBzdHJpbmcpOiB2b2lkIHtcbiAgICAgICAgLy8gRmluZCB0aGUgYWN0aXZlIGVkaXRvclxuICAgICAgICBpZiAoIXRoaXMuYWN0aXZlRWRpdG9yKSB7XG4gICAgICAgICAgICBuZXcgTm90aWNlKCdObyBhY3RpdmUgam91cm5hbCBlbnRyeSB0byBpbnNlcnQgZmlsZSBpbnRvJyk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICBcbiAgICAgICAgLy8gR2V0IHRoZSBmaWxlXG4gICAgICAgIGNvbnN0IGZpbGUgPSB0aGlzLnBsdWdpbi5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKGZpbGVQYXRoKTtcbiAgICAgICAgaWYgKCEoZmlsZSBpbnN0YW5jZW9mIFRGaWxlKSkge1xuICAgICAgICAgICAgbmV3IE5vdGljZSgnSW52YWxpZCBmaWxlJyk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICBcbiAgICAgICAgLy8gQ3JlYXRlIHRoZSBhcHByb3ByaWF0ZSBmaWxlIHJlZmVyZW5jZVxuICAgICAgICBsZXQgZmlsZVJlZmVyZW5jZTogc3RyaW5nO1xuICAgICAgICBcbiAgICAgICAgLy8gSGFuZGxlIGRpZmZlcmVudCBmaWxlIHR5cGVzXG4gICAgICAgIGlmICh0aGlzLmlzSW1hZ2VGaWxlKGZpbGUpKSB7XG4gICAgICAgICAgICBmaWxlUmVmZXJlbmNlID0gYCFbWyR7ZmlsZS5uYW1lfV1dYDtcbiAgICAgICAgfSBlbHNlIGlmICh0aGlzLmlzTWFya2Rvd25GaWxlKGZpbGUpKSB7XG4gICAgICAgICAgICBmaWxlUmVmZXJlbmNlID0gYCFbWyR7ZmlsZS5uYW1lfV1dYDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGZpbGVSZWZlcmVuY2UgPSBgIVtbJHtmaWxlLm5hbWV9XV1gO1xuICAgICAgICB9XG4gICAgXG4gICAgICAgIC8vIEZvY3VzIHRoZSBhY3RpdmUgZWRpdG9yXG4gICAgICAgIHRoaXMuYWN0aXZlRWRpdG9yLmZvY3VzKCk7XG4gICAgXG4gICAgICAgIC8vIEdldCBjdXJzb3IgcG9zaXRpb25cbiAgICAgICAgY29uc3QgY3Vyc29yUG9zID0gdGhpcy5hY3RpdmVFZGl0b3Iuc2VsZWN0aW9uU3RhcnQ7XG4gICAgICAgIGNvbnN0IHRleHRCZWZvcmUgPSB0aGlzLmFjdGl2ZUVkaXRvci52YWx1ZS5zdWJzdHJpbmcoMCwgY3Vyc29yUG9zKTtcbiAgICAgICAgY29uc3QgdGV4dEFmdGVyID0gdGhpcy5hY3RpdmVFZGl0b3IudmFsdWUuc3Vic3RyaW5nKHRoaXMuYWN0aXZlRWRpdG9yLnNlbGVjdGlvbkVuZCk7XG4gICAgXG4gICAgICAgIC8vIEluc2VydCB0ZXh0IHdpdGggbmV3bGluZXNcbiAgICAgICAgY29uc3QgbmV3VGV4dCA9IHRleHRCZWZvcmUgKyAnXFxuXFxuJyArIGZpbGVSZWZlcmVuY2UgKyAnXFxuXFxuJyArIHRleHRBZnRlcjtcbiAgICAgICAgdGhpcy5hY3RpdmVFZGl0b3IudmFsdWUgPSBuZXdUZXh0O1xuICAgIFxuICAgICAgICAvLyBTZXQgY3Vyc29yIHBvc2l0aW9uIGFmdGVyIHRoZSBpbnNlcnRlZCB0ZXh0XG4gICAgICAgIGNvbnN0IG5ld0N1cnNvclBvcyA9IGN1cnNvclBvcyArIGZpbGVSZWZlcmVuY2UubGVuZ3RoICsgNDsgLy8gKzQgZm9yIHRoZSBuZXdsaW5lc1xuICAgICAgICB0aGlzLmFjdGl2ZUVkaXRvci5zZXRTZWxlY3Rpb25SYW5nZShuZXdDdXJzb3JQb3MsIG5ld0N1cnNvclBvcyk7XG4gICAgXG4gICAgICAgIC8vIFRyaWdnZXIgaW5wdXQgZXZlbnQgdG8gZW5zdXJlIGNvbnRlbnQgaXMgc2F2ZWRcbiAgICAgICAgY29uc3QgaW5wdXRFdmVudCA9IG5ldyBFdmVudCgnaW5wdXQnLCB7IGJ1YmJsZXM6IHRydWUsIGNhbmNlbGFibGU6IHRydWUgfSk7XG4gICAgICAgIHRoaXMuYWN0aXZlRWRpdG9yLmRpc3BhdGNoRXZlbnQoaW5wdXRFdmVudCk7XG4gICAgXG4gICAgICAgIG5ldyBOb3RpY2UoYEluc2VydGVkIHJlZmVyZW5jZSB0byAke2ZpbGUubmFtZX1gKTtcbiAgICB9XG4gICAgXG4gICAgLyoqXG4gICAgICogQ2hlY2sgaWYgYSBmaWxlIGlzIGFuIGltYWdlXG4gICAgICovXG4gICAgcHJpdmF0ZSBpc0ltYWdlRmlsZShmaWxlOiBURmlsZSk6IGJvb2xlYW4ge1xuICAgICAgICBjb25zdCBpbWFnZUV4dGVuc2lvbnMgPSBbJ3BuZycsICdqcGcnLCAnanBlZycsICdnaWYnLCAnc3ZnJywgJ3dlYnAnXTtcbiAgICAgICAgY29uc3QgZXh0ID0gZmlsZS5leHRlbnNpb24udG9Mb3dlckNhc2UoKTtcbiAgICAgICAgcmV0dXJuIGltYWdlRXh0ZW5zaW9ucy5pbmNsdWRlcyhleHQpO1xuICAgIH1cbiAgICBcbiAgICAvKipcbiAgICAgKiBDaGVjayBpZiBhIGZpbGUgaXMgYSBtYXJrZG93biBmaWxlXG4gICAgICovXG4gICAgcHJpdmF0ZSBpc01hcmtkb3duRmlsZShmaWxlOiBURmlsZSk6IGJvb2xlYW4ge1xuICAgICAgICBjb25zdCBleHQgPSBmaWxlLmV4dGVuc2lvbi50b0xvd2VyQ2FzZSgpO1xuICAgICAgICByZXR1cm4gZXh0ID09PSAnbWQnIHx8IGV4dCA9PT0gJ21hcmtkb3duJztcbiAgICB9XG5cbiAgICBwcml2YXRlIHJlZ2lzdGVyQ2xlYW51cCgpOiB2b2lkIHtcbiAgICAgICAgLy8gV2F0Y2ggZm9yIHdvcmtzcGFjZSBsYXlvdXQgY2hhbmdlcyAod2hpY2ggaGFwcGVuIHdoZW4gY2hhbmdpbmcgcGFnZXMvdGFicylcbiAgICAgICAgdGhpcy5wbHVnaW4ucmVnaXN0ZXJFdmVudChcbiAgICAgICAgICAgIHRoaXMucGx1Z2luLmFwcC53b3Jrc3BhY2Uub24oJ2xheW91dC1jaGFuZ2UnLCAoKSA9PiB7XG4gICAgICAgICAgICAgICAgLy8gQ2hlY2sgaWYgd2UgaGF2ZSBhbiBhY3RpdmUgZWRpdG9yXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuYWN0aXZlRWRpdG9yKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIEZpbmQgdGhlIGpvdXJuYWwgZW50cnkgY29udGFpbmluZyB0aGlzIGVkaXRvclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBqb3VybmFsRW50cnkgPSB0aGlzLmFjdGl2ZUVkaXRvci5jbG9zZXN0KCcuam91cm5hbC1lbnRyeScpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoam91cm5hbEVudHJ5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBUcmlnZ2VyIHRoZSBleGl0IGVkaXQgbW9kZSBmdW5jdGlvbiBmb3IgdGhpcyBlbnRyeVxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZXZlbnQgPSBuZXcgS2V5Ym9hcmRFdmVudCgna2V5ZG93bicsIHsga2V5OiAnRXNjYXBlJyB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYWN0aXZlRWRpdG9yLmRpc3BhdGNoRXZlbnQoZXZlbnQpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAvLyBDbGVhciB0aGUgYWN0aXZlIGVkaXRvciByZWZlcmVuY2VcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5hY3RpdmVFZGl0b3IgPSBudWxsO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pXG4gICAgICAgICk7XG4gICAgfVxufSIsICIvLyBGb3JtYXRzIHRoZSBjdXJyZW50IGRhdGUgaW4gWVlZWS1NTS1ERCBmb3JtYXRcbmV4cG9ydCBmdW5jdGlvbiBnZXRUb2RheURhdGUoKTogc3RyaW5nIHtcbiAgICBjb25zdCB0b2RheSA9IG5ldyBEYXRlKCk7XG4gICAgcmV0dXJuIGZvcm1hdERhdGVTdHJpbmcodG9kYXkpO1xufVxuXG4vLyBGb3JtYXRzIGEgZGF0ZSBhcyBZWVlZLU1NLUREXG5leHBvcnQgZnVuY3Rpb24gZm9ybWF0RGF0ZVN0cmluZyhkYXRlOiBEYXRlKTogc3RyaW5nIHtcbiAgICBjb25zdCB5ZWFyID0gZGF0ZS5nZXRGdWxsWWVhcigpO1xuICAgIGNvbnN0IG1vbnRoID0gU3RyaW5nKGRhdGUuZ2V0TW9udGgoKSArIDEpLnBhZFN0YXJ0KDIsICcwJyk7XG4gICAgY29uc3QgZGF5ID0gU3RyaW5nKGRhdGUuZ2V0RGF0ZSgpKS5wYWRTdGFydCgyLCAnMCcpO1xuICAgIHJldHVybiBgJHt5ZWFyfS0ke21vbnRofS0ke2RheX1gO1xufVxuXG4vLyBGb3JtYXRzIGEgZGF0ZSBzdHJpbmcgaW4gYSBodW1hbi1yZWFkYWJsZSBmb3JtYXQgd2l0aCBvcmRpbmFsIHN1ZmZpeFxuZXhwb3J0IGZ1bmN0aW9uIGZvcm1hdERhdGVGb3JEaXNwbGF5KGRhdGVTdHJpbmc6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgY29uc3QgZGF0ZSA9IG5ldyBEYXRlKGRhdGVTdHJpbmcpO1xuICAgIGNvbnN0IGRhdGVGb3JtYXRPcHRpb25zOiBJbnRsLkRhdGVUaW1lRm9ybWF0T3B0aW9ucyA9IHsgXG4gICAgICAgIG1vbnRoOiAnc2hvcnQnLCBcbiAgICAgICAgeWVhcjogJ251bWVyaWMnLCBcbiAgICAgICAgZGF5OiAnbnVtZXJpYycgXG4gICAgfTtcblxuICAgIC8vIEZvcm1hdCBkYXRlIHVzaW5nIEludGwuRGF0ZVRpbWVGb3JtYXRcbiAgICBjb25zdCBmb3JtYXR0ZWREYXRlID0gbmV3IEludGwuRGF0ZVRpbWVGb3JtYXQoJ2VuLVVTJywgZGF0ZUZvcm1hdE9wdGlvbnMpLmZvcm1hdChkYXRlKTtcblxuICAgIC8vIEV4dHJhY3QgZGF5IGFuZCBhZGQgb3JkaW5hbCBzdWZmaXggKGUuZy4sICdzdCcsICduZCcsICdyZCcsICd0aCcpXG4gICAgY29uc3QgZGF5ID0gZGF0ZS5nZXREYXRlKCk7XG4gICAgY29uc3QgZGF5U3VmZml4ID0gZ2V0RGF5U3VmZml4KGRheSk7XG5cbiAgICAvLyBCdWlsZCB0aGUgZmluYWwgZm9ybWF0dGVkIHN0cmluZ1xuICAgIGNvbnN0IHBhcnRzID0gZm9ybWF0dGVkRGF0ZS5zcGxpdCgnICcpO1xuICAgIHJldHVybiBgJHtwYXJ0c1swXX0gJHtkYXl9JHtkYXlTdWZmaXh9LCAke3BhcnRzWzJdfWA7XG59XG5cbi8vIEdldHMgdGhlIGFwcHJvcHJpYXRlIG9yZGluYWwgc3VmZml4IGZvciBhIGRheSBudW1iZXJcbmV4cG9ydCBmdW5jdGlvbiBnZXREYXlTdWZmaXgoZGF5OiBudW1iZXIpOiBzdHJpbmcge1xuICAgIGlmIChkYXkgPiAzICYmIGRheSA8IDIxKSByZXR1cm4gJ3RoJzsgLy8gU3BlY2lhbCBjYXNlIGZvciAxMXRoLTE5dGhcbiAgICBzd2l0Y2ggKGRheSAlIDEwKSB7XG4gICAgICAgIGNhc2UgMTogcmV0dXJuICdzdCc7XG4gICAgICAgIGNhc2UgMjogcmV0dXJuICduZCc7XG4gICAgICAgIGNhc2UgMzogcmV0dXJuICdyZCc7XG4gICAgICAgIGRlZmF1bHQ6IHJldHVybiAndGgnO1xuICAgIH1cbn1cblxuLy8gQ2hlY2tzIGlmIGEgc3RyaW5nIG1hdGNoZXMgdGhlIFlZWVktTU0tREQgcGF0dGVyblxuZXhwb3J0IGZ1bmN0aW9uIGlzRGF0ZUZvcm1hdCh0ZXh0OiBzdHJpbmcpOiBib29sZWFuIHtcbiAgICByZXR1cm4gL15cXGR7NH0tXFxkezJ9LVxcZHsyfSQvLnRlc3QodGV4dCk7XG59IiwgImltcG9ydCB7IEFwcCwgTm90aWNlLCBURmlsZSwgVEZvbGRlciB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCB7IGlzRGF0ZUZvcm1hdCB9IGZyb20gJy4vZGF0ZS11dGlscyc7XG5cbi8qKlxuICogR2V0cyB0aGUgZnVsbCBwYXRoIGZvciBhIGZpbGUgd2l0aGluIHRoZSBzcGVjaWZpZWQgZm9sZGVyXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRGaWxlUGF0aChmb2xkZXI6IHN0cmluZywgZmlsZW5hbWU6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgaWYgKGZvbGRlcikge1xuICAgICAgICByZXR1cm4gYCR7Zm9sZGVyfS8ke2ZpbGVuYW1lfWA7XG4gICAgfVxuICAgIHJldHVybiBmaWxlbmFtZTtcbn1cblxuLyoqXG4gKiBFbnN1cmVzIHRoYXQgdGhlIHNwZWNpZmllZCBmb2xkZXIgZXhpc3RzLCBjcmVhdGluZyBpdCBpZiBuZWNlc3NhcnlcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGVuc3VyZUZvbGRlcihhcHA6IEFwcCwgZm9sZGVyUGF0aDogc3RyaW5nKTogUHJvbWlzZTxib29sZWFuPiB7XG4gICAgLy8gSWYgbm8gZm9sZGVyIGlzIHNwZWNpZmllZCwgbm90aGluZyB0byBjcmVhdGVcbiAgICBpZiAoIWZvbGRlclBhdGgpIHtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuXG4gICAgLy8gQ2hlY2sgaWYgZm9sZGVyIGV4aXN0c1xuICAgIGNvbnN0IGZvbGRlckV4aXN0cyA9IGFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgoZm9sZGVyUGF0aCk7XG4gICAgXG4gICAgLy8gSWYgaXQgZXhpc3RzLCBtYWtlIHN1cmUgaXQncyBhIGZvbGRlclxuICAgIGlmIChmb2xkZXJFeGlzdHMgJiYgIShmb2xkZXJFeGlzdHMgaW5zdGFuY2VvZiBURm9sZGVyKSkge1xuICAgICAgICBuZXcgTm90aWNlKGBDYW5ub3QgY3JlYXRlIGZvbGRlcjogXCIke2ZvbGRlclBhdGh9XCIgZXhpc3RzIGJ1dCBpcyBub3QgYSBmb2xkZXJgKTtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICBcbiAgICAvLyBDcmVhdGUgZm9sZGVyIGlmIGl0IGRvZXNuJ3QgZXhpc3RcbiAgICBpZiAoIWZvbGRlckV4aXN0cykge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgYXdhaXQgYXBwLnZhdWx0LmNyZWF0ZUZvbGRlcihmb2xkZXJQYXRoKTtcbiAgICAgICAgICAgIG5ldyBOb3RpY2UoYENyZWF0ZWQgZm9sZGVyOiAke2ZvbGRlclBhdGh9YCk7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIG5ldyBOb3RpY2UoYEZhaWxlZCB0byBjcmVhdGUgZm9sZGVyOiAke2Vycm9yfWApO1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIGNyZWF0ZSBmb2xkZXI6JywgZXJyb3IpO1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgfVxuICAgIFxuICAgIHJldHVybiB0cnVlO1xufVxuXG4vKipcbiAqIEdlbmVyYXRlcyBhIGZpbGUgcGF0aCBmb3IgYSBqb3VybmFsIGVudHJ5IGJhc2VkIG9uIHRoZSBkYXRlIGFuZCBmb2xkZXIgZm9ybWF0XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRKb3VybmFsRmlsZVBhdGgoam91cm5hbEZvbGRlcjogc3RyaW5nLCBmaWxlbmFtZTogc3RyaW5nLCBmb2xkZXJGb3JtYXQ6IHN0cmluZyA9ICcnKTogc3RyaW5nIHtcbiAgICAvLyBJZiBubyBmb2xkZXIgZm9ybWF0IGlzIHNwZWNpZmllZCwgdXNlIHRoZSBmbGF0IHN0cnVjdHVyZVxuICAgIGlmICghZm9sZGVyRm9ybWF0KSB7XG4gICAgICAgIHJldHVybiBnZXRGaWxlUGF0aChqb3VybmFsRm9sZGVyLCBmaWxlbmFtZSk7XG4gICAgfVxuICAgIFxuICAgIC8vIEV4dHJhY3QgdGhlIGRhdGUgZnJvbSB0aGUgZmlsZW5hbWUgKGFzc3VtaW5nIFlZWVktTU0tREQubWQgZm9ybWF0KVxuICAgIGNvbnN0IGRhdGVQYXJ0ID0gZmlsZW5hbWUuc3BsaXQoJy4nKVswXTsgLy8gUmVtb3ZlIGZpbGUgZXh0ZW5zaW9uXG4gICAgaWYgKCFpc0RhdGVGb3JtYXQoZGF0ZVBhcnQpKSB7XG4gICAgICAgIC8vIElmIGZpbGVuYW1lIGRvZXNuJ3QgbWF0Y2ggZGF0ZSBwYXR0ZXJuLCBmYWxsIGJhY2sgdG8gZmxhdCBzdHJ1Y3R1cmVcbiAgICAgICAgcmV0dXJuIGdldEZpbGVQYXRoKGpvdXJuYWxGb2xkZXIsIGZpbGVuYW1lKTtcbiAgICB9XG4gICAgXG4gICAgLy8gUGFyc2UgdGhlIGRhdGVcbiAgICBjb25zdCBbeWVhciwgbW9udGgsIGRheV0gPSBkYXRlUGFydC5zcGxpdCgnLScpLm1hcChwYXJ0ID0+IHBhcnNlSW50KHBhcnQpKTtcbiAgICBcbiAgICAvLyBGb3JtYXQgdGhlIGZvbGRlciBwYXRoIGJhc2VkIG9uIHRoZSBwYXR0ZXJuXG4gICAgbGV0IGZvcm1hdHRlZFBhdGggPSBmb2xkZXJGb3JtYXQ7XG4gICAgZm9ybWF0dGVkUGF0aCA9IGZvcm1hdHRlZFBhdGgucmVwbGFjZSgnWVlZWScsIHllYXIudG9TdHJpbmcoKSk7XG4gICAgZm9ybWF0dGVkUGF0aCA9IGZvcm1hdHRlZFBhdGgucmVwbGFjZSgnTU0nLCBtb250aC50b1N0cmluZygpLnBhZFN0YXJ0KDIsICcwJykpO1xuICAgIGZvcm1hdHRlZFBhdGggPSBmb3JtYXR0ZWRQYXRoLnJlcGxhY2UoJ0REJywgZGF5LnRvU3RyaW5nKCkucGFkU3RhcnQoMiwgJzAnKSk7XG4gICAgXG4gICAgLy8gQ29tYmluZSB0aGUgYmFzZSBmb2xkZXIsIGZvcm1hdHRlZCBwYXRoLCBhbmQgZmlsZW5hbWVcbiAgICBpZiAoam91cm5hbEZvbGRlcikge1xuICAgICAgICByZXR1cm4gYCR7am91cm5hbEZvbGRlcn0vJHtmb3JtYXR0ZWRQYXRofS8ke2ZpbGVuYW1lfWA7XG4gICAgfVxuICAgIHJldHVybiBgJHtmb3JtYXR0ZWRQYXRofS8ke2ZpbGVuYW1lfWA7XG59XG5cbi8qKlxuICogRW5zdXJlcyBhbGwgZm9sZGVycyBpbiBhIHBhdGggZXhpc3RcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGVuc3VyZUFsbEZvbGRlcnMoYXBwOiBBcHAsIGZpbGVQYXRoOiBzdHJpbmcpOiBQcm9taXNlPGJvb2xlYW4+IHtcbiAgICAvLyBTcGxpdCB0aGUgcGF0aCB0byBlbnN1cmUgYWxsIGZvbGRlcnMgZXhpc3RcbiAgICBjb25zdCBwYXRoUGFydHMgPSBmaWxlUGF0aC5zcGxpdCgnLycpO1xuICAgIGNvbnN0IGZpbGVOYW1lSW5kZXggPSBwYXRoUGFydHMubGVuZ3RoIC0gMTtcbiAgICBcbiAgICAvLyBFbnN1cmUgYWxsIGZvbGRlcnMgaW4gdGhlIHBhdGggZXhpc3RcbiAgICBsZXQgY3VycmVudEZvbGRlciA9ICcnO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZmlsZU5hbWVJbmRleDsgaSsrKSB7XG4gICAgICAgIGlmIChjdXJyZW50Rm9sZGVyKSB7XG4gICAgICAgICAgICBjdXJyZW50Rm9sZGVyICs9ICcvJztcbiAgICAgICAgfVxuICAgICAgICBjdXJyZW50Rm9sZGVyICs9IHBhdGhQYXJ0c1tpXTtcbiAgICAgICAgXG4gICAgICAgIC8vIFNraXAgZW1wdHkgcGFydHNcbiAgICAgICAgaWYgKCFjdXJyZW50Rm9sZGVyKSBjb250aW51ZTtcbiAgICAgICAgXG4gICAgICAgIC8vIENyZWF0ZSBmb2xkZXIgaWYgaXQgZG9lc24ndCBleGlzdFxuICAgICAgICBpZiAoIShhd2FpdCBlbnN1cmVGb2xkZXIoYXBwLCBjdXJyZW50Rm9sZGVyKSkpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBcbiAgICByZXR1cm4gdHJ1ZTtcbn1cblxuLyoqXG4gKiBDcmVhdGVzIG9yIGdldHMgYSBqb3VybmFsIGZpbGUgZm9yIHRoZSBzcGVjaWZpZWQgZGF0ZVxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0T3JDcmVhdGVKb3VybmFsRmlsZShcbiAgICBhcHA6IEFwcCwgXG4gICAgam91cm5hbEZvbGRlcjogc3RyaW5nLCBcbiAgICBmaWxlbmFtZTogc3RyaW5nLFxuICAgIGZvbGRlckZvcm1hdDogc3RyaW5nID0gJycsXG4gICAgaW5pdGlhbENvbnRlbnQ6IHN0cmluZyA9ICcnXG4pOiBQcm9taXNlPFRGaWxlIHwgbnVsbD4ge1xuICAgIC8vIEdlbmVyYXRlIHRoZSBmaWxlIHBhdGggdXNpbmcgdGhlIG5ldyBmdW5jdGlvblxuICAgIGNvbnN0IGZpbGVQYXRoID0gZ2V0Sm91cm5hbEZpbGVQYXRoKGpvdXJuYWxGb2xkZXIsIGZpbGVuYW1lLCBmb2xkZXJGb3JtYXQpO1xuICAgIFxuICAgIC8vIEVuc3VyZSBhbGwgbmVjZXNzYXJ5IGZvbGRlcnMgZXhpc3RcbiAgICBpZiAoIShhd2FpdCBlbnN1cmVBbGxGb2xkZXJzKGFwcCwgZmlsZVBhdGgpKSkge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gICAgXG4gICAgLy8gQ2hlY2sgaWYgdGhlIGZpbGUgYWxyZWFkeSBleGlzdHNcbiAgICBsZXQgZmlsZSA9IGFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgoZmlsZVBhdGgpO1xuICAgIFxuICAgIGlmIChmaWxlIGluc3RhbmNlb2YgVEZpbGUpIHtcbiAgICAgICAgcmV0dXJuIGZpbGU7XG4gICAgfVxuICAgIFxuICAgIC8vIENyZWF0ZSB0aGUgZmlsZSBpZiBpdCBkb2Vzbid0IGV4aXN0XG4gICAgdHJ5IHtcbiAgICAgICAgZmlsZSA9IGF3YWl0IGFwcC52YXVsdC5jcmVhdGUoZmlsZVBhdGgsIGluaXRpYWxDb250ZW50KTtcbiAgICAgICAgbmV3IE5vdGljZShgQ3JlYXRlZCBqb3VybmFsIGVudHJ5OiAke2ZpbGVuYW1lfWApO1xuICAgICAgICByZXR1cm4gZmlsZSBhcyBURmlsZTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBuZXcgTm90aWNlKGBGYWlsZWQgdG8gY3JlYXRlIGpvdXJuYWwgZW50cnk6ICR7ZXJyb3J9YCk7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0ZhaWxlZCB0byBjcmVhdGUgam91cm5hbCBlbnRyeTonLCBlcnJvcik7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbn1cblxuLyoqXG4gKiBDaGVja3MgaWYgYSBmaWxlIGlzIGEgam91cm5hbCBmaWxlIGJhc2VkIG9uIGl0cyBuYW1lIHBhdHRlcm4gYW5kIGxvY2F0aW9uXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpc0pvdXJuYWxGaWxlKGZpbGU6IFRGaWxlLCBqb3VybmFsRm9sZGVyPzogc3RyaW5nLCBmb2xkZXJGb3JtYXQ/OiBzdHJpbmcpOiBib29sZWFuIHtcbiAgICAvLyBDaGVjayBpZiBiYXNlbmFtZSBtYXRjaGVzIFlZWVktTU0tREQgcGF0dGVyblxuICAgIGNvbnN0IGlzRGF0ZUJhc2VuYW1lID0gaXNEYXRlRm9ybWF0KGZpbGUuYmFzZW5hbWUpO1xuICAgIFxuICAgIGlmICghaXNEYXRlQmFzZW5hbWUpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICBcbiAgICAvLyBJZiBubyBmb2xkZXIgaXMgc3BlY2lmaWVkLCBqdXN0IGNoZWNrIHRoZSBiYXNlbmFtZVxuICAgIGlmICgham91cm5hbEZvbGRlcikge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgXG4gICAgLy8gV2l0aCBmb2xkZXIgZm9ybWF0LCB3ZSBuZWVkIGEgbW9yZSBzb3BoaXN0aWNhdGVkIGNoZWNrXG4gICAgaWYgKGZvbGRlckZvcm1hdCkge1xuICAgICAgICAvLyBHZW5lcmF0ZSB0aGUgZXhwZWN0ZWQgYmFzZSBwYXRoXG4gICAgICAgIGNvbnN0IGRhdGVTdHIgPSBmaWxlLmJhc2VuYW1lLnNwbGl0KCcuJylbMF07XG4gICAgICAgIGNvbnN0IFt5ZWFyLCBtb250aCwgZGF5XSA9IGRhdGVTdHIuc3BsaXQoJy0nKTtcbiAgICAgICAgXG4gICAgICAgIGxldCBleHBlY3RlZFBhdGggPSBmb2xkZXJGb3JtYXQ7XG4gICAgICAgIGV4cGVjdGVkUGF0aCA9IGV4cGVjdGVkUGF0aC5yZXBsYWNlKCdZWVlZJywgeWVhcik7XG4gICAgICAgIGV4cGVjdGVkUGF0aCA9IGV4cGVjdGVkUGF0aC5yZXBsYWNlKCdNTScsIG1vbnRoKTtcbiAgICAgICAgZXhwZWN0ZWRQYXRoID0gZXhwZWN0ZWRQYXRoLnJlcGxhY2UoJ0REJywgZGF5KTtcbiAgICAgICAgXG4gICAgICAgIGNvbnN0IGV4cGVjdGVkRnVsbFBhdGggPSBgJHtqb3VybmFsRm9sZGVyfS8ke2V4cGVjdGVkUGF0aH1gO1xuICAgICAgICBcbiAgICAgICAgLy8gQ2hlY2sgaWYgdGhlIGZpbGUncyBwYXRoIGNvbnRhaW5zIHRoZSBleHBlY3RlZCBwYXRoXG4gICAgICAgIHJldHVybiBmaWxlLnBhdGguc3RhcnRzV2l0aChleHBlY3RlZEZ1bGxQYXRoKTtcbiAgICB9XG4gICAgXG4gICAgLy8gV2l0aG91dCBmb2xkZXIgZm9ybWF0LCBqdXN0IGNoZWNrIGlmIGl0J3MgaW4gdGhlIGpvdXJuYWwgZm9sZGVyXG4gICAgcmV0dXJuIGZpbGUucGF0aC5zdGFydHNXaXRoKGpvdXJuYWxGb2xkZXIgKyAnLycpO1xufVxuXG4vKipcbiAqIEdldHMgYWxsIGpvdXJuYWwgZmlsZXMgaW4gdGhlIHZhdWx0XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRKb3VybmFsRmlsZXMoYXBwOiBBcHAsIGpvdXJuYWxGb2xkZXI/OiBzdHJpbmcsIGZvbGRlckZvcm1hdD86IHN0cmluZyk6IFRGaWxlW10ge1xuICAgIC8vIEdldCBhbGwgbWFya2Rvd24gZmlsZXMgaW4gdGhlIHZhdWx0XG4gICAgY29uc3QgZmlsZXMgPSBhcHAudmF1bHQuZ2V0TWFya2Rvd25GaWxlcygpO1xuXG4gICAgLy8gRmlsdGVyIGZpbGVzIHRoYXQgZm9sbG93IGEgZGFpbHkgbm90ZSBwYXR0ZXJuIGFuZCBhcmUgaW4gdGhlIGNvcnJlY3QgZm9sZGVyIHN0cnVjdHVyZVxuICAgIHJldHVybiBmaWxlcy5maWx0ZXIoKGZpbGUpID0+IGlzSm91cm5hbEZpbGUoZmlsZSwgam91cm5hbEZvbGRlciwgZm9sZGVyRm9ybWF0KSk7XG59XG5cbi8qKlxuICogU29ydHMgam91cm5hbCBmaWxlcyBieSBkYXRlXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBzb3J0Sm91cm5hbEZpbGVzKGZpbGVzOiBURmlsZVtdLCBzb3J0RGlyZWN0aW9uOiAnbmV3ZXN0LWZpcnN0JyB8ICdvbGRlc3QtZmlyc3QnKTogVEZpbGVbXSB7XG4gICAgcmV0dXJuIGZpbGVzLnNvcnQoKGEsIGIpID0+IHtcbiAgICAgICAgaWYgKHNvcnREaXJlY3Rpb24gPT09ICduZXdlc3QtZmlyc3QnKSB7XG4gICAgICAgICAgICByZXR1cm4gYi5iYXNlbmFtZS5sb2NhbGVDb21wYXJlKGEuYmFzZW5hbWUpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIGEuYmFzZW5hbWUubG9jYWxlQ29tcGFyZShiLmJhc2VuYW1lKTtcbiAgICAgICAgfVxuICAgIH0pO1xufSJdLAogICJtYXBwaW5ncyI6ICI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSxJQUFBQSxtQkFBa0Q7OztBQ0FsRCxzQkFBc0Q7QUFXL0MsSUFBTSxtQkFBdUM7QUFBQSxFQUNoRCxlQUFlO0FBQUEsRUFDZixZQUFZO0FBQUEsRUFDWixlQUFlO0FBQUEsRUFDZixzQkFBc0I7QUFBQSxFQUN0QixjQUFjO0FBQ2xCO0FBRU8sSUFBTSx1QkFBTixjQUFtQyxpQ0FBaUI7QUFBQSxFQUd2RCxZQUFZLEtBQVUsUUFBMEI7QUFDNUMsVUFBTSxLQUFLLE1BQU07QUFDakIsU0FBSyxTQUFTO0FBQUEsRUFDbEI7QUFBQSxFQUVBLFVBQWdCO0FBQ1osVUFBTSxFQUFFLFlBQVksSUFBSTtBQUN4QixnQkFBWSxNQUFNO0FBRWxCLGdCQUFZLFNBQVMsTUFBTSxFQUFFLE1BQU0saUNBQWlDLENBQUM7QUFFckUsUUFBSSx3QkFBUSxXQUFXLEVBQ2xCLFFBQVEsZ0JBQWdCLEVBQ3hCLFFBQVEseURBQXlELEVBQ2pFLFFBQVEsVUFBUSxLQUNaLGVBQWUsVUFBVSxFQUN6QixTQUFTLEtBQUssT0FBTyxTQUFTLGFBQWEsRUFDM0MsU0FBUyxPQUFPLFVBQVU7QUFFdkIsV0FBSyxPQUFPLFNBQVMsZ0JBQWdCLE1BQU0sUUFBUSxjQUFjLEVBQUU7QUFDbkUsWUFBTSxLQUFLLE9BQU8sYUFBYTtBQUFBLElBQ25DLENBQUMsQ0FBQztBQUVWLFFBQUksd0JBQVEsV0FBVyxFQUNsQixRQUFRLGFBQWEsRUFDckIsUUFBUSx1REFBdUQsRUFDL0QsUUFBUSxVQUFRLEtBQ1osZUFBZSxZQUFZLEVBQzNCLFNBQVMsS0FBSyxPQUFPLFNBQVMsVUFBVSxFQUN4QyxTQUFTLE9BQU8sVUFBVTtBQUN2QixXQUFLLE9BQU8sU0FBUyxhQUFhO0FBQ2xDLFlBQU0sS0FBSyxPQUFPLGFBQWE7QUFBQSxJQUNuQyxDQUFDLENBQUM7QUFFVixRQUFJLHdCQUFRLFdBQVcsRUFDbEIsUUFBUSxnQkFBZ0IsRUFDeEIsUUFBUSxvREFBb0QsRUFDNUQsWUFBWSxjQUFZLFNBQ3BCLFVBQVUsZ0JBQWdCLHNCQUFzQixFQUNoRCxVQUFVLGdCQUFnQixzQkFBc0IsRUFDaEQsU0FBUyxLQUFLLE9BQU8sU0FBUyxhQUFhLEVBQzNDLFNBQVMsT0FBTyxVQUEyQztBQUN4RCxXQUFLLE9BQU8sU0FBUyxnQkFBZ0I7QUFDckMsWUFBTSxLQUFLLE9BQU8sYUFBYTtBQUFBLElBQ25DLENBQUMsQ0FBQztBQUVWLFFBQUksd0JBQVEsV0FBVyxFQUNsQixRQUFRLHdCQUF3QixFQUNoQyxRQUFRLDZEQUE2RCxFQUNyRSxVQUFVLFlBQVUsT0FDaEIsU0FBUyxLQUFLLE9BQU8sU0FBUyxvQkFBb0IsRUFDbEQsU0FBUyxPQUFPLFVBQVU7QUFDdkIsV0FBSyxPQUFPLFNBQVMsdUJBQXVCO0FBQzVDLFlBQU0sS0FBSyxPQUFPLGFBQWE7QUFBQSxJQUNuQyxDQUFDLENBQUM7QUFFVixRQUFJLHdCQUFRLFdBQVcsRUFDbEIsUUFBUSx5QkFBeUIsRUFDakMsUUFBUSw0SkFBNEosRUFDcEssUUFBUSxVQUFRLEtBQ1osZUFBZSxTQUFTLEVBQ3hCLFNBQVMsS0FBSyxPQUFPLFNBQVMsWUFBWSxFQUMxQyxTQUFTLE9BQU8sVUFBVTtBQUN2QixXQUFLLE9BQU8sU0FBUyxlQUFlO0FBQ3BDLFlBQU0sS0FBSyxPQUFPLGFBQWE7QUFBQSxJQUMzQyxDQUFDLENBQUM7QUFFRixRQUFJLHdCQUFRLFdBQVcsRUFDbEIsUUFBUSx5QkFBeUIsRUFDakMsUUFBUSw2RkFBNkYsRUFDckcsVUFBVSxZQUFVLE9BQ2hCLGNBQWMsaUJBQWlCLEVBQy9CLE9BQU8sRUFDUCxRQUFRLFlBQVk7QUFDakIsWUFBTSxLQUFLLE9BQU8sc0JBQXNCO0FBQUEsSUFDcEQsQ0FBQyxDQUFDO0FBQUEsRUFDTjtBQUNKOzs7QUNuR0EsSUFBQUMsbUJBQStEOzs7QUNDeEQsU0FBUyxlQUF1QjtBQUNuQyxRQUFNLFFBQVEsSUFBSSxLQUFLO0FBQ3ZCLFNBQU8saUJBQWlCLEtBQUs7QUFDakM7QUFHTyxTQUFTLGlCQUFpQixNQUFvQjtBQUNqRCxRQUFNLE9BQU8sS0FBSyxZQUFZO0FBQzlCLFFBQU0sUUFBUSxPQUFPLEtBQUssU0FBUyxJQUFJLENBQUMsRUFBRSxTQUFTLEdBQUcsR0FBRztBQUN6RCxRQUFNLE1BQU0sT0FBTyxLQUFLLFFBQVEsQ0FBQyxFQUFFLFNBQVMsR0FBRyxHQUFHO0FBQ2xELFNBQU8sR0FBRyxRQUFRLFNBQVM7QUFDL0I7QUFHTyxTQUFTLHFCQUFxQixZQUE0QjtBQUM3RCxRQUFNLE9BQU8sSUFBSSxLQUFLLFVBQVU7QUFDaEMsUUFBTSxvQkFBZ0Q7QUFBQSxJQUNsRCxPQUFPO0FBQUEsSUFDUCxNQUFNO0FBQUEsSUFDTixLQUFLO0FBQUEsRUFDVDtBQUdBLFFBQU0sZ0JBQWdCLElBQUksS0FBSyxlQUFlLFNBQVMsaUJBQWlCLEVBQUUsT0FBTyxJQUFJO0FBR3JGLFFBQU0sTUFBTSxLQUFLLFFBQVE7QUFDekIsUUFBTSxZQUFZLGFBQWEsR0FBRztBQUdsQyxRQUFNLFFBQVEsY0FBYyxNQUFNLEdBQUc7QUFDckMsU0FBTyxHQUFHLE1BQU0sQ0FBQyxLQUFLLE1BQU0sY0FBYyxNQUFNLENBQUM7QUFDckQ7QUFHTyxTQUFTLGFBQWEsS0FBcUI7QUFDOUMsTUFBSSxNQUFNLEtBQUssTUFBTTtBQUFJLFdBQU87QUFDaEMsVUFBUSxNQUFNLElBQUk7QUFBQSxJQUNkLEtBQUs7QUFBRyxhQUFPO0FBQUEsSUFDZixLQUFLO0FBQUcsYUFBTztBQUFBLElBQ2YsS0FBSztBQUFHLGFBQU87QUFBQSxJQUNmO0FBQVMsYUFBTztBQUFBLEVBQ3BCO0FBQ0o7QUFHTyxTQUFTLGFBQWEsTUFBdUI7QUFDaEQsU0FBTyxzQkFBc0IsS0FBSyxJQUFJO0FBQzFDOzs7QUNqREEsSUFBQUMsbUJBQTRDO0FBTXJDLFNBQVMsWUFBWSxRQUFnQixVQUEwQjtBQUNsRSxNQUFJLFFBQVE7QUFDUixXQUFPLEdBQUcsVUFBVTtBQUFBLEVBQ3hCO0FBQ0EsU0FBTztBQUNYO0FBS0EsZUFBc0IsYUFBYSxLQUFVLFlBQXNDO0FBRS9FLE1BQUksQ0FBQyxZQUFZO0FBQ2IsV0FBTztBQUFBLEVBQ1g7QUFHQSxRQUFNLGVBQWUsSUFBSSxNQUFNLHNCQUFzQixVQUFVO0FBRy9ELE1BQUksZ0JBQWdCLEVBQUUsd0JBQXdCLDJCQUFVO0FBQ3BELFFBQUksd0JBQU8sMEJBQTBCLHdDQUF3QztBQUM3RSxXQUFPO0FBQUEsRUFDWDtBQUdBLE1BQUksQ0FBQyxjQUFjO0FBQ2YsUUFBSTtBQUNBLFlBQU0sSUFBSSxNQUFNLGFBQWEsVUFBVTtBQUN2QyxVQUFJLHdCQUFPLG1CQUFtQixZQUFZO0FBQzFDLGFBQU87QUFBQSxJQUNYLFNBQVMsT0FBUDtBQUNFLFVBQUksd0JBQU8sNEJBQTRCLE9BQU87QUFDOUMsY0FBUSxNQUFNLDRCQUE0QixLQUFLO0FBQy9DLGFBQU87QUFBQSxJQUNYO0FBQUEsRUFDSjtBQUVBLFNBQU87QUFDWDtBQUtPLFNBQVMsbUJBQW1CLGVBQXVCLFVBQWtCLGVBQXVCLElBQVk7QUFFM0csTUFBSSxDQUFDLGNBQWM7QUFDZixXQUFPLFlBQVksZUFBZSxRQUFRO0FBQUEsRUFDOUM7QUFHQSxRQUFNLFdBQVcsU0FBUyxNQUFNLEdBQUcsRUFBRSxDQUFDO0FBQ3RDLE1BQUksQ0FBQyxhQUFhLFFBQVEsR0FBRztBQUV6QixXQUFPLFlBQVksZUFBZSxRQUFRO0FBQUEsRUFDOUM7QUFHQSxRQUFNLENBQUMsTUFBTSxPQUFPLEdBQUcsSUFBSSxTQUFTLE1BQU0sR0FBRyxFQUFFLElBQUksVUFBUSxTQUFTLElBQUksQ0FBQztBQUd6RSxNQUFJLGdCQUFnQjtBQUNwQixrQkFBZ0IsY0FBYyxRQUFRLFFBQVEsS0FBSyxTQUFTLENBQUM7QUFDN0Qsa0JBQWdCLGNBQWMsUUFBUSxNQUFNLE1BQU0sU0FBUyxFQUFFLFNBQVMsR0FBRyxHQUFHLENBQUM7QUFDN0Usa0JBQWdCLGNBQWMsUUFBUSxNQUFNLElBQUksU0FBUyxFQUFFLFNBQVMsR0FBRyxHQUFHLENBQUM7QUFHM0UsTUFBSSxlQUFlO0FBQ2YsV0FBTyxHQUFHLGlCQUFpQixpQkFBaUI7QUFBQSxFQUNoRDtBQUNBLFNBQU8sR0FBRyxpQkFBaUI7QUFDL0I7QUFLQSxlQUFzQixpQkFBaUIsS0FBVSxVQUFvQztBQUVqRixRQUFNLFlBQVksU0FBUyxNQUFNLEdBQUc7QUFDcEMsUUFBTSxnQkFBZ0IsVUFBVSxTQUFTO0FBR3pDLE1BQUksZ0JBQWdCO0FBQ3BCLFdBQVMsSUFBSSxHQUFHLElBQUksZUFBZSxLQUFLO0FBQ3BDLFFBQUksZUFBZTtBQUNmLHVCQUFpQjtBQUFBLElBQ3JCO0FBQ0EscUJBQWlCLFVBQVUsQ0FBQztBQUc1QixRQUFJLENBQUM7QUFBZTtBQUdwQixRQUFJLENBQUUsTUFBTSxhQUFhLEtBQUssYUFBYSxHQUFJO0FBQzNDLGFBQU87QUFBQSxJQUNYO0FBQUEsRUFDSjtBQUVBLFNBQU87QUFDWDtBQUtBLGVBQXNCLHVCQUNsQixLQUNBLGVBQ0EsVUFDQSxlQUF1QixJQUN2QixpQkFBeUIsSUFDSjtBQUVyQixRQUFNLFdBQVcsbUJBQW1CLGVBQWUsVUFBVSxZQUFZO0FBR3pFLE1BQUksQ0FBRSxNQUFNLGlCQUFpQixLQUFLLFFBQVEsR0FBSTtBQUMxQyxXQUFPO0FBQUEsRUFDWDtBQUdBLE1BQUksT0FBTyxJQUFJLE1BQU0sc0JBQXNCLFFBQVE7QUFFbkQsTUFBSSxnQkFBZ0Isd0JBQU87QUFDdkIsV0FBTztBQUFBLEVBQ1g7QUFHQSxNQUFJO0FBQ0EsV0FBTyxNQUFNLElBQUksTUFBTSxPQUFPLFVBQVUsY0FBYztBQUN0RCxRQUFJLHdCQUFPLDBCQUEwQixVQUFVO0FBQy9DLFdBQU87QUFBQSxFQUNYLFNBQVMsT0FBUDtBQUNFLFFBQUksd0JBQU8sbUNBQW1DLE9BQU87QUFDckQsWUFBUSxNQUFNLG1DQUFtQyxLQUFLO0FBQ3RELFdBQU87QUFBQSxFQUNYO0FBQ0o7QUFLTyxTQUFTLGNBQWMsTUFBYSxlQUF3QixjQUFnQztBQUUvRixRQUFNLGlCQUFpQixhQUFhLEtBQUssUUFBUTtBQUVqRCxNQUFJLENBQUMsZ0JBQWdCO0FBQ2pCLFdBQU87QUFBQSxFQUNYO0FBR0EsTUFBSSxDQUFDLGVBQWU7QUFDaEIsV0FBTztBQUFBLEVBQ1g7QUFHQSxNQUFJLGNBQWM7QUFFZCxVQUFNLFVBQVUsS0FBSyxTQUFTLE1BQU0sR0FBRyxFQUFFLENBQUM7QUFDMUMsVUFBTSxDQUFDLE1BQU0sT0FBTyxHQUFHLElBQUksUUFBUSxNQUFNLEdBQUc7QUFFNUMsUUFBSSxlQUFlO0FBQ25CLG1CQUFlLGFBQWEsUUFBUSxRQUFRLElBQUk7QUFDaEQsbUJBQWUsYUFBYSxRQUFRLE1BQU0sS0FBSztBQUMvQyxtQkFBZSxhQUFhLFFBQVEsTUFBTSxHQUFHO0FBRTdDLFVBQU0sbUJBQW1CLEdBQUcsaUJBQWlCO0FBRzdDLFdBQU8sS0FBSyxLQUFLLFdBQVcsZ0JBQWdCO0FBQUEsRUFDaEQ7QUFHQSxTQUFPLEtBQUssS0FBSyxXQUFXLGdCQUFnQixHQUFHO0FBQ25EO0FBS08sU0FBUyxnQkFBZ0IsS0FBVSxlQUF3QixjQUFnQztBQUU5RixRQUFNLFFBQVEsSUFBSSxNQUFNLGlCQUFpQjtBQUd6QyxTQUFPLE1BQU0sT0FBTyxDQUFDLFNBQVMsY0FBYyxNQUFNLGVBQWUsWUFBWSxDQUFDO0FBQ2xGO0FBS08sU0FBUyxpQkFBaUIsT0FBZ0IsZUFBeUQ7QUFDdEcsU0FBTyxNQUFNLEtBQUssQ0FBQyxHQUFHLE1BQU07QUFDeEIsUUFBSSxrQkFBa0IsZ0JBQWdCO0FBQ2xDLGFBQU8sRUFBRSxTQUFTLGNBQWMsRUFBRSxRQUFRO0FBQUEsSUFDOUMsT0FBTztBQUNILGFBQU8sRUFBRSxTQUFTLGNBQWMsRUFBRSxRQUFRO0FBQUEsSUFDOUM7QUFBQSxFQUNKLENBQUM7QUFDTDs7O0FGdE1PLElBQU0sY0FBTixNQUFrQjtBQUFBLEVBVXJCLFlBQVksUUFBMEI7QUFSdEMsd0JBQTJDO0FBRzNDO0FBQUEsU0FBUSxXQUFvQixDQUFDO0FBQzdCLFNBQVEsWUFBb0I7QUFDNUIsU0FBUSxlQUF1QjtBQUMvQixTQUFRLGlCQUFxQztBQUd6QyxTQUFLLFNBQVM7QUFDZCxTQUFLLGdCQUFnQjtBQUFBLEVBQ3pCO0FBQUE7QUFBQSxFQUdBLE1BQU0sT0FBc0I7QUFFeEIsVUFBTSxPQUFPLEtBQUssT0FBTyxJQUFJLFVBQVUsUUFBUSxJQUFJO0FBR25ELFVBQU0sS0FBSyxhQUFhO0FBQUEsTUFDcEIsTUFBTTtBQUFBLE1BQ04sUUFBUTtBQUFBLElBQ1osQ0FBQztBQUdELFVBQU0sWUFBWSxLQUFLLEtBQUs7QUFDNUIsY0FBVSxNQUFNO0FBR2hCLFVBQU0sUUFBUSxVQUFVLFVBQVUsRUFBRSxLQUFLLHVCQUF1QixDQUFDO0FBR2pFLFVBQU0sZUFBZTtBQUFBLE1BQ2pCLEtBQUssT0FBTztBQUFBLE1BQ1osS0FBSyxPQUFPLFNBQVM7QUFBQSxNQUNyQixLQUFLLE9BQU8sU0FBUztBQUFBLElBQ3pCO0FBRUEsUUFBSSxhQUFhLFdBQVcsR0FBRztBQUMzQixVQUFJLHdCQUFPLDJCQUEyQjtBQUN0QyxZQUFNLFNBQVMsT0FBTztBQUFBLFFBQ2xCLEtBQUs7QUFBQSxRQUNMLE1BQU07QUFBQSxNQUNWLENBQUM7QUFDRDtBQUFBLElBQ0o7QUFHQSxTQUFLLFdBQVcsaUJBQWlCLGNBQWMsS0FBSyxPQUFPLFNBQVMsYUFBYTtBQUdqRixTQUFLLGVBQWU7QUFHcEIsVUFBTSxLQUFLLFVBQVUsS0FBSztBQUcxQixRQUFJLEtBQUssZUFBZSxLQUFLLFlBQVksS0FBSyxTQUFTLFFBQVE7QUFDM0QsV0FBSyxrQkFBa0IsS0FBSztBQUFBLElBQ2hDO0FBQUEsRUFDSjtBQUFBO0FBQUEsRUFHQSxNQUFjLFVBQVUsT0FBbUM7QUFDdkQsVUFBTSxRQUFRLEtBQUssZUFBZSxLQUFLO0FBQ3ZDLFVBQU0sTUFBTSxLQUFLLElBQUksUUFBUSxLQUFLLFdBQVcsS0FBSyxTQUFTLE1BQU07QUFHakUsVUFBTSxjQUFjLEtBQUssU0FBUyxNQUFNLE9BQU8sR0FBRztBQUdsRCxlQUFXLFFBQVEsYUFBYTtBQUM1QixVQUFJO0FBQ0EsY0FBTSxjQUFjLE1BQU0sS0FBSyxPQUFPLElBQUksTUFBTSxLQUFLLElBQUk7QUFDekQsYUFBSyxnQkFBZ0IsT0FBTyxNQUFNLFdBQVc7QUFBQSxNQUNqRCxTQUFTLE9BQVA7QUFDRSxnQkFBUSxNQUFNLHNCQUFzQixLQUFLLFNBQVMsS0FBSztBQUN2RCxhQUFLLGdCQUFnQixPQUFPLEtBQUssVUFBVSxLQUFLO0FBQUEsTUFDcEQ7QUFBQSxJQUNKO0FBR0EsU0FBSztBQUFBLEVBQ1Q7QUFBQTtBQUFBLEVBR1Esa0JBQWtCLE9BQTBCO0FBRWhELFFBQUksS0FBSyxnQkFBZ0I7QUFDckIsV0FBSyxlQUFlLE9BQU87QUFBQSxJQUMvQjtBQUdBLFNBQUssaUJBQWlCLE1BQU0sU0FBUyxVQUFVO0FBQUEsTUFDM0MsS0FBSztBQUFBLE1BQ0wsTUFBTTtBQUFBLElBQ1YsQ0FBQztBQUdELFVBQU0sU0FBUyxLQUFLO0FBRXBCLFdBQU8saUJBQWlCLFNBQVMsWUFBWTtBQUV6QyxhQUFPLGNBQWM7QUFDckIsYUFBTyxRQUFRLFlBQVksTUFBTTtBQUdqQyxZQUFNLEtBQUssVUFBVSxLQUFLO0FBRzFCLFVBQUksS0FBSyxlQUFlLEtBQUssWUFBWSxLQUFLLFNBQVMsUUFBUTtBQUMzRCxlQUFPLGNBQWM7QUFDckIsZUFBTyxnQkFBZ0IsVUFBVTtBQUFBLE1BQ3JDLE9BQU87QUFDSCxlQUFPLE9BQU87QUFDZCxhQUFLLGlCQUFpQjtBQUFBLE1BQzFCO0FBQUEsSUFDSixDQUFDO0FBQUEsRUFDTDtBQUFBO0FBQUEsRUFHUSxnQkFBZ0IsT0FBb0IsVUFBa0IsT0FBa0I7QUFDNUUsVUFBTSxXQUFXLE1BQU0sVUFBVSxFQUFFLEtBQUssOEJBQThCLENBQUM7QUFFdkUsVUFBTSxjQUFjLFNBQVMsVUFBVSxFQUFFLEtBQUssdUJBQXVCLENBQUM7QUFDdEUsZ0JBQVksU0FBUyxNQUFNO0FBQUEsTUFDdkIsS0FBSztBQUFBLE1BQ0wsTUFBTSxHQUFHO0FBQUEsSUFDYixDQUFDO0FBRUQsVUFBTSxlQUFlLFNBQVMsVUFBVSxFQUFFLEtBQUssd0JBQXdCLENBQUM7QUFDeEUsaUJBQWEsY0FBYywyQkFBMkIsTUFBTSxXQUFXO0FBQUEsRUFDM0U7QUFBQTtBQUFBLEVBR1EsZ0JBQWdCLE9BQW9CLE1BQWEsU0FBdUI7QUFDNUUsVUFBTSxjQUFjLEtBQUs7QUFHekIsVUFBTSxlQUFlLE1BQU0sVUFBVSxFQUFFLEtBQUssZ0JBQWdCLENBQUM7QUFHN0QsVUFBTSxTQUFTLGFBQWEsVUFBVSxFQUFFLEtBQUssdUJBQXVCLENBQUM7QUFHckUsVUFBTSxlQUFlLE9BQU8sU0FBUyxVQUFVLEVBQUUsS0FBSyxxQkFBcUIsQ0FBQztBQUM1RSxRQUFJLEtBQUssT0FBTyxTQUFTLHNCQUFzQjtBQUMzQyxtQkFBYSxTQUFTLGlCQUFpQjtBQUFBLElBQzNDO0FBR0EsVUFBTSxRQUFRLE9BQU8sU0FBUyxNQUFNLEVBQUUsS0FBSyxzQkFBc0IsQ0FBQztBQUNsRSxVQUFNLFlBQVksTUFBTSxTQUFTLEtBQUs7QUFBQSxNQUNsQyxLQUFLO0FBQUEsTUFDTCxNQUFNLHFCQUFxQixXQUFXO0FBQUEsSUFDMUMsQ0FBQztBQUdELGNBQVUsaUJBQWlCLFNBQVMsQ0FBQyxVQUFVO0FBQzNDLFlBQU0sZUFBZTtBQUNyQixXQUFLLE9BQU8sSUFBSSxVQUFVLGFBQWEsS0FBSyxVQUFVLEtBQUssSUFBSTtBQUFBLElBQ25FLENBQUM7QUFHRCxVQUFNLGNBQWMsYUFBYSxVQUFVO0FBQUEsTUFDdkMsS0FBSyx5QkFBeUIsS0FBSyxPQUFPLFNBQVMsdUJBQXVCLHNCQUFzQjtBQUFBLElBQ3BHLENBQUM7QUFHRCxRQUFJLGlCQUFpQjtBQUdyQixRQUFJLFlBQVk7QUFHaEIsVUFBTSxrQkFBa0IsWUFBWSxVQUFVO0FBQUEsTUFDMUMsS0FBSztBQUFBLElBQ1QsQ0FBQztBQUdELFVBQU0sa0JBQWtCLFlBQVksU0FBUyxZQUFZO0FBQUEsTUFDckQsS0FBSztBQUFBLE1BQ0wsT0FBTztBQUFBLElBQ1gsQ0FBQztBQUdELFVBQU0sY0FBYyxZQUFZLFNBQVMsVUFBVTtBQUFBLE1BQy9DLEtBQUs7QUFBQSxNQUNMLE1BQU07QUFBQSxJQUNWLENBQUM7QUFDRCxnQkFBWSxNQUFNLFVBQVU7QUFHNUIsVUFBTSxnQkFBZ0IsWUFBWSxVQUFVO0FBQUEsTUFDeEMsS0FBSztBQUFBLE1BQ0wsTUFBTTtBQUFBLElBQ1YsQ0FBQztBQUNELGtCQUFjLE1BQU0sVUFBVTtBQUc5QixXQUFPLHNCQUFzQixNQUFNO0FBQy9CLHNCQUFnQixNQUFNLFNBQVMsZ0JBQWdCLGVBQWU7QUFBQSxJQUNsRSxDQUFDO0FBR0QsVUFBTSxnQkFBZ0IsTUFBTTtBQUN4QixzQkFBZ0IsTUFBTTtBQUN0Qix3Q0FBaUIsT0FBTyxLQUFLLE9BQU8sS0FBSyxnQkFBZ0IsaUJBQWlCLEtBQUssTUFBTSxLQUFLLE1BQU07QUFBQSxJQUNwRztBQUdBLGtCQUFjO0FBR2QsVUFBTSxnQkFBZ0IsTUFBTTtBQUV4QixrQkFBWTtBQUNaLFdBQUssZUFBZTtBQUdwQixzQkFBZ0IsUUFBUTtBQUd4QixzQkFBZ0IsVUFBVSxPQUFPLGFBQWE7QUFDOUMsc0JBQWdCLFVBQVUsSUFBSSxhQUFhO0FBQzNDLGtCQUFZLE1BQU0sVUFBVTtBQUc1QixzQkFBZ0IsTUFBTSxTQUFTO0FBQy9CLHNCQUFnQixNQUFNLFNBQVMsZ0JBQWdCLGVBQWU7QUFDOUQsc0JBQWdCLE1BQU07QUFBQSxJQUMxQjtBQUdBLFVBQU0sZUFBZSxZQUFZO0FBRTdCLFVBQUksV0FBVztBQUVYLHlCQUFpQixnQkFBZ0I7QUFHakMsY0FBTSxLQUFLLGtCQUFrQixNQUFNLGNBQWM7QUFHakQsc0JBQWM7QUFHZCx3QkFBZ0IsVUFBVSxPQUFPLGFBQWE7QUFDOUMsb0JBQVksTUFBTSxVQUFVO0FBQzVCLHdCQUFnQixVQUFVLElBQUksYUFBYTtBQUczQyxvQkFBWTtBQUNaLFlBQUksS0FBSyxpQkFBaUIsaUJBQWlCO0FBQ3ZDLGVBQUssZUFBZTtBQUFBLFFBQ3hCO0FBQUEsTUFDSjtBQUFBLElBQ0o7QUFHQSxvQkFBZ0IsaUJBQWlCLFNBQVMsQ0FBQyxVQUFVO0FBQ2pELFlBQU0sU0FBUyxNQUFNO0FBR3JCLFVBQUksT0FBTyxZQUFZLE9BQU8sT0FBTyxRQUFRLEdBQUcsS0FDNUMsT0FBTyxVQUFVLFNBQVMsWUFBWSxLQUFLLE9BQU8sUUFBUSxhQUFhLEdBQUc7QUFDMUU7QUFBQSxNQUNKO0FBRUEsb0JBQWM7QUFBQSxJQUNsQixDQUFDO0FBR0QsZ0JBQVksaUJBQWlCLFNBQVMsTUFBTTtBQUN4QyxtQkFBYTtBQUFBLElBQ2pCLENBQUM7QUFHRCxvQkFBZ0IsaUJBQWlCLFdBQVcsQ0FBQyxVQUFVO0FBQ25ELFVBQUksTUFBTSxRQUFRLFVBQVU7QUFDeEIscUJBQWE7QUFBQSxNQUNqQjtBQUFBLElBQ0osQ0FBQztBQUdELG9CQUFnQixpQkFBaUIsU0FBUyxNQUFNO0FBQzVDLHNCQUFnQixNQUFNLFNBQVM7QUFDL0Isc0JBQWdCLE1BQU0sU0FBUyxnQkFBZ0IsZUFBZTtBQUc5RCx1QkFBaUIsZ0JBQWdCO0FBQUEsSUFDckMsQ0FBQztBQUdELFFBQUksY0FBcUM7QUFDekMsb0JBQWdCLGlCQUFpQixTQUFTLE1BQU07QUFFNUMsb0JBQWMsTUFBTSxVQUFVO0FBQzlCLG9CQUFjLFVBQVUsT0FBTyxPQUFPO0FBQ3RDLG9CQUFjLFVBQVUsSUFBSSxRQUFRO0FBQ3BDLG9CQUFjLGNBQWM7QUFHNUIsVUFBSSxhQUFhO0FBQ2IscUJBQWEsV0FBVztBQUFBLE1BQzVCO0FBR0Esb0JBQWMsV0FBVyxZQUFZO0FBQ2pDLGNBQU0sS0FBSyxrQkFBa0IsTUFBTSxjQUFjO0FBR2pELHNCQUFjLFVBQVUsT0FBTyxRQUFRO0FBQ3ZDLHNCQUFjLFVBQVUsSUFBSSxPQUFPO0FBQ25DLHNCQUFjLGNBQWM7QUFHNUIsbUJBQVcsTUFBTTtBQUNiLGNBQUksY0FBYyxVQUFVLFNBQVMsT0FBTyxHQUFHO0FBQzNDLDBCQUFjLE1BQU0sVUFBVTtBQUFBLFVBQ2xDO0FBQUEsUUFDSixHQUFHLEdBQUk7QUFBQSxNQUNYLEdBQUcsR0FBRztBQUFBLElBQ1YsQ0FBQztBQUdELGlCQUFhLGlCQUFpQixTQUFTLE1BQU07QUFDekMsbUJBQWEsVUFBVSxPQUFPLGlCQUFpQjtBQUMvQyxrQkFBWSxVQUFVLE9BQU8sa0JBQWtCO0FBQUEsSUFDbkQsQ0FBQztBQUFBLEVBQ0w7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLE1BQWMsa0JBQWtCLE1BQWEsU0FBZ0M7QUFDekUsUUFBSTtBQUNBLFlBQU0sS0FBSyxPQUFPLElBQUksTUFBTSxPQUFPLE1BQU0sT0FBTztBQUFBLElBQ3BELFNBQVMsT0FBUDtBQUNFLFVBQUksd0JBQU8sMkJBQTJCLE9BQU87QUFDN0MsY0FBUSxNQUFNLDJCQUEyQixLQUFLO0FBQUEsSUFDbEQ7QUFBQSxFQUNKO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSxvQkFBb0IsVUFBd0I7QUFFeEMsUUFBSSxDQUFDLEtBQUssY0FBYztBQUNwQixVQUFJLHdCQUFPLDZDQUE2QztBQUN4RDtBQUFBLElBQ0o7QUFHQSxVQUFNLE9BQU8sS0FBSyxPQUFPLElBQUksTUFBTSxzQkFBc0IsUUFBUTtBQUNqRSxRQUFJLEVBQUUsZ0JBQWdCLHlCQUFRO0FBQzFCLFVBQUksd0JBQU8sY0FBYztBQUN6QjtBQUFBLElBQ0o7QUFHQSxRQUFJO0FBR0osUUFBSSxLQUFLLFlBQVksSUFBSSxHQUFHO0FBQ3hCLHNCQUFnQixNQUFNLEtBQUs7QUFBQSxJQUMvQixXQUFXLEtBQUssZUFBZSxJQUFJLEdBQUc7QUFDbEMsc0JBQWdCLE1BQU0sS0FBSztBQUFBLElBQy9CLE9BQU87QUFDSCxzQkFBZ0IsTUFBTSxLQUFLO0FBQUEsSUFDL0I7QUFHQSxTQUFLLGFBQWEsTUFBTTtBQUd4QixVQUFNLFlBQVksS0FBSyxhQUFhO0FBQ3BDLFVBQU0sYUFBYSxLQUFLLGFBQWEsTUFBTSxVQUFVLEdBQUcsU0FBUztBQUNqRSxVQUFNLFlBQVksS0FBSyxhQUFhLE1BQU0sVUFBVSxLQUFLLGFBQWEsWUFBWTtBQUdsRixVQUFNLFVBQVUsYUFBYSxTQUFTLGdCQUFnQixTQUFTO0FBQy9ELFNBQUssYUFBYSxRQUFRO0FBRzFCLFVBQU0sZUFBZSxZQUFZLGNBQWMsU0FBUztBQUN4RCxTQUFLLGFBQWEsa0JBQWtCLGNBQWMsWUFBWTtBQUc5RCxVQUFNLGFBQWEsSUFBSSxNQUFNLFNBQVMsRUFBRSxTQUFTLE1BQU0sWUFBWSxLQUFLLENBQUM7QUFDekUsU0FBSyxhQUFhLGNBQWMsVUFBVTtBQUUxQyxRQUFJLHdCQUFPLHlCQUF5QixLQUFLLE1BQU07QUFBQSxFQUNuRDtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS1EsWUFBWSxNQUFzQjtBQUN0QyxVQUFNLGtCQUFrQixDQUFDLE9BQU8sT0FBTyxRQUFRLE9BQU8sT0FBTyxNQUFNO0FBQ25FLFVBQU0sTUFBTSxLQUFLLFVBQVUsWUFBWTtBQUN2QyxXQUFPLGdCQUFnQixTQUFTLEdBQUc7QUFBQSxFQUN2QztBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS1EsZUFBZSxNQUFzQjtBQUN6QyxVQUFNLE1BQU0sS0FBSyxVQUFVLFlBQVk7QUFDdkMsV0FBTyxRQUFRLFFBQVEsUUFBUTtBQUFBLEVBQ25DO0FBQUEsRUFFUSxrQkFBd0I7QUFFNUIsU0FBSyxPQUFPO0FBQUEsTUFDUixLQUFLLE9BQU8sSUFBSSxVQUFVLEdBQUcsaUJBQWlCLE1BQU07QUFFaEQsWUFBSSxLQUFLLGNBQWM7QUFFbkIsZ0JBQU0sZUFBZSxLQUFLLGFBQWEsUUFBUSxnQkFBZ0I7QUFDL0QsY0FBSSxjQUFjO0FBRWQsa0JBQU0sUUFBUSxJQUFJLGNBQWMsV0FBVyxFQUFFLEtBQUssU0FBUyxDQUFDO0FBQzVELGlCQUFLLGFBQWEsY0FBYyxLQUFLO0FBQUEsVUFDekM7QUFHQSxlQUFLLGVBQWU7QUFBQSxRQUN4QjtBQUFBLE1BQ0osQ0FBQztBQUFBLElBQ0w7QUFBQSxFQUNKO0FBQ0o7OztBRmxiQSxJQUFxQixtQkFBckIsY0FBOEMsd0JBQU87QUFBQSxFQUlqRCxNQUFNLFNBQVM7QUFFWCxVQUFNLEtBQUssYUFBYTtBQUd4QixTQUFLLGNBQWMsSUFBSSxZQUFZLElBQUk7QUFHdkMsVUFBTSxlQUFlLEtBQUs7QUFBQSxNQUN0QjtBQUFBLE1BQ0E7QUFBQSxNQUNBLE9BQU8sUUFBb0I7QUFDdkIsY0FBTSxLQUFLLGdCQUFnQjtBQUFBLE1BQy9CO0FBQUEsSUFDSjtBQUNBLGlCQUFhLFNBQVMsd0JBQXdCO0FBRzlDLFNBQUssV0FBVztBQUFBLE1BQ1osSUFBSTtBQUFBLE1BQ0osTUFBTTtBQUFBLE1BQ04sVUFBVSxNQUFNO0FBQ1osYUFBSyxnQkFBZ0I7QUFBQSxNQUN6QjtBQUFBLElBQ0osQ0FBQztBQUdELFNBQUssV0FBVztBQUFBLE1BQ1osSUFBSTtBQUFBLE1BQ0osTUFBTTtBQUFBLE1BQ04sVUFBVSxNQUFNO0FBQ1osYUFBSyxvQkFBb0I7QUFBQSxNQUM3QjtBQUFBLElBQ0osQ0FBQztBQUdELFNBQUssY0FBYyxJQUFJLHFCQUFxQixLQUFLLEtBQUssSUFBSSxDQUFDO0FBRzNELFNBQUs7QUFBQSxNQUNELEtBQUssSUFBSSxVQUFVLEdBQUcsYUFBYSxDQUFDLE1BQU0sU0FBUztBQUUvQyxZQUFJLGdCQUFnQix3QkFBTztBQUN2QixlQUFLLFFBQVEsQ0FBQyxTQUFTO0FBQ25CLGlCQUNLLFNBQVMscUJBQXFCLEVBQzlCLFFBQVEsbUJBQW1CLEVBQzNCLFFBQVEsTUFBTTtBQUVYLG9CQUFNLGNBQWMsS0FBSztBQUN6QixrQkFBSSxhQUFhO0FBRWIsNEJBQVksb0JBQW9CLEtBQUssSUFBSTtBQUFBLGNBQzdDLE9BQU87QUFDSCxvQkFBSSx3QkFBTyxzREFBc0Q7QUFBQSxjQUNyRTtBQUFBLFlBQ0osQ0FBQztBQUFBLFVBQ1QsQ0FBQztBQUFBLFFBQ0w7QUFBQSxNQUNKLENBQUM7QUFBQSxJQUNMO0FBQUEsRUFDSjtBQUFBO0FBQUEsRUFHQSxNQUFNLGtCQUFpQztBQUVuQyxVQUFNLEtBQUssb0JBQW9CO0FBRy9CLFVBQU0sS0FBSyxZQUFZLEtBQUs7QUFBQSxFQUNoQztBQUFBO0FBQUEsRUFHQSxNQUFNLHNCQUFxQztBQUN2QyxVQUFNLE9BQU8sYUFBYTtBQUMxQixVQUFNLFdBQVcsR0FBRztBQUVwQixVQUFNLE9BQU8sTUFBTTtBQUFBLE1BQ2YsS0FBSztBQUFBLE1BQ0wsS0FBSyxTQUFTO0FBQUEsTUFDZDtBQUFBLE1BQ0EsS0FBSyxTQUFTO0FBQUE7QUFBQSxJQUNsQjtBQUVBLFFBQUksQ0FBQyxNQUFNO0FBQ1AsVUFBSSx3QkFBTywwQ0FBMkM7QUFDdEQ7QUFBQSxJQUNKO0FBQUEsRUFDSjtBQUFBLEVBRUEsTUFBTSxlQUFlO0FBQ2pCLFNBQUssV0FBVyxPQUFPLE9BQU8sQ0FBQyxHQUFHLGtCQUFrQixNQUFNLEtBQUssU0FBUyxDQUFDO0FBQUEsRUFDN0U7QUFBQSxFQUVBLE1BQU0sZUFBZTtBQUNqQixVQUFNLEtBQUssU0FBUyxLQUFLLFFBQVE7QUFBQSxFQUNyQztBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS0EsTUFBTSx3QkFBdUM7QUFDekMsVUFBTSxlQUFlO0FBQUEsTUFDakIsS0FBSztBQUFBLE1BQ0wsS0FBSyxTQUFTO0FBQUEsTUFDZDtBQUFBO0FBQUEsSUFDSjtBQUVBLFFBQUksYUFBYSxXQUFXLEdBQUc7QUFDM0IsVUFBSSx3QkFBTyxzQ0FBc0M7QUFDakQ7QUFBQSxJQUNKO0FBR0EsUUFBSSxDQUFDLEtBQUssU0FBUyxjQUFjO0FBQzdCLFVBQUksd0JBQU8sMERBQTBEO0FBQ3JFO0FBQUEsSUFDSjtBQUdBLFVBQU0saUJBQWlCLFdBQVcsYUFBYTtBQUFBLHFEQUNGLEtBQUssU0FBUztBQUFBO0FBQUE7QUFBQTtBQUFBO0FBTTNELFFBQUksQ0FBQyxRQUFRLGNBQWMsR0FBRztBQUMxQjtBQUFBLElBQ0o7QUFHQSxVQUFNLFFBQVEsSUFBSSxlQUFlLEtBQUssS0FBSyxhQUFhLE1BQU07QUFDOUQsVUFBTSxLQUFLO0FBR1gsUUFBSSxnQkFBZ0I7QUFDcEIsUUFBSSxhQUFhO0FBRWpCLGVBQVcsUUFBUSxjQUFjO0FBQzdCLFVBQUk7QUFFQSxjQUFNLGFBQWEsYUFBYSxLQUFLLFNBQVM7QUFHOUMsY0FBTSxVQUFVO0FBQUEsVUFDWixLQUFLLFNBQVM7QUFBQSxVQUNkLEtBQUs7QUFBQSxVQUNMLEtBQUssU0FBUztBQUFBLFFBQ2xCO0FBR0EsWUFBSSxLQUFLLFNBQVMsU0FBUztBQUN2QjtBQUNBLGdCQUFNLGVBQWUsYUFBYTtBQUNsQztBQUFBLFFBQ0o7QUFHQSxjQUFNLFVBQVUsTUFBTSxLQUFLLElBQUksTUFBTSxLQUFLLElBQUk7QUFHOUMsY0FBTSxpQkFBaUIsS0FBSyxLQUFLLE9BQU87QUFHeEMsY0FBTSxLQUFLLElBQUksTUFBTSxPQUFPLFNBQVMsT0FBTztBQUc1QyxjQUFNLEtBQUssSUFBSSxNQUFNLE9BQU8sSUFBSTtBQUVoQztBQUNBLGNBQU0sZUFBZSxhQUFhO0FBQUEsTUFDdEMsU0FBUyxPQUFQO0FBQ0UsZ0JBQVEsTUFBTSx3QkFBd0IsS0FBSyxTQUFTLEtBQUs7QUFDekQsY0FBTSxhQUFhLG1CQUFtQixLQUFLLFNBQVMsT0FBTztBQUMzRDtBQUFBLE1BQ0o7QUFBQSxJQUNKO0FBR0EsVUFBTSxhQUFhLGdDQUFnQyw0QkFBNEIsb0JBQW9CO0FBR25HLGVBQVcsTUFBTTtBQUNiLFlBQU0sTUFBTTtBQUNaLFVBQUksd0JBQU8sZ0NBQWdDLDRCQUE0QixvQkFBb0I7QUFBQSxJQUMvRixHQUFHLEdBQUk7QUFBQSxFQUNYO0FBQ0o7QUFFQSxJQUFNLGlCQUFOLGNBQTZCLHVCQUFNO0FBQUEsRUFLL0IsWUFBWSxLQUFVLFlBQW9CO0FBQ3RDLFVBQU0sR0FBRztBQUNULFNBQUssYUFBYTtBQUFBLEVBQ3RCO0FBQUEsRUFFQSxTQUFTO0FBQ0wsVUFBTSxFQUFFLFVBQVUsSUFBSTtBQUN0QixjQUFVLFNBQVMsTUFBTSxFQUFFLE1BQU0sNEJBQTRCLENBQUM7QUFHOUQsU0FBSyxhQUFhLFVBQVUsU0FBUyxPQUFPO0FBQUEsTUFDeEMsS0FBSztBQUFBLE1BQ0wsTUFBTSxPQUFPLEtBQUs7QUFBQSxJQUN0QixDQUFDO0FBR0QsU0FBSyxXQUFXLFVBQVUsU0FBUyxPQUFPO0FBQUEsTUFDdEMsS0FBSztBQUFBLE1BQ0wsTUFBTTtBQUFBLElBQ1YsQ0FBQztBQUFBLEVBQ0w7QUFBQSxFQUVBLGVBQWUsV0FBbUI7QUFDOUIsU0FBSyxXQUFXLGNBQWMsR0FBRyxhQUFhLEtBQUs7QUFBQSxFQUN2RDtBQUFBLEVBRUEsYUFBYSxTQUFpQjtBQUMxQixTQUFLLFNBQVMsY0FBYztBQUFBLEVBQ2hDO0FBQUEsRUFFQSxVQUFVO0FBQ04sVUFBTSxFQUFFLFVBQVUsSUFBSTtBQUN0QixjQUFVLE1BQU07QUFBQSxFQUNwQjtBQUNKOyIsCiAgIm5hbWVzIjogWyJpbXBvcnRfb2JzaWRpYW4iLCAiaW1wb3J0X29ic2lkaWFuIiwgImltcG9ydF9vYnNpZGlhbiJdCn0K
