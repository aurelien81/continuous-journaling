/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// src/main.ts
var main_exports = {};
__export(main_exports, {
  default: () => JournalingPlugin
});
module.exports = __toCommonJS(main_exports);
var import_obsidian4 = require("obsidian");

// src/settings.ts
var import_obsidian = require("obsidian");
var DEFAULT_SETTINGS = {
  journalFolder: "journals",
  dateFormat: "YYYY-MM-DD",
  sortDirection: "newest-first",
  defaultExpandEntries: true
};
var JournalingSettingTab = class extends import_obsidian.PluginSettingTab {
  constructor(app, plugin) {
    super(app, plugin);
    this.plugin = plugin;
  }
  display() {
    const { containerEl } = this;
    containerEl.empty();
    containerEl.createEl("h2", { text: "Continuous Journaling Settings" });
    new import_obsidian.Setting(containerEl).setName("Journal Folder").setDesc("Specify the folder where journal entries will be stored").addText((text) => text.setPlaceholder("journals").setValue(this.plugin.settings.journalFolder).onChange(async (value) => {
      this.plugin.settings.journalFolder = value.replace(/^\/+|\/+$/g, "");
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(containerEl).setName("Date Format").setDesc("Format for journal filenames (YYYY-MM-DD recommended)").addText((text) => text.setPlaceholder("YYYY-MM-DD").setValue(this.plugin.settings.dateFormat).onChange(async (value) => {
      this.plugin.settings.dateFormat = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(containerEl).setName("Sort Direction").setDesc("How to sort journal entries in the continuous view").addDropdown((dropdown) => dropdown.addOption("newest-first", "Newest entries first").addOption("oldest-first", "Oldest entries first").setValue(this.plugin.settings.sortDirection).onChange(async (value) => {
      this.plugin.settings.sortDirection = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(containerEl).setName("Default Expand Entries").setDesc("Automatically expand entries when opening the journals view").addToggle((toggle) => toggle.setValue(this.plugin.settings.defaultExpandEntries).onChange(async (value) => {
      this.plugin.settings.defaultExpandEntries = value;
      await this.plugin.saveSettings();
    }));
  }
};

// src/journal-view.ts
var import_obsidian3 = require("obsidian");

// src/utils/date-utils.ts
function getTodayDate() {
  const today = new Date();
  return formatDateString(today);
}
function formatDateString(date) {
  const year = date.getFullYear();
  const month = String(date.getMonth() + 1).padStart(2, "0");
  const day = String(date.getDate()).padStart(2, "0");
  return `${year}-${month}-${day}`;
}
function formatDateForDisplay(dateString) {
  const date = new Date(dateString);
  const dateFormatOptions = {
    month: "short",
    year: "numeric",
    day: "numeric"
  };
  const formattedDate = new Intl.DateTimeFormat("en-US", dateFormatOptions).format(date);
  const day = date.getDate();
  const daySuffix = getDaySuffix(day);
  const parts = formattedDate.split(" ");
  return `${parts[0]} ${day}${daySuffix}, ${parts[2]}`;
}
function getDaySuffix(day) {
  if (day > 3 && day < 21)
    return "th";
  switch (day % 10) {
    case 1:
      return "st";
    case 2:
      return "nd";
    case 3:
      return "rd";
    default:
      return "th";
  }
}
function isDateFormat(text) {
  return /^\d{4}-\d{2}-\d{2}$/.test(text);
}

// src/utils/file-utils.ts
var import_obsidian2 = require("obsidian");
async function ensureFolder(app, folderPath) {
  if (!folderPath) {
    return true;
  }
  const folderExists = app.vault.getAbstractFileByPath(folderPath);
  if (folderExists && !(folderExists instanceof import_obsidian2.TFolder)) {
    new import_obsidian2.Notice(`Cannot create journal folder: "${folderPath}" exists but is not a folder`);
    return false;
  }
  if (!folderExists) {
    try {
      await app.vault.createFolder(folderPath);
      new import_obsidian2.Notice(`Created journal folder: ${folderPath}`);
      return true;
    } catch (error) {
      new import_obsidian2.Notice(`Failed to create journal folder: ${error}`);
      console.error("Failed to create journal folder:", error);
      return false;
    }
  }
  return true;
}
function getFilePath(folder, filename) {
  if (folder) {
    return `${folder}/${filename}`;
  }
  return filename;
}
function isJournalFile(file, journalFolder) {
  const isDateBasename = isDateFormat(file.basename);
  if (journalFolder) {
    return isDateBasename && file.path.startsWith(journalFolder + "/");
  }
  return isDateBasename;
}
function getJournalFiles(app, journalFolder) {
  const files = app.vault.getMarkdownFiles();
  return files.filter((file) => isJournalFile(file, journalFolder));
}
function sortJournalFiles(files, sortDirection) {
  return files.sort((a, b) => {
    if (sortDirection === "newest-first") {
      return b.basename.localeCompare(a.basename);
    } else {
      return a.basename.localeCompare(b.basename);
    }
  });
}
async function getOrCreateJournalFile(app, journalFolder, filename, initialContent = "") {
  await ensureFolder(app, journalFolder);
  const filePath = getFilePath(journalFolder, filename);
  let file = app.vault.getAbstractFileByPath(filePath);
  if (file instanceof import_obsidian2.TFile) {
    return file;
  }
  try {
    file = await app.vault.create(filePath, initialContent);
    new import_obsidian2.Notice(`Created journal entry: ${filename}`);
    return file;
  } catch (error) {
    new import_obsidian2.Notice(`Failed to create journal entry: ${error}`);
    console.error("Failed to create journal entry:", error);
    return null;
  }
}

// src/journal-view.ts
var JournalView = class {
  constructor(plugin) {
    this.plugin = plugin;
  }
  /**
   * Opens the continuous journal view in a new leaf
   */
  async open() {
    const leaf = this.plugin.app.workspace.getLeaf(true);
    await leaf.setViewState({
      type: "markdown",
      active: true
    });
    const contentEl = leaf.view.containerEl;
    contentEl.empty();
    const panel = contentEl.createDiv({ cls: "custom-journal-panel" });
    const journalFiles = getJournalFiles(this.plugin.app, this.plugin.settings.journalFolder);
    if (journalFiles.length === 0) {
      new import_obsidian3.Notice("No journal entries found.");
      panel.createEl("div", {
        cls: "journal-empty-state",
        text: "No journal entries found. Create one by clicking the journals icon in the ribbon."
      });
      return;
    }
    const sortedFiles = sortJournalFiles(journalFiles, this.plugin.settings.sortDirection);
    for (const file of sortedFiles) {
      try {
        const fileContent = await this.plugin.app.vault.read(file);
        this.addJournalEntry(panel, file, fileContent);
      } catch (error) {
        console.error(`Error reading file ${file.path}:`, error);
        this.addErrorMessage(panel, file.basename, error);
      }
    }
  }
  /**
   * Adds an error message to the panel when file reading fails
   */
  addErrorMessage(panel, filename, error) {
    const errorDiv = panel.createDiv({ cls: "journal-entry journal-error" });
    const errorHeader = errorDiv.createDiv({ cls: "journal-entry-header" });
    errorHeader.createEl("h3", {
      cls: "journal-entry-title",
      text: `${filename} - Error`
    });
    const errorContent = errorDiv.createDiv({ cls: "journal-error-content" });
    errorContent.textContent = `Failed to load journal: ${error.message || error}`;
  }
  /**
   * Adds a journal entry to the panel
   */
  addJournalEntry(panel, file, content) {
    const journalDate = file.basename;
    const journalEntry = panel.createDiv({ cls: "journal-entry" });
    const header = journalEntry.createDiv({ cls: "journal-entry-header" });
    const toggleButton = header.createEl("button", { cls: "collapsible-toggle" });
    if (this.plugin.settings.defaultExpandEntries) {
      toggleButton.addClass("toggle-expanded");
    }
    const title = header.createEl("h3", { cls: "journal-entry-title" });
    const titleLink = title.createEl("a", {
      cls: "journal-entry-link",
      text: formatDateForDisplay(journalDate)
    });
    titleLink.addEventListener("click", (event) => {
      event.preventDefault();
      this.plugin.app.workspace.openLinkText(file.basename, file.path);
    });
    const contentArea = journalEntry.createDiv({
      cls: "collapsible-content" + (this.plugin.settings.defaultExpandEntries ? " content-expanded" : "")
    });
    let currentContent = content;
    const renderedContent = contentArea.createDiv({
      cls: "rendered-content active-view"
    });
    const editableContent = contentArea.createEl("textarea", {
      cls: "editable-content",
      value: currentContent
    });
    window.requestAnimationFrame(() => {
      editableContent.style.height = editableContent.scrollHeight + "px";
    });
    const renderContent = () => {
      renderedContent.empty();
      import_obsidian3.MarkdownRenderer.render(this.plugin.app, currentContent, renderedContent, file.path, this.plugin);
    };
    renderContent();
    const enterEditMode = () => {
      editableContent.value = currentContent;
      renderedContent.classList.toggle("active-view");
      editableContent.classList.toggle("active-view");
      editableContent.style.height = "auto";
      editableContent.style.height = editableContent.scrollHeight + "px";
      editableContent.focus();
    };
    renderedContent.addEventListener("click", (event) => {
      const target = event.target;
      if (target.tagName === "A" || target.closest("a") || target.classList.contains("cm-hashtag") || target.closest(".cm-hashtag")) {
        return;
      }
      enterEditMode();
    });
    editableContent.addEventListener("blur", async () => {
      currentContent = editableContent.value;
      await this.saveContentToFile(file, currentContent);
      renderContent();
      renderedContent.classList.toggle("active-view");
      editableContent.classList.toggle("active-view");
    });
    editableContent.addEventListener("input", () => {
      editableContent.style.height = "auto";
      editableContent.style.height = editableContent.scrollHeight + "px";
      currentContent = editableContent.value;
    });
    let saveTimeout = null;
    editableContent.addEventListener("input", () => {
      if (saveTimeout) {
        clearTimeout(saveTimeout);
      }
      saveTimeout = setTimeout(() => {
        this.saveContentToFile(file, currentContent);
      }, 500);
    });
    toggleButton.addEventListener("click", () => {
      toggleButton.classList.toggle("toggle-expanded");
      contentArea.classList.toggle("content-expanded");
    });
  }
  /**
   * Saves the content to the file
   */
  async saveContentToFile(file, content) {
    try {
      await this.plugin.app.vault.modify(file, content);
    } catch (error) {
      new import_obsidian3.Notice(`Failed to save changes: ${error}`);
      console.error("Failed to save changes:", error);
    }
  }
};

// src/main.ts
var JournalingPlugin = class extends import_obsidian4.Plugin {
  async onload() {
    await this.loadSettings();
    this.journalView = new JournalView(this);
    const ribbonIconEl = this.addRibbonIcon(
      "notebook-text",
      "Open Journals",
      async (evt) => {
        await this.openJournalView();
      }
    );
    ribbonIconEl.addClass("journaling-ribbon-icon");
    this.addCommand({
      id: "open-journal-view",
      name: "Open Journal View",
      callback: () => {
        this.openJournalView();
      }
    });
    this.addCommand({
      id: "create-todays-journal",
      name: "Create/Open Today's Journal",
      callback: () => {
        this.createTodaysJournal();
      }
    });
    this.addSettingTab(new JournalingSettingTab(this.app, this));
  }
  /**
   * Opens the continuous journal view
   */
  async openJournalView() {
    await this.createTodaysJournal();
    await this.journalView.open();
  }
  /**
   * Creates or opens today's journal entry
   */
  async createTodaysJournal() {
    const date = getTodayDate();
    const fileName = `${date}.md`;
    const file = await getOrCreateJournalFile(
      this.app,
      this.settings.journalFolder,
      fileName
    );
    if (!file) {
      new import_obsidian4.Notice("Failed to create or open today's journal");
      return;
    }
  }
  async loadSettings() {
    this.settings = Object.assign({}, DEFAULT_SETTINGS, await this.loadData());
  }
  async saveSettings() {
    await this.saveData(this.settings);
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsic3JjL21haW4udHMiLCAic3JjL3NldHRpbmdzLnRzIiwgInNyYy9qb3VybmFsLXZpZXcudHMiLCAic3JjL3V0aWxzL2RhdGUtdXRpbHMudHMiLCAic3JjL3V0aWxzL2ZpbGUtdXRpbHMudHMiXSwKICAic291cmNlc0NvbnRlbnQiOiBbImltcG9ydCB7IFBsdWdpbiwgTm90aWNlIH0gZnJvbSAnb2JzaWRpYW4nO1xuaW1wb3J0IHsgREVGQVVMVF9TRVRUSU5HUywgSm91cm5hbGluZ1NldHRpbmdzLCBKb3VybmFsaW5nU2V0dGluZ1RhYiB9IGZyb20gJy4vc2V0dGluZ3MnO1xuaW1wb3J0IHsgSm91cm5hbFZpZXcgfSBmcm9tICcuL2pvdXJuYWwtdmlldyc7XG5pbXBvcnQgeyBnZXRUb2RheURhdGUgfSBmcm9tICcuL3V0aWxzL2RhdGUtdXRpbHMnO1xuaW1wb3J0IHsgZ2V0T3JDcmVhdGVKb3VybmFsRmlsZSB9IGZyb20gJy4vdXRpbHMvZmlsZS11dGlscyc7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEpvdXJuYWxpbmdQbHVnaW4gZXh0ZW5kcyBQbHVnaW4ge1xuICAgIHNldHRpbmdzOiBKb3VybmFsaW5nU2V0dGluZ3M7XG4gICAgam91cm5hbFZpZXc6IEpvdXJuYWxWaWV3O1xuXG4gICAgYXN5bmMgb25sb2FkKCkge1xuICAgICAgICAvLyBMb2FkIHNldHRpbmdzXG4gICAgICAgIGF3YWl0IHRoaXMubG9hZFNldHRpbmdzKCk7XG4gICAgICAgIFxuICAgICAgICAvLyBJbml0aWFsaXplIGpvdXJuYWwgdmlld1xuICAgICAgICB0aGlzLmpvdXJuYWxWaWV3ID0gbmV3IEpvdXJuYWxWaWV3KHRoaXMpO1xuICAgICAgICBcbiAgICAgICAgLy8gQWRkIHJpYmJvbiBpY29uXG4gICAgICAgIGNvbnN0IHJpYmJvbkljb25FbCA9IHRoaXMuYWRkUmliYm9uSWNvbihcbiAgICAgICAgICAgICdub3RlYm9vay10ZXh0JywgXG4gICAgICAgICAgICAnT3BlbiBKb3VybmFscycsIFxuICAgICAgICAgICAgYXN5bmMgKGV2dDogTW91c2VFdmVudCkgPT4ge1xuICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMub3BlbkpvdXJuYWxWaWV3KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICk7XG4gICAgICAgIHJpYmJvbkljb25FbC5hZGRDbGFzcygnam91cm5hbGluZy1yaWJib24taWNvbicpO1xuICAgICAgICBcbiAgICAgICAgLy8gQWRkIGNvbW1hbmRcbiAgICAgICAgdGhpcy5hZGRDb21tYW5kKHtcbiAgICAgICAgICAgIGlkOiAnb3Blbi1qb3VybmFsLXZpZXcnLFxuICAgICAgICAgICAgbmFtZTogJ09wZW4gSm91cm5hbCBWaWV3JyxcbiAgICAgICAgICAgIGNhbGxiYWNrOiAoKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5vcGVuSm91cm5hbFZpZXcoKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH0pO1xuICAgICAgICBcbiAgICAgICAgLy8gQWRkIGFub3RoZXIgY29tbWFuZCBzcGVjaWZpY2FsbHkgZm9yIGNyZWF0aW5nIHRvZGF5J3Mgam91cm5hbFxuICAgICAgICB0aGlzLmFkZENvbW1hbmQoe1xuICAgICAgICAgICAgaWQ6ICdjcmVhdGUtdG9kYXlzLWpvdXJuYWwnLFxuICAgICAgICAgICAgbmFtZTogJ0NyZWF0ZS9PcGVuIFRvZGF5XFwncyBKb3VybmFsJyxcbiAgICAgICAgICAgIGNhbGxiYWNrOiAoKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5jcmVhdGVUb2RheXNKb3VybmFsKCk7XG4gICAgICAgICAgICB9LFxuICAgICAgICB9KTtcbiAgICAgICAgXG4gICAgICAgIC8vIFJlZ2lzdGVyIHNldHRpbmdzIHRhYlxuICAgICAgICB0aGlzLmFkZFNldHRpbmdUYWIobmV3IEpvdXJuYWxpbmdTZXR0aW5nVGFiKHRoaXMuYXBwLCB0aGlzKSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogT3BlbnMgdGhlIGNvbnRpbnVvdXMgam91cm5hbCB2aWV3XG4gICAgICovXG4gICAgYXN5bmMgb3BlbkpvdXJuYWxWaWV3KCk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICAvLyBGaXJzdCwgZW5zdXJlIHRvZGF5J3Mgam91cm5hbCBleGlzdHNcbiAgICAgICAgYXdhaXQgdGhpcy5jcmVhdGVUb2RheXNKb3VybmFsKCk7XG4gICAgICAgIFxuICAgICAgICAvLyBUaGVuIG9wZW4gdGhlIGNvbnRpbnVvdXMgdmlld1xuICAgICAgICBhd2FpdCB0aGlzLmpvdXJuYWxWaWV3Lm9wZW4oKTtcbiAgICB9XG4gICAgXG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBvciBvcGVucyB0b2RheSdzIGpvdXJuYWwgZW50cnlcbiAgICAgKi9cbiAgICBhc3luYyBjcmVhdGVUb2RheXNKb3VybmFsKCk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBjb25zdCBkYXRlID0gZ2V0VG9kYXlEYXRlKCk7XG4gICAgICAgIGNvbnN0IGZpbGVOYW1lID0gYCR7ZGF0ZX0ubWRgO1xuICAgICAgICBcbiAgICAgICAgY29uc3QgZmlsZSA9IGF3YWl0IGdldE9yQ3JlYXRlSm91cm5hbEZpbGUoXG4gICAgICAgICAgICB0aGlzLmFwcCwgXG4gICAgICAgICAgICB0aGlzLnNldHRpbmdzLmpvdXJuYWxGb2xkZXIsIFxuICAgICAgICAgICAgZmlsZU5hbWVcbiAgICAgICAgKTtcbiAgICAgICAgXG4gICAgICAgIGlmICghZmlsZSkge1xuICAgICAgICAgICAgbmV3IE5vdGljZSgnRmFpbGVkIHRvIGNyZWF0ZSBvciBvcGVuIHRvZGF5XFwncyBqb3VybmFsJyk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICB9XG4gICAgXG4gICAgYXN5bmMgbG9hZFNldHRpbmdzKCkge1xuICAgICAgICB0aGlzLnNldHRpbmdzID0gT2JqZWN0LmFzc2lnbih7fSwgREVGQVVMVF9TRVRUSU5HUywgYXdhaXQgdGhpcy5sb2FkRGF0YSgpKTtcbiAgICB9XG5cbiAgICBhc3luYyBzYXZlU2V0dGluZ3MoKSB7XG4gICAgICAgIGF3YWl0IHRoaXMuc2F2ZURhdGEodGhpcy5zZXR0aW5ncyk7XG4gICAgfVxufSIsICJpbXBvcnQgeyBBcHAsIFBsdWdpblNldHRpbmdUYWIsIFNldHRpbmcgfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgSm91cm5hbGluZ1BsdWdpbiBmcm9tICcuL21haW4nO1xuXG5leHBvcnQgaW50ZXJmYWNlIEpvdXJuYWxpbmdTZXR0aW5ncyB7XG4gICAgam91cm5hbEZvbGRlcjogc3RyaW5nO1xuICAgIGRhdGVGb3JtYXQ6IHN0cmluZztcbiAgICBzb3J0RGlyZWN0aW9uOiAnbmV3ZXN0LWZpcnN0JyB8ICdvbGRlc3QtZmlyc3QnO1xuICAgIGRlZmF1bHRFeHBhbmRFbnRyaWVzOiBib29sZWFuO1xufVxuXG5leHBvcnQgY29uc3QgREVGQVVMVF9TRVRUSU5HUzogSm91cm5hbGluZ1NldHRpbmdzID0ge1xuICAgIGpvdXJuYWxGb2xkZXI6ICdqb3VybmFscycsXG4gICAgZGF0ZUZvcm1hdDogJ1lZWVktTU0tREQnLFxuICAgIHNvcnREaXJlY3Rpb246ICduZXdlc3QtZmlyc3QnLFxuICAgIGRlZmF1bHRFeHBhbmRFbnRyaWVzOiB0cnVlLFxufTtcblxuZXhwb3J0IGNsYXNzIEpvdXJuYWxpbmdTZXR0aW5nVGFiIGV4dGVuZHMgUGx1Z2luU2V0dGluZ1RhYiB7XG4gICAgcGx1Z2luOiBKb3VybmFsaW5nUGx1Z2luO1xuXG4gICAgY29uc3RydWN0b3IoYXBwOiBBcHAsIHBsdWdpbjogSm91cm5hbGluZ1BsdWdpbikge1xuICAgICAgICBzdXBlcihhcHAsIHBsdWdpbik7XG4gICAgICAgIHRoaXMucGx1Z2luID0gcGx1Z2luO1xuICAgIH1cblxuICAgIGRpc3BsYXkoKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IHsgY29udGFpbmVyRWwgfSA9IHRoaXM7XG4gICAgICAgIGNvbnRhaW5lckVsLmVtcHR5KCk7XG5cbiAgICAgICAgY29udGFpbmVyRWwuY3JlYXRlRWwoJ2gyJywgeyB0ZXh0OiAnQ29udGludW91cyBKb3VybmFsaW5nIFNldHRpbmdzJyB9KTtcblxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcbiAgICAgICAgICAgIC5zZXROYW1lKCdKb3VybmFsIEZvbGRlcicpXG4gICAgICAgICAgICAuc2V0RGVzYygnU3BlY2lmeSB0aGUgZm9sZGVyIHdoZXJlIGpvdXJuYWwgZW50cmllcyB3aWxsIGJlIHN0b3JlZCcpXG4gICAgICAgICAgICAuYWRkVGV4dCh0ZXh0ID0+IHRleHRcbiAgICAgICAgICAgICAgICAuc2V0UGxhY2Vob2xkZXIoJ2pvdXJuYWxzJylcbiAgICAgICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3Muam91cm5hbEZvbGRlcilcbiAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIC8vIFJlbW92ZSBsZWFkaW5nIGFuZCB0cmFpbGluZyBzbGFzaGVzIGZvciBjb25zaXN0ZW5jeVxuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5qb3VybmFsRm9sZGVyID0gdmFsdWUucmVwbGFjZSgvXlxcLyt8XFwvKyQvZywgJycpO1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICB9KSk7XG5cbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAgICAgICAuc2V0TmFtZSgnRGF0ZSBGb3JtYXQnKVxuICAgICAgICAgICAgLnNldERlc2MoJ0Zvcm1hdCBmb3Igam91cm5hbCBmaWxlbmFtZXMgKFlZWVktTU0tREQgcmVjb21tZW5kZWQpJylcbiAgICAgICAgICAgIC5hZGRUZXh0KHRleHQgPT4gdGV4dFxuICAgICAgICAgICAgICAgIC5zZXRQbGFjZWhvbGRlcignWVlZWS1NTS1ERCcpXG4gICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmRhdGVGb3JtYXQpXG4gICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5kYXRlRm9ybWF0ID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgIH0pKTtcblxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcbiAgICAgICAgICAgIC5zZXROYW1lKCdTb3J0IERpcmVjdGlvbicpXG4gICAgICAgICAgICAuc2V0RGVzYygnSG93IHRvIHNvcnQgam91cm5hbCBlbnRyaWVzIGluIHRoZSBjb250aW51b3VzIHZpZXcnKVxuICAgICAgICAgICAgLmFkZERyb3Bkb3duKGRyb3Bkb3duID0+IGRyb3Bkb3duXG4gICAgICAgICAgICAgICAgLmFkZE9wdGlvbignbmV3ZXN0LWZpcnN0JywgJ05ld2VzdCBlbnRyaWVzIGZpcnN0JylcbiAgICAgICAgICAgICAgICAuYWRkT3B0aW9uKCdvbGRlc3QtZmlyc3QnLCAnT2xkZXN0IGVudHJpZXMgZmlyc3QnKVxuICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5zb3J0RGlyZWN0aW9uKVxuICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWU6ICduZXdlc3QtZmlyc3QnIHwgJ29sZGVzdC1maXJzdCcpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3Muc29ydERpcmVjdGlvbiA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICB9KSk7XG5cbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAgICAgICAuc2V0TmFtZSgnRGVmYXVsdCBFeHBhbmQgRW50cmllcycpXG4gICAgICAgICAgICAuc2V0RGVzYygnQXV0b21hdGljYWxseSBleHBhbmQgZW50cmllcyB3aGVuIG9wZW5pbmcgdGhlIGpvdXJuYWxzIHZpZXcnKVxuICAgICAgICAgICAgLmFkZFRvZ2dsZSh0b2dnbGUgPT4gdG9nZ2xlXG4gICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmRlZmF1bHRFeHBhbmRFbnRyaWVzKVxuICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuZGVmYXVsdEV4cGFuZEVudHJpZXMgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgfSkpO1xuICAgIH1cbn0iLCAiaW1wb3J0IHsgTWFya2Rvd25SZW5kZXJlciwgTm90aWNlLCBURmlsZSwgV29ya3NwYWNlTGVhZiB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCBKb3VybmFsaW5nUGx1Z2luIGZyb20gJy4vbWFpbic7XG5pbXBvcnQgeyBmb3JtYXREYXRlRm9yRGlzcGxheSB9IGZyb20gJy4vdXRpbHMvZGF0ZS11dGlscyc7XG5pbXBvcnQgeyBnZXRKb3VybmFsRmlsZXMsIHNvcnRKb3VybmFsRmlsZXMgfSBmcm9tICcuL3V0aWxzL2ZpbGUtdXRpbHMnO1xuXG5leHBvcnQgY2xhc3MgSm91cm5hbFZpZXcge1xuICAgIHBsdWdpbjogSm91cm5hbGluZ1BsdWdpbjtcbiAgICBcbiAgICBjb25zdHJ1Y3RvcihwbHVnaW46IEpvdXJuYWxpbmdQbHVnaW4pIHtcbiAgICAgICAgdGhpcy5wbHVnaW4gPSBwbHVnaW47XG4gICAgfVxuICAgIFxuICAgIC8qKlxuICAgICAqIE9wZW5zIHRoZSBjb250aW51b3VzIGpvdXJuYWwgdmlldyBpbiBhIG5ldyBsZWFmXG4gICAgICovXG4gICAgYXN5bmMgb3BlbigpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgLy8gQ3JlYXRlIGEgbmV3IGxlYWYgKG9wZW5zIGEgbmV3IHRhYilcbiAgICAgICAgY29uc3QgbGVhZiA9IHRoaXMucGx1Z2luLmFwcC53b3Jrc3BhY2UuZ2V0TGVhZih0cnVlKTtcbiAgICAgICAgXG4gICAgICAgIC8vIFNldCB0aGUgdmlldyBzdGF0ZSB0byBNYXJrZG93biB0byBhY2Nlc3MgY29udGFpbmVyRWxcbiAgICAgICAgYXdhaXQgbGVhZi5zZXRWaWV3U3RhdGUoe1xuICAgICAgICAgICAgdHlwZTogXCJtYXJrZG93blwiLFxuICAgICAgICAgICAgYWN0aXZlOiB0cnVlLFxuICAgICAgICB9KTtcbiAgICAgICAgXG4gICAgICAgIC8vIENyZWF0ZSB0aGUgbWFpbiBjb250YWluZXJcbiAgICAgICAgY29uc3QgY29udGVudEVsID0gbGVhZi52aWV3LmNvbnRhaW5lckVsO1xuICAgICAgICBjb250ZW50RWwuZW1wdHkoKTtcbiAgICAgICAgXG4gICAgICAgIC8vIENyZWF0ZSBhIHNjcm9sbGFibGUgcGFuZWwgZm9yIGpvdXJuYWwgZW50cmllc1xuICAgICAgICBjb25zdCBwYW5lbCA9IGNvbnRlbnRFbC5jcmVhdGVEaXYoeyBjbHM6ICdjdXN0b20tam91cm5hbC1wYW5lbCcgfSk7XG4gICAgICAgIFxuICAgICAgICAvLyBHZXQgYWxsIGpvdXJuYWwgZmlsZXNcbiAgICAgICAgY29uc3Qgam91cm5hbEZpbGVzID0gZ2V0Sm91cm5hbEZpbGVzKHRoaXMucGx1Z2luLmFwcCwgdGhpcy5wbHVnaW4uc2V0dGluZ3Muam91cm5hbEZvbGRlcik7XG4gICAgICAgIFxuICAgICAgICBpZiAoam91cm5hbEZpbGVzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgbmV3IE5vdGljZSgnTm8gam91cm5hbCBlbnRyaWVzIGZvdW5kLicpO1xuICAgICAgICAgICAgcGFuZWwuY3JlYXRlRWwoJ2RpdicsIHsgXG4gICAgICAgICAgICAgICAgY2xzOiAnam91cm5hbC1lbXB0eS1zdGF0ZScsXG4gICAgICAgICAgICAgICAgdGV4dDogJ05vIGpvdXJuYWwgZW50cmllcyBmb3VuZC4gQ3JlYXRlIG9uZSBieSBjbGlja2luZyB0aGUgam91cm5hbHMgaWNvbiBpbiB0aGUgcmliYm9uLicgXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgLy8gU29ydCB0aGUgZmlsZXMgYWNjb3JkaW5nIHRvIHVzZXIgcHJlZmVyZW5jZVxuICAgICAgICBjb25zdCBzb3J0ZWRGaWxlcyA9IHNvcnRKb3VybmFsRmlsZXMoam91cm5hbEZpbGVzLCB0aGlzLnBsdWdpbi5zZXR0aW5ncy5zb3J0RGlyZWN0aW9uKTtcbiAgICAgICAgXG4gICAgICAgIC8vIEFkZCBlYWNoIGZpbGUgdG8gdGhlIHBhbmVsXG4gICAgICAgIGZvciAoY29uc3QgZmlsZSBvZiBzb3J0ZWRGaWxlcykge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBjb25zdCBmaWxlQ29udGVudCA9IGF3YWl0IHRoaXMucGx1Z2luLmFwcC52YXVsdC5yZWFkKGZpbGUpO1xuICAgICAgICAgICAgICAgIHRoaXMuYWRkSm91cm5hbEVudHJ5KHBhbmVsLCBmaWxlLCBmaWxlQ29udGVudCk7XG4gICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoYEVycm9yIHJlYWRpbmcgZmlsZSAke2ZpbGUucGF0aH06YCwgZXJyb3IpO1xuICAgICAgICAgICAgICAgIHRoaXMuYWRkRXJyb3JNZXNzYWdlKHBhbmVsLCBmaWxlLmJhc2VuYW1lLCBlcnJvcik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgXG4gICAgLyoqXG4gICAgICogQWRkcyBhbiBlcnJvciBtZXNzYWdlIHRvIHRoZSBwYW5lbCB3aGVuIGZpbGUgcmVhZGluZyBmYWlsc1xuICAgICAqL1xuICAgIHByaXZhdGUgYWRkRXJyb3JNZXNzYWdlKHBhbmVsOiBIVE1MRWxlbWVudCwgZmlsZW5hbWU6IHN0cmluZywgZXJyb3I6IGFueSk6IHZvaWQge1xuICAgICAgICBjb25zdCBlcnJvckRpdiA9IHBhbmVsLmNyZWF0ZURpdih7IGNsczogJ2pvdXJuYWwtZW50cnkgam91cm5hbC1lcnJvcicgfSk7XG4gICAgICAgIFxuICAgICAgICBjb25zdCBlcnJvckhlYWRlciA9IGVycm9yRGl2LmNyZWF0ZURpdih7IGNsczogJ2pvdXJuYWwtZW50cnktaGVhZGVyJyB9KTtcbiAgICAgICAgZXJyb3JIZWFkZXIuY3JlYXRlRWwoJ2gzJywgeyBcbiAgICAgICAgICAgIGNsczogJ2pvdXJuYWwtZW50cnktdGl0bGUnLFxuICAgICAgICAgICAgdGV4dDogYCR7ZmlsZW5hbWV9IC0gRXJyb3JgIFxuICAgICAgICB9KTtcbiAgICAgICAgXG4gICAgICAgIGNvbnN0IGVycm9yQ29udGVudCA9IGVycm9yRGl2LmNyZWF0ZURpdih7IGNsczogJ2pvdXJuYWwtZXJyb3ItY29udGVudCcgfSk7XG4gICAgICAgIGVycm9yQ29udGVudC50ZXh0Q29udGVudCA9IGBGYWlsZWQgdG8gbG9hZCBqb3VybmFsOiAke2Vycm9yLm1lc3NhZ2UgfHwgZXJyb3J9YDtcbiAgICB9XG4gICAgXG4gICAgLyoqXG4gICAgICogQWRkcyBhIGpvdXJuYWwgZW50cnkgdG8gdGhlIHBhbmVsXG4gICAgICovXG4gICAgcHJpdmF0ZSBhZGRKb3VybmFsRW50cnkocGFuZWw6IEhUTUxFbGVtZW50LCBmaWxlOiBURmlsZSwgY29udGVudDogc3RyaW5nKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IGpvdXJuYWxEYXRlID0gZmlsZS5iYXNlbmFtZTtcbiAgICAgICAgXG4gICAgICAgIC8vIENyZWF0ZSB0aGUgbWFpbiBjb250YWluZXIgZm9yIHRoaXMgZW50cnlcbiAgICAgICAgY29uc3Qgam91cm5hbEVudHJ5ID0gcGFuZWwuY3JlYXRlRGl2KHsgY2xzOiAnam91cm5hbC1lbnRyeScgfSk7XG4gICAgICAgIFxuICAgICAgICAvLyBDcmVhdGUgdGhlIGhlYWRlciBzZWN0aW9uXG4gICAgICAgIGNvbnN0IGhlYWRlciA9IGpvdXJuYWxFbnRyeS5jcmVhdGVEaXYoeyBjbHM6ICdqb3VybmFsLWVudHJ5LWhlYWRlcicgfSk7XG4gICAgICAgIFxuICAgICAgICAvLyBBZGQgdG9nZ2xlIGJ1dHRvbiBmb3IgY29sbGFwc2luZy9leHBhbmRpbmdcbiAgICAgICAgY29uc3QgdG9nZ2xlQnV0dG9uID0gaGVhZGVyLmNyZWF0ZUVsKCdidXR0b24nLCB7IGNsczogJ2NvbGxhcHNpYmxlLXRvZ2dsZScgfSk7XG4gICAgICAgIGlmICh0aGlzLnBsdWdpbi5zZXR0aW5ncy5kZWZhdWx0RXhwYW5kRW50cmllcykge1xuICAgICAgICAgICAgdG9nZ2xlQnV0dG9uLmFkZENsYXNzKCd0b2dnbGUtZXhwYW5kZWQnKTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgLy8gQWRkIHRpdGxlIHdpdGggbGluayB0byB0aGUgb3JpZ2luYWwgZmlsZVxuICAgICAgICBjb25zdCB0aXRsZSA9IGhlYWRlci5jcmVhdGVFbCgnaDMnLCB7IGNsczogJ2pvdXJuYWwtZW50cnktdGl0bGUnIH0pO1xuICAgICAgICBjb25zdCB0aXRsZUxpbmsgPSB0aXRsZS5jcmVhdGVFbCgnYScsIHsgXG4gICAgICAgICAgICBjbHM6ICdqb3VybmFsLWVudHJ5LWxpbmsnLFxuICAgICAgICAgICAgdGV4dDogZm9ybWF0RGF0ZUZvckRpc3BsYXkoam91cm5hbERhdGUpXG4gICAgICAgIH0pO1xuICAgICAgICBcbiAgICAgICAgLy8gSGFuZGxlIGNsaWNrIG9uIHRoZSB0aXRsZSB0byBvcGVuIHRoZSBmaWxlXG4gICAgICAgIHRpdGxlTGluay5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChldmVudCkgPT4ge1xuICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgIHRoaXMucGx1Z2luLmFwcC53b3Jrc3BhY2Uub3BlbkxpbmtUZXh0KGZpbGUuYmFzZW5hbWUsIGZpbGUucGF0aCk7XG4gICAgICAgIH0pO1xuICAgICAgICBcbiAgICAgICAgLy8gQ3JlYXRlIHRoZSBjb250ZW50IGFyZWFcbiAgICAgICAgY29uc3QgY29udGVudEFyZWEgPSBqb3VybmFsRW50cnkuY3JlYXRlRGl2KHsgXG4gICAgICAgICAgICBjbHM6ICdjb2xsYXBzaWJsZS1jb250ZW50JyArICh0aGlzLnBsdWdpbi5zZXR0aW5ncy5kZWZhdWx0RXhwYW5kRW50cmllcyA/ICcgY29udGVudC1leHBhbmRlZCcgOiAnJylcbiAgICAgICAgfSk7XG4gICAgICAgIFxuICAgICAgICAvLyBLZWVwIHRyYWNrIG9mIHRoZSBjdXJyZW50IGNvbnRlbnQgdmFsdWVcbiAgICAgICAgbGV0IGN1cnJlbnRDb250ZW50ID0gY29udGVudDtcbiAgICAgICAgXG4gICAgICAgIC8vIENyZWF0ZSB0aGUgcmVuZGVyZWQgdmlldyAobWFya2Rvd24pXG4gICAgICAgIGNvbnN0IHJlbmRlcmVkQ29udGVudCA9IGNvbnRlbnRBcmVhLmNyZWF0ZURpdih7IFxuICAgICAgICAgICAgY2xzOiAncmVuZGVyZWQtY29udGVudCBhY3RpdmUtdmlldycgXG4gICAgICAgIH0pO1xuICAgICAgICBcbiAgICAgICAgLy8gQ3JlYXRlIHRoZSBlZGl0YWJsZSB2aWV3ICh0ZXh0YXJlYSlcbiAgICAgICAgY29uc3QgZWRpdGFibGVDb250ZW50ID0gY29udGVudEFyZWEuY3JlYXRlRWwoJ3RleHRhcmVhJywgeyBcbiAgICAgICAgICAgIGNsczogJ2VkaXRhYmxlLWNvbnRlbnQnLFxuICAgICAgICAgICAgdmFsdWU6IGN1cnJlbnRDb250ZW50XG4gICAgICAgIH0pO1xuICAgICAgICBcbiAgICAgICAgLy8gQWRqdXN0IHRleHRhcmVhIGhlaWdodCB0byBjb250ZW50XG4gICAgICAgIHdpbmRvdy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUoKCkgPT4ge1xuICAgICAgICAgICAgZWRpdGFibGVDb250ZW50LnN0eWxlLmhlaWdodCA9IGVkaXRhYmxlQ29udGVudC5zY3JvbGxIZWlnaHQgKyAncHgnO1xuICAgICAgICB9KTtcbiAgICAgICAgXG4gICAgICAgIC8vIFJlbmRlciB0aGUgbWFya2Rvd24gY29udGVudFxuICAgICAgICBjb25zdCByZW5kZXJDb250ZW50ID0gKCkgPT4ge1xuICAgICAgICAgICAgcmVuZGVyZWRDb250ZW50LmVtcHR5KCk7XG4gICAgICAgICAgICBNYXJrZG93blJlbmRlcmVyLnJlbmRlcih0aGlzLnBsdWdpbi5hcHAsIGN1cnJlbnRDb250ZW50LCByZW5kZXJlZENvbnRlbnQsIGZpbGUucGF0aCwgdGhpcy5wbHVnaW4pO1xuICAgICAgICB9O1xuICAgICAgICBcbiAgICAgICAgLy8gSW5pdGlhbCByZW5kZXJcbiAgICAgICAgcmVuZGVyQ29udGVudCgpO1xuICAgICAgICBcbiAgICAgICAgLy8gRnVuY3Rpb24gdG8gZW50ZXIgZWRpdCBtb2RlXG4gICAgICAgIGNvbnN0IGVudGVyRWRpdE1vZGUgPSAoKSA9PiB7XG4gICAgICAgICAgICAvLyBNYWtlIHN1cmUgdGhlIHRleHRhcmVhIGhhcyB0aGUgY3VycmVudCBjb250ZW50IGJlZm9yZSBzaG93aW5nIGl0XG4gICAgICAgICAgICBlZGl0YWJsZUNvbnRlbnQudmFsdWUgPSBjdXJyZW50Q29udGVudDtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgcmVuZGVyZWRDb250ZW50LmNsYXNzTGlzdC50b2dnbGUoJ2FjdGl2ZS12aWV3Jyk7XG4gICAgICAgICAgICBlZGl0YWJsZUNvbnRlbnQuY2xhc3NMaXN0LnRvZ2dsZSgnYWN0aXZlLXZpZXcnKTtcbiAgICAgICAgICAgIGVkaXRhYmxlQ29udGVudC5zdHlsZS5oZWlnaHQgPSAnYXV0byc7XG4gICAgICAgICAgICBlZGl0YWJsZUNvbnRlbnQuc3R5bGUuaGVpZ2h0ID0gZWRpdGFibGVDb250ZW50LnNjcm9sbEhlaWdodCArICdweCc7XG4gICAgICAgICAgICBlZGl0YWJsZUNvbnRlbnQuZm9jdXMoKTtcbiAgICAgICAgfTtcbiAgICAgICAgXG4gICAgICAgIC8vIENsaWNrIG9uIHJlbmRlcmVkIGNvbnRlbnQgdG8gZWRpdFxuICAgICAgICByZW5kZXJlZENvbnRlbnQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZXZlbnQpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHRhcmdldCA9IGV2ZW50LnRhcmdldCBhcyBIVE1MRWxlbWVudDtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gRG9uJ3QgZW50ZXIgZWRpdCBtb2RlIGlmIGNsaWNraW5nIG9uIGxpbmtzIG9yIGhhc2h0YWdzXG4gICAgICAgICAgICBpZiAodGFyZ2V0LnRhZ05hbWUgPT09ICdBJyB8fCB0YXJnZXQuY2xvc2VzdCgnYScpIHx8IFxuICAgICAgICAgICAgICAgIHRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ2NtLWhhc2h0YWcnKSB8fCB0YXJnZXQuY2xvc2VzdCgnLmNtLWhhc2h0YWcnKSkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gT3RoZXJ3aXNlLCB0cmlnZ2VyIGVkaXRpbmcgbW9kZVxuICAgICAgICAgICAgZW50ZXJFZGl0TW9kZSgpO1xuICAgICAgICB9KTtcbiAgICAgICAgXG4gICAgICAgIC8vIFNhdmUgY2hhbmdlcyBhbmQgZXhpdCBlZGl0IG1vZGUgb24gYmx1clxuICAgICAgICBlZGl0YWJsZUNvbnRlbnQuYWRkRXZlbnRMaXN0ZW5lcignYmx1cicsIGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIGN1cnJlbnRDb250ZW50ID0gZWRpdGFibGVDb250ZW50LnZhbHVlO1xuICAgICAgICAgICAgYXdhaXQgdGhpcy5zYXZlQ29udGVudFRvRmlsZShmaWxlLCBjdXJyZW50Q29udGVudCk7XG4gICAgICAgICAgICByZW5kZXJDb250ZW50KCk7XG4gICAgICAgICAgICByZW5kZXJlZENvbnRlbnQuY2xhc3NMaXN0LnRvZ2dsZSgnYWN0aXZlLXZpZXcnKTtcbiAgICAgICAgICAgIGVkaXRhYmxlQ29udGVudC5jbGFzc0xpc3QudG9nZ2xlKCdhY3RpdmUtdmlldycpO1xuICAgICAgICB9KTtcbiAgICAgICAgXG4gICAgICAgIC8vIEF1dG8tYWRqdXN0IHRleHRhcmVhIGhlaWdodCB3aGlsZSB0eXBpbmdcbiAgICAgICAgZWRpdGFibGVDb250ZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0JywgKCkgPT4ge1xuICAgICAgICAgICAgZWRpdGFibGVDb250ZW50LnN0eWxlLmhlaWdodCA9ICdhdXRvJztcbiAgICAgICAgICAgIGVkaXRhYmxlQ29udGVudC5zdHlsZS5oZWlnaHQgPSBlZGl0YWJsZUNvbnRlbnQuc2Nyb2xsSGVpZ2h0ICsgJ3B4JztcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gVXBkYXRlIGN1cnJlbnQgY29udGVudCB3aGlsZSB0eXBpbmdcbiAgICAgICAgICAgIGN1cnJlbnRDb250ZW50ID0gZWRpdGFibGVDb250ZW50LnZhbHVlO1xuICAgICAgICB9KTtcbiAgICAgICAgXG4gICAgICAgIC8vIFNhdmUgY29udGVudCBwZXJpb2RpY2FsbHkgd2hpbGUgdHlwaW5nXG4gICAgICAgIGxldCBzYXZlVGltZW91dDogTm9kZUpTLlRpbWVvdXQgfCBudWxsID0gbnVsbDtcbiAgICAgICAgZWRpdGFibGVDb250ZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0JywgKCkgPT4ge1xuICAgICAgICAgICAgLy8gQ2xlYXIgcHJldmlvdXMgdGltZW91dFxuICAgICAgICAgICAgaWYgKHNhdmVUaW1lb3V0KSB7XG4gICAgICAgICAgICAgICAgY2xlYXJUaW1lb3V0KHNhdmVUaW1lb3V0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gU2V0IGEgbmV3IHRpbWVvdXQgdG8gc2F2ZSBhZnRlciA1MDBtcyBvZiBpbmFjdGl2aXR5XG4gICAgICAgICAgICBzYXZlVGltZW91dCA9IHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuc2F2ZUNvbnRlbnRUb0ZpbGUoZmlsZSwgY3VycmVudENvbnRlbnQpO1xuICAgICAgICAgICAgfSwgNTAwKTtcbiAgICAgICAgfSk7XG4gICAgICAgIFxuICAgICAgICAvLyBUb2dnbGUgZXhwYW5kL2NvbGxhcHNlIG9uIGJ1dHRvbiBjbGlja1xuICAgICAgICB0b2dnbGVCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgICAgICAgICB0b2dnbGVCdXR0b24uY2xhc3NMaXN0LnRvZ2dsZSgndG9nZ2xlLWV4cGFuZGVkJyk7XG4gICAgICAgICAgICBjb250ZW50QXJlYS5jbGFzc0xpc3QudG9nZ2xlKCdjb250ZW50LWV4cGFuZGVkJyk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBcbiAgICAvKipcbiAgICAgKiBTYXZlcyB0aGUgY29udGVudCB0byB0aGUgZmlsZVxuICAgICAqL1xuICAgIHByaXZhdGUgYXN5bmMgc2F2ZUNvbnRlbnRUb0ZpbGUoZmlsZTogVEZpbGUsIGNvbnRlbnQ6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uYXBwLnZhdWx0Lm1vZGlmeShmaWxlLCBjb250ZW50KTtcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIG5ldyBOb3RpY2UoYEZhaWxlZCB0byBzYXZlIGNoYW5nZXM6ICR7ZXJyb3J9YCk7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gc2F2ZSBjaGFuZ2VzOicsIGVycm9yKTtcbiAgICAgICAgfVxuICAgIH1cbn0iLCAiLyoqXG4gKiBGb3JtYXRzIHRoZSBjdXJyZW50IGRhdGUgaW4gWVlZWS1NTS1ERCBmb3JtYXRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldFRvZGF5RGF0ZSgpOiBzdHJpbmcge1xuICAgIGNvbnN0IHRvZGF5ID0gbmV3IERhdGUoKTtcbiAgICByZXR1cm4gZm9ybWF0RGF0ZVN0cmluZyh0b2RheSk7XG59XG5cbi8qKlxuICogRm9ybWF0cyBhIGRhdGUgYXMgWVlZWS1NTS1ERFxuICovXG5leHBvcnQgZnVuY3Rpb24gZm9ybWF0RGF0ZVN0cmluZyhkYXRlOiBEYXRlKTogc3RyaW5nIHtcbiAgICBjb25zdCB5ZWFyID0gZGF0ZS5nZXRGdWxsWWVhcigpO1xuICAgIGNvbnN0IG1vbnRoID0gU3RyaW5nKGRhdGUuZ2V0TW9udGgoKSArIDEpLnBhZFN0YXJ0KDIsICcwJyk7XG4gICAgY29uc3QgZGF5ID0gU3RyaW5nKGRhdGUuZ2V0RGF0ZSgpKS5wYWRTdGFydCgyLCAnMCcpO1xuICAgIHJldHVybiBgJHt5ZWFyfS0ke21vbnRofS0ke2RheX1gO1xufVxuXG4vKipcbiAqIEZvcm1hdHMgYSBkYXRlIHN0cmluZyBpbiBhIGh1bWFuLXJlYWRhYmxlIGZvcm1hdCB3aXRoIG9yZGluYWwgc3VmZml4XG4gKiBAcGFyYW0gZGF0ZVN0cmluZyBTdHJpbmcgaW4gWVlZWS1NTS1ERCBmb3JtYXRcbiAqIEByZXR1cm5zIEZvcm1hdHRlZCBkYXRlIHN0cmluZyAoZS5nLiwgXCJGZWIgMTV0aCwgMjAyM1wiKVxuICovXG5leHBvcnQgZnVuY3Rpb24gZm9ybWF0RGF0ZUZvckRpc3BsYXkoZGF0ZVN0cmluZzogc3RyaW5nKTogc3RyaW5nIHtcbiAgICBjb25zdCBkYXRlID0gbmV3IERhdGUoZGF0ZVN0cmluZyk7XG4gICAgY29uc3QgZGF0ZUZvcm1hdE9wdGlvbnM6IEludGwuRGF0ZVRpbWVGb3JtYXRPcHRpb25zID0geyBcbiAgICAgICAgbW9udGg6ICdzaG9ydCcsIFxuICAgICAgICB5ZWFyOiAnbnVtZXJpYycsIFxuICAgICAgICBkYXk6ICdudW1lcmljJyBcbiAgICB9O1xuXG4gICAgLy8gRm9ybWF0IGRhdGUgdXNpbmcgSW50bC5EYXRlVGltZUZvcm1hdFxuICAgIGNvbnN0IGZvcm1hdHRlZERhdGUgPSBuZXcgSW50bC5EYXRlVGltZUZvcm1hdCgnZW4tVVMnLCBkYXRlRm9ybWF0T3B0aW9ucykuZm9ybWF0KGRhdGUpO1xuXG4gICAgLy8gRXh0cmFjdCBkYXkgYW5kIGFkZCBvcmRpbmFsIHN1ZmZpeCAoZS5nLiwgJ3N0JywgJ25kJywgJ3JkJywgJ3RoJylcbiAgICBjb25zdCBkYXkgPSBkYXRlLmdldERhdGUoKTtcbiAgICBjb25zdCBkYXlTdWZmaXggPSBnZXREYXlTdWZmaXgoZGF5KTtcblxuICAgIC8vIEJ1aWxkIHRoZSBmaW5hbCBmb3JtYXR0ZWQgc3RyaW5nXG4gICAgY29uc3QgcGFydHMgPSBmb3JtYXR0ZWREYXRlLnNwbGl0KCcgJyk7XG4gICAgcmV0dXJuIGAke3BhcnRzWzBdfSAke2RheX0ke2RheVN1ZmZpeH0sICR7cGFydHNbMl19YDtcbn1cblxuLyoqXG4gKiBHZXRzIHRoZSBhcHByb3ByaWF0ZSBvcmRpbmFsIHN1ZmZpeCBmb3IgYSBkYXkgbnVtYmVyXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXREYXlTdWZmaXgoZGF5OiBudW1iZXIpOiBzdHJpbmcge1xuICAgIGlmIChkYXkgPiAzICYmIGRheSA8IDIxKSByZXR1cm4gJ3RoJzsgLy8gU3BlY2lhbCBjYXNlIGZvciAxMXRoLTE5dGhcbiAgICBzd2l0Y2ggKGRheSAlIDEwKSB7XG4gICAgICAgIGNhc2UgMTogcmV0dXJuICdzdCc7XG4gICAgICAgIGNhc2UgMjogcmV0dXJuICduZCc7XG4gICAgICAgIGNhc2UgMzogcmV0dXJuICdyZCc7XG4gICAgICAgIGRlZmF1bHQ6IHJldHVybiAndGgnO1xuICAgIH1cbn1cblxuLyoqXG4gKiBDaGVja3MgaWYgYSBzdHJpbmcgbWF0Y2hlcyB0aGUgWVlZWS1NTS1ERCBwYXR0ZXJuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpc0RhdGVGb3JtYXQodGV4dDogc3RyaW5nKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIC9eXFxkezR9LVxcZHsyfS1cXGR7Mn0kLy50ZXN0KHRleHQpO1xufSIsICJpbXBvcnQgeyBBcHAsIE5vdGljZSwgVEZpbGUsIFRGb2xkZXIgfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgeyBpc0RhdGVGb3JtYXQgfSBmcm9tICcuL2RhdGUtdXRpbHMnO1xuXG4vKipcbiAqIEVuc3VyZXMgdGhhdCB0aGUgc3BlY2lmaWVkIGZvbGRlciBleGlzdHMsIGNyZWF0aW5nIGl0IGlmIG5lY2Vzc2FyeVxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZW5zdXJlRm9sZGVyKGFwcDogQXBwLCBmb2xkZXJQYXRoOiBzdHJpbmcpOiBQcm9taXNlPGJvb2xlYW4+IHtcbiAgICAvLyBJZiBubyBmb2xkZXIgaXMgc3BlY2lmaWVkLCBub3RoaW5nIHRvIGNyZWF0ZVxuICAgIGlmICghZm9sZGVyUGF0aCkge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG5cbiAgICAvLyBDaGVjayBpZiBmb2xkZXIgZXhpc3RzXG4gICAgY29uc3QgZm9sZGVyRXhpc3RzID0gYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChmb2xkZXJQYXRoKTtcbiAgICBcbiAgICAvLyBJZiBpdCBleGlzdHMsIG1ha2Ugc3VyZSBpdCdzIGEgZm9sZGVyXG4gICAgaWYgKGZvbGRlckV4aXN0cyAmJiAhKGZvbGRlckV4aXN0cyBpbnN0YW5jZW9mIFRGb2xkZXIpKSB7XG4gICAgICAgIG5ldyBOb3RpY2UoYENhbm5vdCBjcmVhdGUgam91cm5hbCBmb2xkZXI6IFwiJHtmb2xkZXJQYXRofVwiIGV4aXN0cyBidXQgaXMgbm90IGEgZm9sZGVyYCk7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgXG4gICAgLy8gQ3JlYXRlIGZvbGRlciBpZiBpdCBkb2Vzbid0IGV4aXN0XG4gICAgaWYgKCFmb2xkZXJFeGlzdHMpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGF3YWl0IGFwcC52YXVsdC5jcmVhdGVGb2xkZXIoZm9sZGVyUGF0aCk7XG4gICAgICAgICAgICBuZXcgTm90aWNlKGBDcmVhdGVkIGpvdXJuYWwgZm9sZGVyOiAke2ZvbGRlclBhdGh9YCk7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIG5ldyBOb3RpY2UoYEZhaWxlZCB0byBjcmVhdGUgam91cm5hbCBmb2xkZXI6ICR7ZXJyb3J9YCk7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gY3JlYXRlIGpvdXJuYWwgZm9sZGVyOicsIGVycm9yKTtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBcbiAgICByZXR1cm4gdHJ1ZTtcbn1cblxuLyoqXG4gKiBHZXRzIHRoZSBmdWxsIHBhdGggZm9yIGEgZmlsZSB3aXRoaW4gdGhlIHNwZWNpZmllZCBmb2xkZXJcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldEZpbGVQYXRoKGZvbGRlcjogc3RyaW5nLCBmaWxlbmFtZTogc3RyaW5nKTogc3RyaW5nIHtcbiAgICBpZiAoZm9sZGVyKSB7XG4gICAgICAgIHJldHVybiBgJHtmb2xkZXJ9LyR7ZmlsZW5hbWV9YDtcbiAgICB9XG4gICAgcmV0dXJuIGZpbGVuYW1lO1xufVxuXG4vKipcbiAqIENoZWNrcyBpZiBhIGZpbGUgaXMgYSBqb3VybmFsIGZpbGUgYmFzZWQgb24gaXRzIG5hbWUgcGF0dGVybiBhbmQgbG9jYXRpb25cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGlzSm91cm5hbEZpbGUoZmlsZTogVEZpbGUsIGpvdXJuYWxGb2xkZXI/OiBzdHJpbmcpOiBib29sZWFuIHtcbiAgICAvLyBDaGVjayBpZiBiYXNlbmFtZSBtYXRjaGVzIFlZWVktTU0tREQgcGF0dGVyblxuICAgIGNvbnN0IGlzRGF0ZUJhc2VuYW1lID0gaXNEYXRlRm9ybWF0KGZpbGUuYmFzZW5hbWUpO1xuICAgIFxuICAgIC8vIElmIGZvbGRlciBpcyBzcGVjaWZpZWQsIGFsc28gY2hlY2sgaWYgdGhlIGZpbGUgaXMgaW4gdGhhdCBmb2xkZXJcbiAgICBpZiAoam91cm5hbEZvbGRlcikge1xuICAgICAgICByZXR1cm4gaXNEYXRlQmFzZW5hbWUgJiYgZmlsZS5wYXRoLnN0YXJ0c1dpdGgoam91cm5hbEZvbGRlciArICcvJyk7XG4gICAgfVxuICAgIFxuICAgIC8vIElmIG5vIGZvbGRlciBpcyBzcGVjaWZpZWQsIGp1c3QgY2hlY2sgdGhlIGJhc2VuYW1lXG4gICAgcmV0dXJuIGlzRGF0ZUJhc2VuYW1lO1xufVxuXG4vKipcbiAqIEdldHMgYWxsIGpvdXJuYWwgZmlsZXMgaW4gdGhlIHZhdWx0XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRKb3VybmFsRmlsZXMoYXBwOiBBcHAsIGpvdXJuYWxGb2xkZXI/OiBzdHJpbmcpOiBURmlsZVtdIHtcbiAgICAvLyBHZXQgYWxsIG1hcmtkb3duIGZpbGVzIGluIHRoZSB2YXVsdFxuICAgIGNvbnN0IGZpbGVzID0gYXBwLnZhdWx0LmdldE1hcmtkb3duRmlsZXMoKTtcblxuICAgIC8vIEZpbHRlciBmaWxlcyB0aGF0IGZvbGxvdyBhIGRhaWx5IG5vdGUgcGF0dGVybiBhbmQgYXJlIGluIHRoZSBjb3JyZWN0IGZvbGRlclxuICAgIHJldHVybiBmaWxlcy5maWx0ZXIoKGZpbGUpID0+IGlzSm91cm5hbEZpbGUoZmlsZSwgam91cm5hbEZvbGRlcikpO1xufVxuXG4vKipcbiAqIFNvcnRzIGpvdXJuYWwgZmlsZXMgYnkgZGF0ZVxuICovXG5leHBvcnQgZnVuY3Rpb24gc29ydEpvdXJuYWxGaWxlcyhmaWxlczogVEZpbGVbXSwgc29ydERpcmVjdGlvbjogJ25ld2VzdC1maXJzdCcgfCAnb2xkZXN0LWZpcnN0Jyk6IFRGaWxlW10ge1xuICAgIHJldHVybiBmaWxlcy5zb3J0KChhLCBiKSA9PiB7XG4gICAgICAgIGlmIChzb3J0RGlyZWN0aW9uID09PSAnbmV3ZXN0LWZpcnN0Jykge1xuICAgICAgICAgICAgcmV0dXJuIGIuYmFzZW5hbWUubG9jYWxlQ29tcGFyZShhLmJhc2VuYW1lKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBhLmJhc2VuYW1lLmxvY2FsZUNvbXBhcmUoYi5iYXNlbmFtZSk7XG4gICAgICAgIH1cbiAgICB9KTtcbn1cblxuLyoqXG4gKiBDcmVhdGVzIG9yIGdldHMgYSBqb3VybmFsIGZpbGUgZm9yIHRoZSBzcGVjaWZpZWQgZGF0ZVxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0T3JDcmVhdGVKb3VybmFsRmlsZShcbiAgICBhcHA6IEFwcCwgXG4gICAgam91cm5hbEZvbGRlcjogc3RyaW5nLCBcbiAgICBmaWxlbmFtZTogc3RyaW5nLFxuICAgIGluaXRpYWxDb250ZW50OiBzdHJpbmcgPSAnJ1xuKTogUHJvbWlzZTxURmlsZSB8IG51bGw+IHtcbiAgICBhd2FpdCBlbnN1cmVGb2xkZXIoYXBwLCBqb3VybmFsRm9sZGVyKTtcbiAgICBcbiAgICBjb25zdCBmaWxlUGF0aCA9IGdldEZpbGVQYXRoKGpvdXJuYWxGb2xkZXIsIGZpbGVuYW1lKTtcbiAgICBcbiAgICAvLyBDaGVjayBpZiB0aGUgZmlsZSBhbHJlYWR5IGV4aXN0c1xuICAgIGxldCBmaWxlID0gYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChmaWxlUGF0aCk7XG4gICAgXG4gICAgaWYgKGZpbGUgaW5zdGFuY2VvZiBURmlsZSkge1xuICAgICAgICByZXR1cm4gZmlsZTtcbiAgICB9XG4gICAgXG4gICAgLy8gQ3JlYXRlIHRoZSBmaWxlIGlmIGl0IGRvZXNuJ3QgZXhpc3RcbiAgICB0cnkge1xuICAgICAgICBmaWxlID0gYXdhaXQgYXBwLnZhdWx0LmNyZWF0ZShmaWxlUGF0aCwgaW5pdGlhbENvbnRlbnQpO1xuICAgICAgICBuZXcgTm90aWNlKGBDcmVhdGVkIGpvdXJuYWwgZW50cnk6ICR7ZmlsZW5hbWV9YCk7XG4gICAgICAgIHJldHVybiBmaWxlIGFzIFRGaWxlO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIG5ldyBOb3RpY2UoYEZhaWxlZCB0byBjcmVhdGUgam91cm5hbCBlbnRyeTogJHtlcnJvcn1gKTtcbiAgICAgICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIGNyZWF0ZSBqb3VybmFsIGVudHJ5OicsIGVycm9yKTtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxufSJdLAogICJtYXBwaW5ncyI6ICI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSxJQUFBQSxtQkFBK0I7OztBQ0EvQixzQkFBK0M7QUFVeEMsSUFBTSxtQkFBdUM7QUFBQSxFQUNoRCxlQUFlO0FBQUEsRUFDZixZQUFZO0FBQUEsRUFDWixlQUFlO0FBQUEsRUFDZixzQkFBc0I7QUFDMUI7QUFFTyxJQUFNLHVCQUFOLGNBQW1DLGlDQUFpQjtBQUFBLEVBR3ZELFlBQVksS0FBVSxRQUEwQjtBQUM1QyxVQUFNLEtBQUssTUFBTTtBQUNqQixTQUFLLFNBQVM7QUFBQSxFQUNsQjtBQUFBLEVBRUEsVUFBZ0I7QUFDWixVQUFNLEVBQUUsWUFBWSxJQUFJO0FBQ3hCLGdCQUFZLE1BQU07QUFFbEIsZ0JBQVksU0FBUyxNQUFNLEVBQUUsTUFBTSxpQ0FBaUMsQ0FBQztBQUVyRSxRQUFJLHdCQUFRLFdBQVcsRUFDbEIsUUFBUSxnQkFBZ0IsRUFDeEIsUUFBUSx5REFBeUQsRUFDakUsUUFBUSxVQUFRLEtBQ1osZUFBZSxVQUFVLEVBQ3pCLFNBQVMsS0FBSyxPQUFPLFNBQVMsYUFBYSxFQUMzQyxTQUFTLE9BQU8sVUFBVTtBQUV2QixXQUFLLE9BQU8sU0FBUyxnQkFBZ0IsTUFBTSxRQUFRLGNBQWMsRUFBRTtBQUNuRSxZQUFNLEtBQUssT0FBTyxhQUFhO0FBQUEsSUFDbkMsQ0FBQyxDQUFDO0FBRVYsUUFBSSx3QkFBUSxXQUFXLEVBQ2xCLFFBQVEsYUFBYSxFQUNyQixRQUFRLHVEQUF1RCxFQUMvRCxRQUFRLFVBQVEsS0FDWixlQUFlLFlBQVksRUFDM0IsU0FBUyxLQUFLLE9BQU8sU0FBUyxVQUFVLEVBQ3hDLFNBQVMsT0FBTyxV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QUEsTUFDSixNQUFNO0FBQUEsTUFDTixVQUFVLE1BQU07QUFDWixhQUFLLGdCQUFnQjtBQUFBLE1BQ3pCO0FBQUEsSUFDSixDQUFDO0FBR0QsU0FBSyxXQUFXO0FBQUEsTUFDWixJQUFJO0FBQUEsTUFDSixNQUFNO0FBQUEsTUFDTixVQUFVLE1BQU07QUFDWixhQUFLLG9CQUFvQjtBQUFBLE1BQzdCO0FBQUEsSUFDSixDQUFDO0FBR0QsU0FBSyxjQUFjLElBQUkscUJBQXFCLEtBQUssS0FBSyxJQUFJLENBQUM7QUFBQSxFQUMvRDtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS0EsTUFBTSxrQkFBaUM7QUFFbkMsVUFBTSxLQUFLLG9CQUFvQjtBQUcvQixVQUFNLEtBQUssWUFBWSxLQUFLO0FBQUEsRUFDaEM7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLE1BQU0sc0JBQXFDO0FBQ3ZDLFVBQU0sT0FBTyxhQUFhO0FBQzFCLFVBQU0sV0FBVyxHQUFHO0FBRXBCLFVBQU0sT0FBTyxNQUFNO0FBQUEsTUFDZixLQUFLO0FBQUEsTUFDTCxLQUFLLFNBQVM7QUFBQSxNQUNkO0FBQUEsSUFDSjtBQUVBLFFBQUksQ0FBQyxNQUFNO0FBQ1AsVUFBSSx3QkFBTywwQ0FBMkM7QUFDdEQ7QUFBQSxJQUNKO0FBQUEsRUFDSjtBQUFBLEVBRUEsTUFBTSxlQUFlO0FBQ2pCLFNBQUssV0FBVyxPQUFPLE9BQU8sQ0FBQyxHQUFHLGtCQUFrQixNQUFNLEtBQUssU0FBUyxDQUFDO0FBQUEsRUFDN0U7QUFBQSxFQUVBLE1BQU0sZUFBZTtBQUNqQixVQUFNLEtBQUssU0FBUyxLQUFLLFFBQVE7QUFBQSxFQUNyQztBQUNKOyIsCiAgIm5hbWVzIjogWyJpbXBvcnRfb2JzaWRpYW4iLCAiaW1wb3J0X29ic2lkaWFuIiwgImltcG9ydF9vYnNpZGlhbiJdCn0K
